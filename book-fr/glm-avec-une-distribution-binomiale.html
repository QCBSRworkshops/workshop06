<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 6 GLM avec une distribution binomiale | Atelier 6: Modèles linéaires généralisés en R</title>
  <meta name="description" content="Modèles linéaires généralisés en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 6 GLM avec une distribution binomiale | Atelier 6: Modèles linéaires généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 6 GLM avec une distribution binomiale | Atelier 6: Modèles linéaires généralisés en R" />
  
  <meta name="twitter:description" content="Modèles linéaires généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="glm-avec-une-distribution-binomiale-bernouilli.html"/>
<link rel="next" href="que-avec-des-données-dabondance.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><i class="fa fa-check"></i><b>3</b> Quel est l’utilité des modèles linéaires généralisés?</a></li>
<li class="chapter" data-level="4" data-path="les-distributions-des-données-biologiques.html"><a href="les-distributions-des-données-biologiques.html"><i class="fa fa-check"></i><b>4</b> Les distributions des données biologiques</a></li>
<li class="part"><span><b>GLM avec des données binaires</b></span></li>
<li class="chapter" data-level="5" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html"><i class="fa fa-check"></i><b>5</b> GLM avec une distribution binomiale (Bernouilli)</a><ul>
<li class="chapter" data-level="5.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#la-fonction-de-lien"><i class="fa fa-check"></i><b>5.1</b> La fonction de lien</a><ul>
<li class="chapter" data-level="5.1.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#défi-1"><i class="fa fa-check"></i><b>5.1.1</b> Défi 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#interpréter-la-sortie-dune-régression-logistique"><i class="fa fa-check"></i><b>5.2</b> Interpréter la sortie d’une régression logistique</a></li>
<li class="chapter" data-level="5.3" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#pouvoir-prédictif-et-validation-du-modèle"><i class="fa fa-check"></i><b>5.3</b> Pouvoir prédictif et validation du modèle</a><ul>
<li class="chapter" data-level="5.3.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#défi-2"><i class="fa fa-check"></i><b>5.3.1</b> Défi 2</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#représentation-graphique-des-résultats"><i class="fa fa-check"></i><b>5.4</b> Représentation graphique des résultats</a></li>
</ul></li>
<li class="part"><span><b>GLM avec des données de proportions</b></span></li>
<li class="chapter" data-level="6" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html"><i class="fa fa-check"></i><b>6</b> GLM avec une distribution binomiale</a></li>
<li class="part"><span><b>GLM avec des données d’abondance</b></span></li>
<li class="chapter" data-level="7" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html"><i class="fa fa-check"></i><b>7</b> Que avec des données d’abondance?</a><ul>
<li class="chapter" data-level="7.1" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html#glm-avec-une-distribution-de-poisson"><i class="fa fa-check"></i><b>7.1</b> GLM avec une distribution de Poisson</a><ul>
<li class="chapter" data-level="7.1.1" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html#la-validation-du-modèle-et-le-problème-de-la-surdispersion"><i class="fa fa-check"></i><b>7.1.1</b> La validation du modèle et le problème de la surdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>8</b> quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="9" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>9</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#représentation-graphique-du-modèle-final"><i class="fa fa-check"></i><b>9.1</b> Représentation graphique du modèle final</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>10</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Autres distributions</b></span></li>
<li class="chapter" data-level="11" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>11</b> Autres distributions</a></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="12" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>12</b> Sommaire</a></li>
<li class="chapter" data-level="13" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>13</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="14" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>14</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 6: Modèles linéaires généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="glm-avec-une-distribution-binomiale" class="section level1">
<h1><span class="header-section-number">Chapitre 6</span> GLM avec une distribution binomiale</h1>
<p>Les données de proportions sont plus près des variables binaires que
vous ne l’imaginez ! Supposons que vous êtes sur le terrain pour
estimer la prévalence d’une maladiechez le cerf de Virginie le long
d’un gradient environnemental de disponibilité en ressources. Vous
échantillonnez dix individus dans dix populations différentes pour
estimer la prévalence de la maladie. Votre feuille de données comporte
dix lignes avec l’information suivante : code de la population et
nombre d’individus infectés dans la population. À première vue, on
dirait des données d’occurrences (<em>i.e.</em> count data), mais ce n’est
pas correct de le voir ainsi : vous savez combien d’individus vous avez
échantillonnés dans chaque population. Vous avez donc des données de
proportions : c’est le nombre d’individus infectés sur dix individus
échantillonnés. Si vous vous rappelez ce que vous avez lu dans la
section sur les distributions, vous devez choisir une distribution
binomiale pour modéliser ces données. Illustrons ceci avec un exemple :</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="glm-avec-une-distribution-binomiale.html#cb26-1"></a><span class="co"># Commençons par générer des données en se basant sur</span></span>
<span id="cb26-2"><a href="glm-avec-une-distribution-binomiale.html#cb26-2"></a><span class="co"># l&#39;exemple précédent : On choisit un nombre aléatoire entre</span></span>
<span id="cb26-3"><a href="glm-avec-une-distribution-binomiale.html#cb26-3"></a><span class="co"># 1 et 10 pour déterminer le nombre de cerfs infectés (objet</span></span>
<span id="cb26-4"><a href="glm-avec-une-distribution-binomiale.html#cb26-4"></a><span class="co"># &#39;n.infected&#39;).  On échantillonne dix individus dans dix</span></span>
<span id="cb26-5"><a href="glm-avec-une-distribution-binomiale.html#cb26-5"></a><span class="co"># populations différentes (objet &#39;n.total&#39;).  &#39;res.avail&#39; est</span></span>
<span id="cb26-6"><a href="glm-avec-une-distribution-binomiale.html#cb26-6"></a><span class="co"># un indice de qualité de l&#39;habitat (disponibilité de</span></span>
<span id="cb26-7"><a href="glm-avec-une-distribution-binomiale.html#cb26-7"></a><span class="co"># ressources).</span></span>
<span id="cb26-8"><a href="glm-avec-une-distribution-binomiale.html#cb26-8"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb26-9"><a href="glm-avec-une-distribution-binomiale.html#cb26-9"></a>n.infected &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb26-10"><a href="glm-avec-une-distribution-binomiale.html#cb26-10"></a>n.total &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dt">x =</span> <span class="dv">10</span>, <span class="dt">times =</span> <span class="dv">10</span>)</span>
<span id="cb26-11"><a href="glm-avec-une-distribution-binomiale.html#cb26-11"></a>res.avail &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">10</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb26-12"><a href="glm-avec-une-distribution-binomiale.html#cb26-12"></a><span class="co"># Ensuite, on spécifie le modèle. Prenez note comment on</span></span>
<span id="cb26-13"><a href="glm-avec-une-distribution-binomiale.html#cb26-13"></a><span class="co"># spécifie la variable réponse.  Il faut indiquer le nombre</span></span>
<span id="cb26-14"><a href="glm-avec-une-distribution-binomiale.html#cb26-14"></a><span class="co"># de fois où la maladie a été détectée et le nombre de fois</span></span>
<span id="cb26-15"><a href="glm-avec-une-distribution-binomiale.html#cb26-15"></a><span class="co"># où celle-ci n&#39;a pas été détectée.</span></span>
<span id="cb26-16"><a href="glm-avec-une-distribution-binomiale.html#cb26-16"></a>prop.reg &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">cbind</span>(n.infected, n.total <span class="op">-</span><span class="st"> </span>n.infected) <span class="op">~</span><span class="st"> </span>res.avail, </span>
<span id="cb26-17"><a href="glm-avec-une-distribution-binomiale.html#cb26-17"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb26-18"><a href="glm-avec-une-distribution-binomiale.html#cb26-18"></a><span class="kw">summary</span>(prop.reg)</span>
<span id="cb26-19"><a href="glm-avec-une-distribution-binomiale.html#cb26-19"></a><span class="co"># Si vos données sont déjà sous la forme de proportions,</span></span>
<span id="cb26-20"><a href="glm-avec-une-distribution-binomiale.html#cb26-20"></a><span class="co"># voici comment faire dans R : Créons tout d&#39;abord un vecteur</span></span>
<span id="cb26-21"><a href="glm-avec-une-distribution-binomiale.html#cb26-21"></a><span class="co"># de proportions :</span></span>
<span id="cb26-22"><a href="glm-avec-une-distribution-binomiale.html#cb26-22"></a>prop.infected &lt;-<span class="st"> </span>n.infected<span class="op">/</span>n.total</span>
<span id="cb26-23"><a href="glm-avec-une-distribution-binomiale.html#cb26-23"></a><span class="co"># On doit spécifier l&#39;argument &#39;weights&#39; de la fonction glm()</span></span>
<span id="cb26-24"><a href="glm-avec-une-distribution-binomiale.html#cb26-24"></a><span class="co"># pour indiquer le nombre d&#39;essais par site.</span></span>
<span id="cb26-25"><a href="glm-avec-une-distribution-binomiale.html#cb26-25"></a>prop.reg2 &lt;-<span class="st"> </span><span class="kw">glm</span>(prop.infected <span class="op">~</span><span class="st"> </span>res.avail, <span class="dt">family =</span> binomial, </span>
<span id="cb26-26"><a href="glm-avec-une-distribution-binomiale.html#cb26-26"></a>    <span class="dt">weights =</span> n.total)</span>
<span id="cb26-27"><a href="glm-avec-une-distribution-binomiale.html#cb26-27"></a><span class="kw">summary</span>(prop.reg2)</span>
<span id="cb26-28"><a href="glm-avec-une-distribution-binomiale.html#cb26-28"></a><span class="co"># Les sommaires des modèles prop.reg et prop.reg2 sont</span></span>
<span id="cb26-29"><a href="glm-avec-une-distribution-binomiale.html#cb26-29"></a><span class="co"># identiques !</span></span></code></pre></div>

</div>



<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="glm-avec-une-distribution-binomiale-bernouilli.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="que-avec-des-données-dabondance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
