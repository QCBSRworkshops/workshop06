<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 6 GLM avec une distribution binomiale | Atelier 6: Modèles linéaires généralisés en R</title>
  <meta name="description" content="Modèles linéaires généralisés en R" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 6 GLM avec une distribution binomiale | Atelier 6: Modèles linéaires généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 6 GLM avec une distribution binomiale | Atelier 6: Modèles linéaires généralisés en R" />
  
  <meta name="twitter:description" content="Modèles linéaires généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="modèle-linéaire-généralisé.html"/>
<link rel="next" href="glm-binomial-avec-des-proportions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html"><i class="fa fa-check"></i><b>3</b> Révision des modèles linéaires</a>
<ul>
<li class="chapter" data-level="3.1" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#modèles-linéaires-généraux"><i class="fa fa-check"></i><b>3.1</b> Modèles linéaires généraux</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#définition"><i class="fa fa-check"></i><b>3.1.1</b> Définition</a></li>
<li class="chapter" data-level="3.1.2" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#conditions-dutilisation"><i class="fa fa-check"></i><b>3.1.2</b> Conditions d’utilisation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#un-exemple-avec-les-modèles-linéaires-généraux"><i class="fa fa-check"></i><b>3.2</b> Un exemple avec les modèles linéaires généraux</a></li>
<li class="chapter" data-level="3.3" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#un-exemple-avec-des-vrais-données-des-modèles-linéaires-généraux"><i class="fa fa-check"></i><b>3.3</b> Un exemple avec des vrais données des modèles linéaires généraux</a></li>
<li class="chapter" data-level="3.4" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#les-conditions-dapplication-dun-modèle-linéaire"><i class="fa fa-check"></i><b>3.4</b> Les conditions d’application d’un modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#prédiction-du-modèle"><i class="fa fa-check"></i><b>3.4.1</b> Prédiction du modèle</a></li>
<li class="chapter" data-level="3.4.2" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#que-faire-transformer-nos-données"><i class="fa fa-check"></i><b>3.4.2</b> Que faire? Transformer nos données?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="les-distributions-des-données-biologiques.html"><a href="les-distributions-des-données-biologiques.html"><i class="fa fa-check"></i><b>4</b> Les distributions des données biologiques</a></li>
<li class="chapter" data-level="5" data-path="modèle-linéaire-généralisé.html"><a href="modèle-linéaire-généralisé.html"><i class="fa fa-check"></i><b>5</b> Modèle linéaire généralisé</a></li>
<li class="part"><span><b>GLM avec des données binaires</b></span></li>
<li class="chapter" data-level="6" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html"><i class="fa fa-check"></i><b>6</b> GLM avec une distribution binomiale</a>
<ul>
<li class="chapter" data-level="6.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#glm-avec-des-données-binomiales-lien-logit"><i class="fa fa-check"></i><b>6.1</b> GLM avec des données binomiales: lien logit</a></li>
<li class="chapter" data-level="6.2" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#exemple"><i class="fa fa-check"></i><b>6.2</b> Exemple</a></li>
<li class="chapter" data-level="6.3" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#défi-1"><i class="fa fa-check"></i><b>6.3</b> Défi 1</a></li>
<li class="chapter" data-level="6.4" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#interpréter-la-sortie-dune-régression-logistique"><i class="fa fa-check"></i><b>6.4</b> Interpréter la sortie d’une régression logistique</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#un-exemple-avec-le-lien-didentité"><i class="fa fa-check"></i><b>6.4.1</b> Un exemple avec le lien d’identité</a></li>
<li class="chapter" data-level="6.4.2" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#interprétation-avec-un-lien-logit"><i class="fa fa-check"></i><b>6.4.2</b> Interprétation avec un lien logit</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#pouvoir-prédictif-et-validation-du-modèle"><i class="fa fa-check"></i><b>6.5</b> Pouvoir prédictif et validation du modèle</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#défi-2"><i class="fa fa-check"></i><b>6.5.1</b> Défi 2</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#représentation-graphique-des-résultats"><i class="fa fa-check"></i><b>6.6</b> Représentation graphique des résultats</a></li>
</ul></li>
<li class="part"><span><b>GLM avec des données de proportions</b></span></li>
<li class="chapter" data-level="7" data-path="glm-binomial-avec-des-proportions.html"><a href="glm-binomial-avec-des-proportions.html"><i class="fa fa-check"></i><b>7</b> GLM binomial avec des proportions</a></li>
<li class="part"><span><b>GLM avec des données d’abondance</b></span></li>
<li class="chapter" data-level="8" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html"><i class="fa fa-check"></i><b>8</b> Que faire avec des données d’abondance?</a>
<ul>
<li class="chapter" data-level="8.1" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-de-poisson"><i class="fa fa-check"></i><b>8.1</b> GLM avec une distribution de Poisson</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#la-distribution-de-poisson"><i class="fa fa-check"></i><b>8.1.1</b> La distribution de Poisson</a></li>
<li class="chapter" data-level="8.1.2" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-de-poisson-dans-r"><i class="fa fa-check"></i><b>8.1.2</b> GLM de Poisson dans <code>R</code></a></li>
<li class="chapter" data-level="8.1.3" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#la-validation-du-modèle-et-le-problème-de-la-surdispersion"><i class="fa fa-check"></i><b>8.1.3</b> La validation du modèle et le problème de la surdispersion</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-quasi-poisson"><i class="fa fa-check"></i><b>8.2</b> GLM avec une distribution quasi-Poisson</a></li>
<li class="chapter" data-level="8.3" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-binomiale-négative"><i class="fa fa-check"></i><b>8.3</b> GLM avec une distribution binomiale négative</a></li>
<li class="chapter" data-level="8.4" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#représentation-graphique-du-modèle-final"><i class="fa fa-check"></i><b>8.4</b> Représentation graphique du modèle final</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#défi-3"><i class="fa fa-check"></i><b>8.4.1</b> Défi 3</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#conclusion-sur-les-glm-avec-des-données-dabondance"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les GLM avec des données d’abondance</a></li>
</ul></li>
<li class="part"><span><b>Autres distributions</b></span></li>
<li class="chapter" data-level="9" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>9</b> Autres distributions</a></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="10" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>10</b> Sommaire</a></li>
<li class="chapter" data-level="11" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>11</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 6: Modèles linéaires généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="glm-avec-une-distribution-binomiale" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapitre 6</span> GLM avec une distribution binomiale<a href="glm-avec-une-distribution-binomiale.html#glm-avec-une-distribution-binomiale" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Les variables binaires sont fréquentes en écologie : on observe un phénomène <span class="math inline">\(Y\)</span> ou son «absence». Par exemple, on note souvent la présence ou l’absence d’espèces lors d’études de terrain. Le but est généralement de déterminer si la présence d’une espèce est influencée par différentes variables environnementales. D’autres exemples courants sont la présence/absence d’une maladie au sein d’une population sauvage, l’observation/non-observation d’un comportement spécifique et la survie/mort d’un individu. Habituellement, nous sommes interessés à une question telle que: comment l’occurence d’une espèce varie en fonction des conditions de son environnement?</p>
<p><span class="math display">\[Occurrences = f(Environment)\]</span>
Sous un modèle linéaire, les valeurs attendues peuvent se trouver en dehors de l’étendu de <code>[0, 1]</code> avec la fonction ‘lm()’:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="glm-avec-une-distribution-binomiale.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up some binary data</span></span>
<span id="cb44-2"><a href="glm-avec-une-distribution-binomiale.html#cb44-2" aria-hidden="true" tabindex="-1"></a>Pres <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">40</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">40</span>))</span>
<span id="cb44-3"><a href="glm-avec-une-distribution-binomiale.html#cb44-3" aria-hidden="true" tabindex="-1"></a>rnor <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">1</span>, <span class="fl">12.5</span>, <span class="fl">7.5</span>),</span>
<span id="cb44-4"><a href="glm-avec-une-distribution-binomiale.html#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb44-5"><a href="glm-avec-une-distribution-binomiale.html#cb44-5" aria-hidden="true" tabindex="-1"></a>ExpVar <span class="ot">&lt;-</span> <span class="fu">sapply</span>(Pres, rnor)</span>
<span id="cb44-6"><a href="glm-avec-une-distribution-binomiale.html#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="glm-avec-une-distribution-binomiale.html#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model with binary data...</span></span>
<span id="cb44-8"><a href="glm-avec-une-distribution-binomiale.html#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Pres <span class="sc">~</span> ExpVar)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-40-1.png" width="50%" /><img src="book-fr_files/figure-html/unnamed-chunk-40-2.png" width="50%" /></p>
<p>Lorsqu’on prédit la probabilité d’observer un phénomène Y qui est une variable binaire, la valeur prédite doit se trouver entre 0 et 1 : c’est l’étendue possible d’une probabilité !</p>
<div id="glm-avec-des-données-binomiales-lien-logit" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> GLM avec des données binomiales: lien logit<a href="glm-avec-une-distribution-binomiale.html#glm-avec-des-données-binomiales-lien-logit" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tel que vu dans la section précdente, un modèle de régression qui utilise une variable binaire comme variable réponse est l’un de plusieurs modèles linéaires généralisés (GLM) et est appelé régression logistique ou modèle logit.</p>
<p>Un modèle <strong>linéaire généralisé</strong> est composé de <strong>prédicteurs linéaires</strong>:</p>
<p><span class="math display">\[\underbrace{g(\mu_i)}_{Link~~function}  = \underbrace{\beta_0 + \beta_1X_1~+~...~+~\beta_pX_p}_{Linear~component}\]</span>
Les chances mettre nos valeurs attendues sur une échelle de <code>0</code> à <code>+Inf</code>.</p>
<p>On prend ensuite les logarithmes, et calcule le <em>logit</em>:</p>
<p><span class="math display">\[\eta_i = \text{logit}(\mu_i) = \log(\frac{\mu_i}{1-\mu_i})\]</span></p>
<p>avec <span class="math inline">\(\mu\)</span> étant la valeur attendue (probabilité que <span class="math inline">\(Y = 1\)</span>), et les valeurs attendues s’étendant de <code>-Inf</code> à <code>+Inf</code>.</p>
<p>Dans ‘R’, la présence (ou succès, survie…) est habituellement codée par un <code>1</code> et une absence (ou échec, mort…) par un <code>0</code>. On effectue une régression logistique (ou n’importe quel GLM) à l’aide de la fonction <code>glm()</code>. Cette fonction diffère un peu de la fonction de base <code>lm()</code>, car elle permet de spécifier une distribution statistique autre que la distribution normale.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="glm-avec-une-distribution-binomiale.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(formula,</span>
<span id="cb45-2"><a href="glm-avec-une-distribution-binomiale.html#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> ???, <span class="co"># this argument allows us to set a probability distribution!</span></span>
<span id="cb45-3"><a href="glm-avec-une-distribution-binomiale.html#cb45-3" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb45-4"><a href="glm-avec-une-distribution-binomiale.html#cb45-4" aria-hidden="true" tabindex="-1"></a>    ...)</span></code></pre></div>
<p>Nous avons déjà vu que les variables binaires ne sont pas distribuées normalement (<em>i.e.</em> on observe un pic à 0 et un pic à 1 et rien entre les deux). Dans ‘R’, on spécifie la distribution statistique du modèle avec l’argument <code>family</code>. Pour la régression logistique, on l’indique de la façon suivante : <code>family = 'binomial</code>’.</p>
<table>
<colgroup>
<col width="28%" />
<col width="27%" />
<col width="20%" />
<col width="16%" />
<col width="6%" />
</colgroup>
<thead>
<tr class="header">
<th>Distribution de <span class="math inline">\(Y\)</span></th>
<th>Nom du fonction lien</th>
<th>Fonction lien</th>
<th>Modèle</th>
<th><code>R</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Normale</td>
<td>Identité</td>
<td><span class="math inline">\(g(\mu) = \mu\)</span></td>
<td><span class="math inline">\(\mu = \mathbf{X} \boldsymbol{\beta}\)</span></td>
<td><code>gaussian(link="identity")</code></td>
</tr>
<tr class="even">
<td>Binomiale</td>
<td>Logit</td>
<td><span class="math inline">\(g(\mu) = \log\left(\dfrac{\mu}{1-\mu}\right)\)</span></td>
<td><span class="math inline">\(\log\left(\dfrac{\mu}{1-\mu}\right) = \mathbf{X} \boldsymbol{\beta}\)</span></td>
<td><code>binomial(link="logit")</code></td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td>Log</td>
<td><span class="math inline">\(g(\mu) = \log(\mu)\)</span></td>
<td><span class="math inline">\(-\mu^{-1} = \mathbf{X} \boldsymbol{\beta}\)</span></td>
<td><code>poisson(link="log")</code></td>
</tr>
<tr class="even">
<td>Exponentielle</td>
<td>Inverse négative</td>
<td><span class="math inline">\(g(\mu) = -\mu^{-1}\)</span></td>
<td><span class="math inline">\(\log(\mu) = \mathbf{X} \boldsymbol{\beta}\)</span></td>
<td><code>Gamma(link="inverse")</code></td>
</tr>
</tbody>
</table>
<p>Dans <code>R</code>, nous pouvons donc construire notre GLM binomial avec un lien logit de cette façon:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="glm-avec-une-distribution-binomiale.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the syntax for a binomial GLM with a logit link</span></span>
<span id="cb46-2"><a href="glm-avec-une-distribution-binomiale.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(formula,</span>
<span id="cb46-3"><a href="glm-avec-une-distribution-binomiale.html#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), <span class="co"># this is also known as logistic</span></span>
<span id="cb46-4"><a href="glm-avec-une-distribution-binomiale.html#cb46-4" aria-hidden="true" tabindex="-1"></a>    data,</span>
<span id="cb46-5"><a href="glm-avec-une-distribution-binomiale.html#cb46-5" aria-hidden="true" tabindex="-1"></a>    ...)</span></code></pre></div>
</div>
<div id="exemple" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Exemple<a href="glm-avec-une-distribution-binomiale.html#exemple" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Construisons notre premier modèle linéaire généralisé! Ici, nous voulons construire notre modèle en utilisant le jeu de données <code>mites</code>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="glm-avec-une-distribution-binomiale.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd(&#39;...&#39;)</span></span>
<span id="cb47-2"><a href="glm-avec-une-distribution-binomiale.html#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="glm-avec-une-distribution-binomiale.html#cb47-3" aria-hidden="true" tabindex="-1"></a>mites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/mites.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-4"><a href="glm-avec-une-distribution-binomiale.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mites)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    70 obs. of  9 variables:
##  $ Galumna   : int  8 3 1 1 2 1 1 1 2 5 ...
##  $ pa        : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ totalabund: int  140 268 186 286 199 209 162 126 123 166 ...
##  $ prop      : num  0.05714 0.01119 0.00538 0.0035 0.01005 ...
##  $ SubsDens  : num  39.2 55 46.1 48.2 23.6 ...
##  $ WatrCont  : num  350 435 372 360 204 ...
##  $ Substrate : chr  &quot;Sphagn1&quot; &quot;Litter&quot; &quot;Interface&quot; &quot;Sphagn1&quot; ...
##  $ Shrub     : chr  &quot;Few&quot; &quot;Few&quot; &quot;Few&quot; &quot;Few&quot; ...
##  $ Topo      : chr  &quot;Hummock&quot; &quot;Hummock&quot; &quot;Hummock&quot; &quot;Hummock&quot; ...</code></pre>
<p>Nous pouvons modéliser notre régression logistique avec les doonées de présence de <em>Galumna</em> sp. en relation avec le contenu en eau et la topographie comme s’en suit, en utilisant <code>glm()</code> et l’argument <code>family</code>:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="glm-avec-une-distribution-binomiale.html#cb49-1" aria-hidden="true" tabindex="-1"></a>logit.reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(pa <span class="sc">~</span> WatrCont <span class="sc">+</span> Topo, <span class="at">data =</span> mites, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
<p>Pour la sortie du modèle:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="glm-avec-une-distribution-binomiale.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit.reg)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = pa ~ WatrCont + Topo, family = binomial(link = &quot;logit&quot;), 
##     data = mites)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0387  -0.5589  -0.1594   0.4112   2.0252  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  4.464402   1.670622   2.672 0.007533 ** 
## WatrCont    -0.015813   0.004535  -3.487 0.000489 ***
## TopoHummock  2.090757   0.735348   2.843 0.004466 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 91.246  on 69  degrees of freedom
## Residual deviance: 48.762  on 67  degrees of freedom
## AIC: 54.762
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Est-ce que la sortie vous dit quelque chose? Ressemble-t-elle à la sortie de <code>summary.lm()</code>? En effet! Cependant, vous remarquerez qu’il ya des petites différences (p.ex. le paramètre de dispersion) qui sont discutées plus loin dans ce guide!</p>
</div>
<div id="défi-1" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Défi 1<a href="glm-avec-une-distribution-binomiale.html#défi-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Avec le jeu de données <code>bacteria</code> (provenant du package <code>MASS</code>), modélisez la présence de <em>H. influenzae</em> en relation avec le traitement et la semaine du test.
Commençez avec le modèle complet, puis réduisez-le pour obtenir le modèle le plus parcimonieux.</p>
<p>Chargez le package <code>MASS</code> et le jeu de données <code>bacteria</code>:</p>
<pre><code>## &#39;data.frame&#39;:    220 obs. of  6 variables:
##  $ y   : Factor w/ 2 levels &quot;n&quot;,&quot;y&quot;: 2 2 2 2 2 2 1 2 2 2 ...
##  $ ap  : Factor w/ 2 levels &quot;a&quot;,&quot;p&quot;: 2 2 2 2 1 1 1 1 1 1 ...
##  $ hilo: Factor w/ 2 levels &quot;hi&quot;,&quot;lo&quot;: 1 1 1 1 1 1 1 1 2 2 ...
##  $ week: int  0 2 4 11 0 2 6 11 0 2 ...
##  $ ID  : Factor w/ 50 levels &quot;X01&quot;,&quot;X02&quot;,&quot;X03&quot;,..: 1 1 1 1 2 2 2 2 3 3 ...
##  $ trt : Factor w/ 3 levels &quot;placebo&quot;,&quot;drug&quot;,..: 1 1 1 1 3 3 3 3 2 2 ...</code></pre>
<p>Ce jeu de données a été créée pour tester la présence de la bactérie <em>H. influenzae</em> chez les enfants avec otitis media dans les territoire nordique de l’Australie. Dr A. Leach a testé les effets d’un un médicament sur 50 enfants ayant des antécédents d’otite moyenne dans le Territoire du Nord de l’Australie. Les enfants ont été choisis aléatoirement pour recevoir le médicament ou un placebo. La présence de <em>H. influenzae</em> a été contrôlée aux semaines 0, 2, 4, 6 et 11 : 30 de ces contrôles étaient manquants et ne sont pas inclus dans ce jeu de données.</p>
<details>
<summary>
<strong>Cliquez pour voir la solution au Défi 1!</strong>
</summary>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="glm-avec-une-distribution-binomiale.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Challenge 1 - Solution</span></span>
<span id="cb53-2"><a href="glm-avec-une-distribution-binomiale.html#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="glm-avec-une-distribution-binomiale.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit models (full to most parsimonious)</span></span>
<span id="cb53-4"><a href="glm-avec-une-distribution-binomiale.html#cb53-4" aria-hidden="true" tabindex="-1"></a>model.bact1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> trt <span class="sc">*</span> week, <span class="at">data =</span> bacteria, <span class="at">family =</span> binomial)</span>
<span id="cb53-5"><a href="glm-avec-une-distribution-binomiale.html#cb53-5" aria-hidden="true" tabindex="-1"></a>model.bact2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> trt <span class="sc">+</span> week, <span class="at">data =</span> bacteria, <span class="at">family =</span> binomial)</span>
<span id="cb53-6"><a href="glm-avec-une-distribution-binomiale.html#cb53-6" aria-hidden="true" tabindex="-1"></a>model.bact3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> week, <span class="at">data =</span> bacteria, <span class="at">family =</span> binomial)</span>
<span id="cb53-7"><a href="glm-avec-une-distribution-binomiale.html#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="glm-avec-une-distribution-binomiale.html#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s compare these models using a likelihood ratio test</span></span>
<span id="cb53-9"><a href="glm-avec-une-distribution-binomiale.html#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># (LRT).</span></span>
<span id="cb53-10"><a href="glm-avec-une-distribution-binomiale.html#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model.bact1, model.bact2, model.bact3, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: y ~ trt * week
## Model 2: y ~ trt + week
## Model 3: y ~ week
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  
## 1       214     203.12                       
## 2       216     203.81 -2  -0.6854  0.70984  
## 3       218     210.91 -2  -7.1026  0.02869 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="glm-avec-une-distribution-binomiale.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Which model is the best candidate?</span></span></code></pre></div>
<p>En se basant sur ces résultats, on doit choisir le modèle 2
comme celui représentant le mieux le jeu de données.</p>
</details>
</div>
<div id="interpréter-la-sortie-dune-régression-logistique" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Interpréter la sortie d’une régression logistique<a href="glm-avec-une-distribution-binomiale.html#interpréter-la-sortie-dune-régression-logistique" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>La sortie du modèle de régression logistique indique que les deux
variables explicatives (<code>WatrCont</code> et <code>Topo</code>) sont significatives:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="glm-avec-une-distribution-binomiale.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting model coefficients</span></span>
<span id="cb56-2"><a href="glm-avec-une-distribution-binomiale.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit.reg)<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>##                Estimate  Std. Error   z value     Pr(&gt;|z|)
## (Intercept)  4.46440199 1.670622482  2.672299 0.0075333598
## WatrCont    -0.01581255 0.004535069 -3.486728 0.0004889684
## TopoHummock  2.09075654 0.735348234  2.843220 0.0044660283</code></pre>
<p>Mais comment interprète-on les coefficients estimés?</p>
<p>Rappelez-vous que nous avons effectué une transformation des valeurs prédites par le modèle (<em>i.e.</em> la probabilité que <span class="math inline">\(Y = 1\)</span>), alors il faut utiliser une fonction inverse pour pouvoir interpréter correctement les résultats.</p>
<div id="un-exemple-avec-le-lien-didentité" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Un exemple avec le lien d’identité<a href="glm-avec-une-distribution-binomiale.html#un-exemple-avec-le-lien-didentité" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si nous avions utilisé une fonction de lien d’identité, l’interprétation serait beaucoup plus facile.</p>
<p>En assumant un résultat binaire <span class="math inline">\(y\)</span> et deux covariables <span class="math inline">\(x_1\)</span> et <span class="math inline">\(x_2\)</span> et une constante, la probabilité d’avoir un résultat favorable ( <span class="math inline">\(y = 1\)</span> ) est donné par:</p>
<p><span class="math display">\[Pr(y_i = 1) = p = g^{-1(\beta_0 + x_{1i}\beta_1 + x_{2i}\beta_2)}\]</span></p>
<p>où <span class="math inline">\(g^{-1}()\)</span> est la <strong>fonction lien d’identité inverse</strong>.</p>
<p>Pour un lien d’identité, l’interprétation du coefficient <span class="math inline">\(\beta_1\)</span> est plutôt simple:
Pour un incrément d’une unité de <span class="math inline">\(x_1\)</span>, <span class="math inline">\(\beta_1\)</span> donne une différence constante du résultat.</p>
<p><span class="math display">\[\Delta{y_i} = (\beta_0 +\beta_1(\color{red}{x_{1i} + 1}) + \beta_2x_{2i}) - (\beta_0 + \beta_1x_{1i} + \beta_2x_{2i})\]</span></p>
<p><span class="math display">\[\Delta{y_i} = \beta_1\]</span></p>
</div>
<div id="interprétation-avec-un-lien-logit" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Interprétation avec un lien logit<a href="glm-avec-une-distribution-binomiale.html#interprétation-avec-un-lien-logit" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour un modèle linéaire logistic avec deux covariables <span class="math inline">\(x_1\)</span> et <span class="math inline">\(x_2\)</span>, nous avons:</p>
<p><span class="math display">\[log({\dfrac{p}{1-p}})=\beta_0 + \beta_1x_{1i} + \beta_2x_{2i}\]</span></p>
<p>Ce qui correspong à notre ratio du log de nos cotes! Nous pouvons ainsi utiliser une fonction exponentielle pour réécrire notre modèle et obtenir le ratio des cotes:</p>
<p><span class="math display">\[\dfrac{p}{1-p}=exp(\beta_0 + \beta_1x_{1i} + \beta_2x_{2i})\]</span></p>
<p>Si nous voulons ainsi convertir les cotes en probabilité, selon le coefficient <span class="math inline">\(\alpha\)</span> nous pouvons utiliser la <strong>fonction de lien logit inverse</strong> (aussi appelé la fonction logistic):</p>
<p><span class="math display">\[ Pr(y_i = 1) = logit^{-1}(\alpha) = \dfrac{1}{1 + exp(-\alpha)} = (\dfrac{1}{1 + exp(-\alpha)}) * (\dfrac{exp(\alpha)}{exp(\alpha)}) = \dfrac{exp(\alpha)}{exp(\alpha) + 1}\]</span></p>
<p>Pour en revenir à notre modèle, cela nous donne:</p>
<p><span class="math display">\[Pr(y_i = 1) = \dfrac{exp(\beta_0 + \beta_1x_{1i} +\beta_2 x_{2i})}{1 + exp{(\beta_0 + \beta_1x_{1i} + \beta_2x_{2i})}}\]</span></p>
<p>Puisque la fonction de lien inverse n’Est pas linéaire, cela reste difficile d’interpréter le coefficient.
Cependant, nous pouvons observer ce qui arrive à la différence avec un incrément d’une unité de <span class="math inline">\(x_1\)</span>:</p>
<p><span class="math display">\[\Delta{y_i} = \dfrac{\exp(\beta_0 + \beta_1(\color{red}{x_{1i} + 1}) + \beta_2x_{2i})}{1 + \exp{(\beta_0 + \beta_1(\color{red}{x_{1i} + 1}) + \beta_2x_{2i})}} - \dfrac{\exp(\beta_0 + x_{1i}\beta_1 + \beta_2x_{2i})}{1 + \exp{(\beta_0 + \beta_1x_{1i} + \beta_2x_{2i})}}\]</span></p>
<p><span class="math display">\[\Delta{y_i} = \exp(\beta_1)\ \]</span></p>
<p>Lorsque <span class="math inline">\(x_1\)</span> augmente d’une unité, les cotes augmentes par un facteur de <span class="math inline">\(\exp(\beta_1)\)</span>.
à noter que les valeurs des cotes ici sont considérées dans une situation où les autres paramètres sont constants.</p>
<p>Avec ceci, nous pouvons finalement interpréter nos coefficients et les résultats de nos modèles!</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="glm-avec-une-distribution-binomiale.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(logit.reg<span class="sc">$</span>coefficients[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>##  WatrCont 
## 0.9843118</code></pre>
<p>Pour obtenir l’intervalle de confiance sur l’échelle des cotes :</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="glm-avec-une-distribution-binomiale.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(logit.reg)[<span class="dv">2</span>, ])</span></code></pre></div>
<pre><code>##     2.5 %    97.5 % 
## 0.9741887 0.9919435</code></pre>
<p>Lorsque la cote est inférieure à 1, l’interprétation est un peu plus compliquée. Si c’est le cas, il faut prendre la valeur inverse de la cote (<em>i.e.</em> 1 divisé par la cote) pour faciliter l’interprétation.</p>
<p>L’interprétation revient à dire comment l’observation d’un phénomène est <strong>MOINS</strong> probable. Pour le contenu en eau du sol, la cote est de 0.984. L’inverse est:
<span class="math display">\[\dfrac{1}{0.984} = 1.0159\]</span>.</p>
<p>Ceci signifie que l’augmentation d’une unité en contenu en eau diminue la vraisemblance d’observer la présence de <em>Galumna</em> sp. de 1.0159. On peut aussi l’exprimer en pourcentage en soustrayant 1 à cette valeur :
<span class="math inline">\((1.0159 - 1) * 100 = 1.59%\)</span>.</p>
<p>Il est 1.59 % moins vraisemblable d’observer <em>Galumna</em> sp. avec une augmentation d’une unité de contenu en eau. Pour se convaincre qu’on fait la bonne interprétation, on peut représenter graphiquement les résultats de la présence de <em>Galumna</em> sp. en fonction du contenu en eau du sol. On voit qu’en moyenne la présence de <em>Galumna</em> sp. est plus élevée lorsque le contenu en eau est faible.</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-51-1.png" width="480" /></p>
<p>Lorsqu’un paramètre estimé est entre 0 et 1 sur l’échelle des cotes, la relation entre la variable réponse et la variable explicative est <strong>négative</strong>. Si la valeur est supérieure à 1, la relation est <strong>positive</strong>. Si l’intervalle de confiance inclut la valeur 1, la relation n’est pas <em>significative</em>.</p>
<p>Rappelez-vous qu’une valeur de 1 sur l’échelle des cotes signifie que la probabilité d’observer un phénomène Y est la même que celle de ne pas observer ce phénomène (<em>i.e.</em> quand <span class="math inline">\(p\)</span> = 0.5, 0.5/(1-0.5) = 1).</p>
<p>Faisons de même avec la topographie:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="glm-avec-une-distribution-binomiale.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(logit.reg<span class="sc">$</span>coefficients[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## TopoHummock 
##    8.091034</code></pre>
<p>Le paramètre estimé pour la topographie est de 2.091 sur l’échelle des cotes en log. Donc, la probabilité est donnée par :</p>
<p><span class="math inline">\(1/(1+1/exp(2.091)) = 0.89\)</span> ce qui équivaut à <span class="math inline">\(1/(1+1/8.09)\)</span>.</p>
<p>Prenez note que la cote pour une variable explicative est calculée
lorsque les autres variables sont gardées constantes. La topographie a
une cote de 8.09. Ceci signifie que la probabilité d’observer <em>Galumna</em> sp. est 8.09 fois plus vraisemblable lorsque la topographie est de type <code>hummock</code> plutôt que <code>blanket</code>.</p>
<p>Calculons cette valeur de cote sans utiliser la fonction <code>exp()</code>:</p>
<p>On commence avec la valeur de cote pour la topographie du modèle <code>logit.reg</code>:<br />
<span class="math inline">\(µ/ (1 - µ) = 8.09\)</span></p>
<p>On réarrange pour isoler <span class="math inline">\(µ\)</span> :<br />
<span class="math inline">\(µ\)</span> = 8.09(1 - <span class="math inline">\(µ\)</span>) = 8.09 - 8.09<span class="math inline">\(µ\)</span><br />
8.09<span class="math inline">\(µ\)</span> + <span class="math inline">\(µ\)</span> = 8.09<br />
<span class="math inline">\(µ\)</span>(8.09 + 1) = 8.09<br />
<span class="math inline">\(µ\)</span> = 8.09 / (8.09 + 1)<br />
<span class="math inline">\(µ\)</span> = 1 / (1 + (1 / 8.09)) = 0.89<br />
</p>
<p>On obtient le même résultat sans utiliser la fonction logit inverse !</p>
</div>
</div>
<div id="pouvoir-prédictif-et-validation-du-modèle" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Pouvoir prédictif et validation du modèle<a href="glm-avec-une-distribution-binomiale.html#pouvoir-prédictif-et-validation-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Une façon simple et intuitive d’estimer le pouvoir explicatif d’un GLM
est de comparer la déviance du modèle à celle d’un modèle nul. La
déviance peut être vue comme une généralisation du concept de la somme
des carrés résiduelle lorsque le modèle est estimé par maximisation de
la vraisemblance (<em>i.e.</em> la méthode par laquelle on estime les
paramètres d’un GLM). Ceci nous permet de calculer un pseudo-R<sup>2</sup>, une
statistique similaire au R<sup>2</sup> dans une régression des moindres carrés
(<em>i.e.</em> la méthode utilisée pour estimer les paramètres d’une
régression linéaire de base). La forme générique pour calculer un pseudo-R<sup>2</sup> est :</p>
<p><span class="math display">\[\text{pseudo-R}^2 = \dfrac{\text{déviance nulle} - \text{déviance résiduelle}}{\text{déviance nulle}}\]</span></p>
<p>où «déviance du modèle nul» est la déviance du modèle nul et
«déviance résiduelle» est la déviance résiduelle du modèle d’intérêt.La différence est divisée par la déviance du modèle nul afin de
contraindre le pseudo-R<sup>2</sup> entre 0 et 1.</p>
<p>Le modèle nul correspond à un modèle sans variable explicative. Dans R, on l’indique de la façon suivante :
<code>null.model &lt;- glm(Response.variable ~ 1, family = binomial)</code>.</p>
<p>Une unité de déviance est la mesure de distance entre <span class="math inline">\(y\)</span> et <span class="math inline">\(μ\)</span>.</p>
<p><span class="math display">\[{\displaystyle d(y,y)=0}\]</span>
<span class="math display">\[{\displaystyle d(y,\mu )&gt;0\quad \forall y\neq \mu }\]</span></p>
<p>La déviance totale <span class="math inline">\({\displaystyle D(\mathbf {y} ,{\hat {\boldsymbol {\mu }}})}\)</span> d’une modèle avec ses prédictions <span class="math inline">\({\hat {\boldsymbol {\mu }}}\)</span> de l’observation <span class="math inline">\(\mathbf {y}\)</span> est la somme de ses unités de déviances :
<span class="math display">\[{\displaystyle D(\mathbf {y} ,{\hat {\boldsymbol {\mu }}})=\sum _{i}d(y_{i},{\hat {\mu }}_{i})}\]</span></p>
<p>Maintenant, la déviance d’un modèle estimé <span class="math inline">\({\hat {\mu }}=E[Y|{\hat {\theta }}_{0}]\)</span> peut être défini par sa <strong>vraisemblance</strong>:
<span class="math display">\[D(y,{\hat {\mu }})=2{\Big (}\log {\big (}p(y\mid {\hat {\theta }}_{s}){\big )}-\log {\big (}p(y\mid {\hat {\theta }}_{0}){\big )}{\Big )}\]</span>
avec <span class="math inline">\(\hat \theta_0\)</span> dénotant la valeurs ajustées du paramètre dans le modèle réduit, alors que <span class="math inline">\({\displaystyle {\hat {\theta }}_{s}}\hat \theta_s\)</span> dénotes les paramètres ajustés pour le modèle saturé.</p>
<p>La <strong>déviance résiduelle</strong> est définie comme 2 fois le ratio de la vraisemblence en log du modèle saturé comparé au modèle réduit:
<span class="math display">\[D(y,{\hat {\mu }})=2{\Big (}\log {\big (}p(\text{modèle saturé}){\big )}-\log {\big (}p(\text{modèle réduit}){\big )}{\Big )}\]</span></p>
<p>Enfin, la <strong>déviance nulle</strong> est définie comme 2 fois le ratio de la vraisemblence en log du modèle saturé comparé au modèle réduit (i.e. les variables prédictrices = 1).</p>
<p><span class="math display">\[D(y,{\hat {\mu }})=2{\Big (}\log {\big (}p(\text{modèle saturé}){\big )}-\log {\big (}p(\text{modèle nul}){\big )}{\Big )}\]</span></p>
<p>Maintenant, nous pouvons le faire dans R. Comparons la déviance de notre modèle (déviance résiduelle) à la déviance d’un modèle nul (déviance nulle).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="glm-avec-une-distribution-binomiale.html#cb64-1" aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(response.variable <span class="sc">~</span> <span class="dv">1</span>, <span class="at">family =</span> binomial)</span></code></pre></div>
<p>Le modèle <strong>saturé (ou complet)</strong> contient l’ensemble des variables prédisctrices:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="glm-avec-une-distribution-binomiale.html#cb65-1" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(response.variable <span class="sc">~</span> ., <span class="at">family =</span> binomial)</span></code></pre></div>
<p>Les déviances résiduelles et nulles sont déjà stockées dans <code>glm object</code>:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="glm-avec-une-distribution-binomiale.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Les déviances résiduelle et nulle sont déjà enregistrées</span></span>
<span id="cb66-2"><a href="glm-avec-une-distribution-binomiale.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># dans un objet de type glm.</span></span>
<span id="cb66-3"><a href="glm-avec-une-distribution-binomiale.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">objects</span>(logit.reg)</span></code></pre></div>
<pre><code>##  [1] &quot;aic&quot;               &quot;boundary&quot;          &quot;call&quot;             
##  [4] &quot;coefficients&quot;      &quot;contrasts&quot;         &quot;control&quot;          
##  [7] &quot;converged&quot;         &quot;data&quot;              &quot;deviance&quot;         
## [10] &quot;df.null&quot;           &quot;df.residual&quot;       &quot;effects&quot;          
## [13] &quot;family&quot;            &quot;fitted.values&quot;     &quot;formula&quot;          
## [16] &quot;iter&quot;              &quot;linear.predictors&quot; &quot;method&quot;           
## [19] &quot;model&quot;             &quot;null.deviance&quot;     &quot;offset&quot;           
## [22] &quot;prior.weights&quot;     &quot;qr&quot;                &quot;R&quot;                
## [25] &quot;rank&quot;              &quot;residuals&quot;         &quot;terms&quot;            
## [28] &quot;weights&quot;           &quot;xlevels&quot;           &quot;y&quot;</code></pre>
<p>Nous pouvons mainteant utiliser ces déviances pour calculer la valeur du pseudo-R<sup>2</sup>:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="glm-avec-une-distribution-binomiale.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcule pseudo-R2</span></span>
<span id="cb68-2"><a href="glm-avec-une-distribution-binomiale.html#cb68-2" aria-hidden="true" tabindex="-1"></a>pseudoR2 <span class="ot">&lt;-</span> (logit.reg<span class="sc">$</span>null.deviance <span class="sc">-</span> logit.reg<span class="sc">$</span>deviance)<span class="sc">/</span>logit.reg<span class="sc">$</span>null.deviance</span>
<span id="cb68-3"><a href="glm-avec-une-distribution-binomiale.html#cb68-3" aria-hidden="true" tabindex="-1"></a>pseudoR2</span></code></pre></div>
<pre><code>## [1] 0.4655937</code></pre>
<p>Les variables explicatives du modèle expliquent 46.6% de la variabilité de la variable réponse.</p>
<p>Un pseudo-R<sup>2</sup> de McFadden ajusté, qui pénalise pour le nombre de
prédicteurs, peut être calculé comme suit:</p>
<p><img src="images/McFadden.PNG" /></p>
<p>où <strong>K</strong> correspond au nombre supplémentaire de prédicteurs par rapport au modèle nul.</p>
<p>La qualité d’ajustement des modèles de régression logistique peut être
exprimée par des variantes de statistiques pseudo-R<sup>2</sup>, telles que les
mesures de Maddala (1983) ou de Cragg et Uhler (1970).</p>
<p>Lorsqu’on parle de régressions logistiques, les valeurs faibles de <strong>R<sup>2</sup></strong>
sont courantes.</p>
<p>La fonction R <code>DescTools::PseudoR2()</code> permet de calculer plusieurs pseudo-R<sup>2</sup>. En spécifiant <code>which = all</code>, calculez toutes les statistiques en même temps.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="glm-avec-une-distribution-binomiale.html#cb70-1" aria-hidden="true" tabindex="-1"></a>logit.reg <span class="ot">&lt;-</span> <span class="fu">glm</span>(pa <span class="sc">~</span> WatrCont <span class="sc">+</span> Topo, <span class="at">data =</span> mites, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb70-2"><a href="glm-avec-une-distribution-binomiale.html#cb70-2" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">PseudoR2</span>(logit.reg, <span class="at">which =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<pre><code>##        McFadden     McFaddenAdj        CoxSnell      Nagelkerke   AldrichNelson 
##       0.4655937       0.3998373       0.4549662       0.6245898       0.3776866 
## VeallZimmermann           Efron McKelveyZavoina            Tjur             AIC 
##       0.6674318       0.5024101       0.7064093       0.5114661      54.7623962 
##             BIC          logLik         logLik0              G2 
##      61.5078819     -24.3811981     -45.6229593      42.4835224</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="glm-avec-une-distribution-binomiale.html#cb72-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">Rsq</span>(<span class="at">object =</span> logit.reg)</span>
<span id="cb72-2"><a href="glm-avec-une-distribution-binomiale.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">HLtest</span>(<span class="at">object =</span> fit)</span>
<span id="cb72-3"><a href="glm-avec-une-distribution-binomiale.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># La valeur de p est de 0.9051814. Donc, on ne rejète pas</span></span>
<span id="cb72-4"><a href="glm-avec-une-distribution-binomiale.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="co"># notre modèle.  L&#39;ajustement du modèle est bon.</span></span></code></pre></div>
<div id="défi-2" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Défi 2<a href="glm-avec-une-distribution-binomiale.html#défi-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Évaluez l’ajustement et le pouvoir prédictif du modèle <code>model.bact2</code>.
Comment pouvez-vous améliorer le pouvoir prédictif du modèle ?</p>
<details>
<summary>
<strong>Cliquez pour voir la solution au Défi 2!</strong>
</summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="glm-avec-une-distribution-binomiale.html#cb73-1" aria-hidden="true" tabindex="-1"></a>null.d <span class="ot">&lt;-</span> model.bact2<span class="sc">$</span>null.deviance</span>
<span id="cb73-2"><a href="glm-avec-une-distribution-binomiale.html#cb73-2" aria-hidden="true" tabindex="-1"></a>resid.d <span class="ot">&lt;-</span> model.bact2<span class="sc">$</span>deviance</span>
<span id="cb73-3"><a href="glm-avec-une-distribution-binomiale.html#cb73-3" aria-hidden="true" tabindex="-1"></a>bact.pseudoR2 <span class="ot">&lt;-</span> (null.d <span class="sc">-</span> resid.d)<span class="sc">/</span>null.d</span>
<span id="cb73-4"><a href="glm-avec-une-distribution-binomiale.html#cb73-4" aria-hidden="true" tabindex="-1"></a>bact.pseudoR2</span></code></pre></div>
<pre><code>## [1] 0.0624257</code></pre>
<p>C’est très faible!</p>
<p>Le pouvoir prédictif pourrait être augmenté en incluant plus de
variables explicatives.</p>
</details>
</div>
</div>
<div id="représentation-graphique-des-résultats" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Représentation graphique des résultats<a href="glm-avec-une-distribution-binomiale.html#représentation-graphique-des-résultats" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Lorsque le modèle a été validé, il peut être utile de représenter les
résultats graphiquement. Voici un exemple avec le paquet <code>ggplot2</code>. Revoir <a href="r_workshop3">l’atelier 3</a> pour plus d’informations sur ce paquet.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="glm-avec-une-distribution-binomiale.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mites, <span class="fu">aes</span>(<span class="at">x =</span> WatrCont, <span class="at">y =</span> pa)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb75-2"><a href="glm-avec-une-distribution-binomiale.html#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> binomial), <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Contenu en eau&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-3"><a href="glm-avec-une-distribution-binomiale.html#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Probabilité de présence&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Probabilité de présence de Galumna sp. en fonction du contenu en eau&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-4"><a href="glm-avec-une-distribution-binomiale.html#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-61-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>



<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="modèle-linéaire-généralisé.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="glm-binomial-avec-des-proportions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
