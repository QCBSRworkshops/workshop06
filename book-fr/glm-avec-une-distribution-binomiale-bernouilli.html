<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 5 GLM avec une distribution binomiale (Bernouilli) | Atelier 6: Modèles linéaires généralisés en R</title>
  <meta name="description" content="Modèles linéaires généralisés en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 5 GLM avec une distribution binomiale (Bernouilli) | Atelier 6: Modèles linéaires généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 5 GLM avec une distribution binomiale (Bernouilli) | Atelier 6: Modèles linéaires généralisés en R" />
  
  <meta name="twitter:description" content="Modèles linéaires généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="les-distributions-des-données-biologiques.html"/>
<link rel="next" href="la-fonction-de-lien.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><i class="fa fa-check"></i><b>3</b> Quel est l’utilité des modèles linéaires généralisés?</a></li>
<li class="chapter" data-level="4" data-path="les-distributions-des-données-biologiques.html"><a href="les-distributions-des-données-biologiques.html"><i class="fa fa-check"></i><b>4</b> Les distributions des données biologiques</a></li>
<li class="part"><span><b>GLM avec des données binaires</b></span></li>
<li class="chapter" data-level="5" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html"><i class="fa fa-check"></i><b>5</b> GLM avec une distribution binomiale (Bernouilli)</a></li>
<li class="chapter" data-level="6" data-path="la-fonction-de-lien.html"><a href="la-fonction-de-lien.html"><i class="fa fa-check"></i><b>6</b> La fonction de lien</a><ul>
<li class="chapter" data-level="6.1" data-path="la-fonction-de-lien.html"><a href="la-fonction-de-lien.html#défi-1"><i class="fa fa-check"></i><b>6.1</b> Défi 1</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interpréter-la-sortie-dune-régression-logistique.html"><a href="interpréter-la-sortie-dune-régression-logistique.html"><i class="fa fa-check"></i><b>7</b> Interpréter la sortie d’une régression logistique</a></li>
<li class="chapter" data-level="8" data-path="pouvoir-prédictif-et-validation-du-modèle.html"><a href="pouvoir-prédictif-et-validation-du-modèle.html"><i class="fa fa-check"></i><b>8</b> Pouvoir prédictif et validation du modèle</a><ul>
<li class="chapter" data-level="8.1" data-path="pouvoir-prédictif-et-validation-du-modèle.html"><a href="pouvoir-prédictif-et-validation-du-modèle.html#défi-2"><i class="fa fa-check"></i><b>8.1</b> Défi 2</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="représentation-graphique-des-résultats.html"><a href="représentation-graphique-des-résultats.html"><i class="fa fa-check"></i><b>9</b> Représentation graphique des résultats</a></li>
<li class="part"><span><b>GLM avec des données de proportions</b></span></li>
<li class="chapter" data-level="10" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html"><i class="fa fa-check"></i><b>10</b> GLM avec une distribution binomiale</a></li>
<li class="part"><span><b>GLM avec des données d’abondance</b></span><ul>
<li class="chapter" data-level="10.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#glm-avec-une-distribution-de-poisson"><i class="fa fa-check"></i><b>10.1</b> GLM avec une distribution de Poisson</a><ul>
<li class="chapter" data-level="10.1.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#la-validation-du-modèle-et-le-problème-de-la-surdispersion"><i class="fa fa-check"></i><b>10.1.1</b> La validation du modèle et le problème de la surdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>11</b> quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="12" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>12</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="12.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#représentation-graphique-du-modèle-final"><i class="fa fa-check"></i><b>12.1</b> Représentation graphique du modèle final</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>13</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Autres distributions</b></span></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="14" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>14</b> Sommaire</a></li>
<li class="chapter" data-level="15" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>15</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="16" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>16</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 6: Modèles linéaires généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="glm-avec-une-distribution-binomiale-bernouilli" class="section level1">
<h1><span class="header-section-number">Chapitre 5</span> GLM avec une distribution binomiale (Bernouilli)</h1>
<p>Les variables binaires sont fréquentes en écologie : on observe un
phénomène X ou son "absence". Par exemple, on note souvent la présence
ou l’absence d’espèces lors d’études de terrain. Le but est
généralement de déterminer si la présence d’une espèce est influencée
par différentes variables environnementales. D’autres exemples courants
sont la présence/absence d’une maladie au sein d’une population
sauvage, l’observation/non-observation d’un comportement spécifique et
la survie/mort d’un individu. Un modèle de régression qui utilise une
variable binaire comme variable réponse est l’un de plusieurs modèles
linéaires généralisés (GLM) et est appelé régression logistique ou
modèle logit.</p>
<p>Dans R, la présence (ou succès, survie…) est habituellement codée par
un <code>1</code> et une absence (ou échec, mort…) par un <code>0</code>. On effectue une
régression logistique (ou n’importe quel GLM) à l’aide de la fonction
<code>glm()</code>. Cette fonction diffère un peu de la fonction de base <code>lm()</code>,
car elle permet de spécifier une distribution statistique autre que la
distribution normale. Nous avons déjà vu que les variables binaires ne
sont pas distribuées normalement (<em>i.e.</em> on observe un pic à 0 et un pic
à 1 et rien entre les deux). La dernière section a montré que la
distribution de Bernoulli est appropriée pour modéliser les variables
réponses binaires. La moyenne de cette distribution est représentée par
la probabilité <em>p</em> d’observer un résultat et la variance est calculée
par <em>p</em>*(1 - <em>p</em>). Le terme (1 - <em>p</em>) représente la probabilité de ne
<strong>pas</strong> observer un résultat. Dans R, on spécifie la distribution
statistique du modèle avec l’argument <code>family</code>. Pour la régression
logistique, on l’indique de la façon suivante : <code>family = 'binomial</code>’.
Rappelez-vous que la distribution de Bernoulli est un cas spécifique de
la distribution binomiale lorsque le nombre de répétitions est égal à 1:
R "comprend" qu’il faut utiliser une distribution de Bernoulli.</p>
<p>Lorsqu’on prédit la probabilité d’observer un phénomène Y qui est une
variable binaire, la valeur prédite doit se trouver entre 0 et 1 :
c’est l’étendue possible d’une probabilité ! Si on utilise un modèle
linéaire de base pour modéliser une variable binaire en fonction de
variables explicatives, il est fort possible qu’on obtienne des valeurs
prédites qui se retrouvent en dehors de l’intervalle <span class="math display">\[0,1\]</span>, ce qui ne
fait aucun sens. L’exemple suivant va vous permettre de mieux
comprendre pourquoi un modèle linéaire traditionnel est inapproprié. La
prochaine sous-section va vous montrer comment éviter ce problème avec
une fonction de lien. Brièvement, une fonction de lien est utilisée pour
linéariser la relation entre les valeurs prédites d’un modèle et le
prédicteur linéaire (voir sous-section suivante).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-1"></a>model.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mites)</span>
<span id="cb15-2"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-2"></a><span class="kw">fitted</span>(model.lm)</span>
<span id="cb15-3"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-3"></a><span class="co"># La fonction &#39;fitted()&#39; extraie les valeurs prédites de la</span></span>
<span id="cb15-4"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-4"></a><span class="co"># variable réponse du modèle linéaire.  Certaines valeurs</span></span>
<span id="cb15-5"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-5"></a><span class="co"># sont en-dessous de 0, ce qui ne fait pas de sens pour une</span></span>
<span id="cb15-6"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-6"></a><span class="co"># régression logistique.  Essayong le même modèle, mais avec</span></span>
<span id="cb15-7"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-7"></a><span class="co"># une distribution binomiale cette fois-ci.  Remarquez</span></span>
<span id="cb15-8"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-8"></a><span class="co"># l&#39;argument &#39;family&#39; pour spécifier la distribution.</span></span>
<span id="cb15-9"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-9"></a>model.glm &lt;-<span class="st"> </span><span class="kw">glm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mites, <span class="dt">family =</span> binomial)</span>
<span id="cb15-10"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-10"></a><span class="kw">fitted</span>(model.glm)</span>
<span id="cb15-11"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#cb15-11"></a><span class="co"># Toutes les valeurs sont comprises entre 0 et 1.</span></span></code></pre></div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="les-distributions-des-données-biologiques.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="la-fonction-de-lien.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
