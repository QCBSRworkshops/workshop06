<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 8 Que faire avec des données d’abondance? | Atelier 6: Modèles linéaires généralisés en R</title>
  <meta name="description" content="Modèles linéaires généralisés en R" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 8 Que faire avec des données d’abondance? | Atelier 6: Modèles linéaires généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 8 Que faire avec des données d’abondance? | Atelier 6: Modèles linéaires généralisés en R" />
  
  <meta name="twitter:description" content="Modèles linéaires généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="glm-binomial-avec-des-proportions.html"/>
<link rel="next" href="autres-distributions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html"><i class="fa fa-check"></i><b>3</b> Révision des modèles linéaires</a>
<ul>
<li class="chapter" data-level="3.1" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#modèles-linéaires-généraux"><i class="fa fa-check"></i><b>3.1</b> Modèles linéaires généraux</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#définition"><i class="fa fa-check"></i><b>3.1.1</b> Définition</a></li>
<li class="chapter" data-level="3.1.2" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#conditions-dutilisation"><i class="fa fa-check"></i><b>3.1.2</b> Conditions d’utilisation</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#un-exemple-avec-les-modèles-linéaires-généraux"><i class="fa fa-check"></i><b>3.2</b> Un exemple avec les modèles linéaires généraux</a></li>
<li class="chapter" data-level="3.3" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#un-exemple-avec-des-vrais-données-des-modèles-linéaires-généraux"><i class="fa fa-check"></i><b>3.3</b> Un exemple avec des vrais données des modèles linéaires généraux</a></li>
<li class="chapter" data-level="3.4" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#les-conditions-dapplication-dun-modèle-linéaire"><i class="fa fa-check"></i><b>3.4</b> Les conditions d’application d’un modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#prédiction-du-modèle"><i class="fa fa-check"></i><b>3.4.1</b> Prédiction du modèle</a></li>
<li class="chapter" data-level="3.4.2" data-path="révision-des-modèles-linéaires.html"><a href="révision-des-modèles-linéaires.html#que-faire-transformer-nos-données"><i class="fa fa-check"></i><b>3.4.2</b> Que faire? Transformer nos données?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="les-distributions-des-données-biologiques.html"><a href="les-distributions-des-données-biologiques.html"><i class="fa fa-check"></i><b>4</b> Les distributions des données biologiques</a></li>
<li class="chapter" data-level="5" data-path="modèle-linéaire-généralisé.html"><a href="modèle-linéaire-généralisé.html"><i class="fa fa-check"></i><b>5</b> Modèle linéaire généralisé</a></li>
<li class="part"><span><b>GLM avec des données binaires</b></span></li>
<li class="chapter" data-level="6" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html"><i class="fa fa-check"></i><b>6</b> GLM avec une distribution binomiale</a>
<ul>
<li class="chapter" data-level="6.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#glm-avec-des-données-binomiales-lien-logit"><i class="fa fa-check"></i><b>6.1</b> GLM avec des données binomiales: lien logit</a></li>
<li class="chapter" data-level="6.2" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#exemple"><i class="fa fa-check"></i><b>6.2</b> Exemple</a></li>
<li class="chapter" data-level="6.3" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#défi-1"><i class="fa fa-check"></i><b>6.3</b> Défi 1</a></li>
<li class="chapter" data-level="6.4" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#interpréter-la-sortie-dune-régression-logistique"><i class="fa fa-check"></i><b>6.4</b> Interpréter la sortie d’une régression logistique</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#un-exemple-avec-le-lien-didentité"><i class="fa fa-check"></i><b>6.4.1</b> Un exemple avec le lien d’identité</a></li>
<li class="chapter" data-level="6.4.2" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#interprétation-avec-un-lien-logit"><i class="fa fa-check"></i><b>6.4.2</b> Interprétation avec un lien logit</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#pouvoir-prédictif-et-validation-du-modèle"><i class="fa fa-check"></i><b>6.5</b> Pouvoir prédictif et validation du modèle</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#défi-2"><i class="fa fa-check"></i><b>6.5.1</b> Défi 2</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html#représentation-graphique-des-résultats"><i class="fa fa-check"></i><b>6.6</b> Représentation graphique des résultats</a></li>
</ul></li>
<li class="part"><span><b>GLM avec des données de proportions</b></span></li>
<li class="chapter" data-level="7" data-path="glm-binomial-avec-des-proportions.html"><a href="glm-binomial-avec-des-proportions.html"><i class="fa fa-check"></i><b>7</b> GLM binomial avec des proportions</a></li>
<li class="part"><span><b>GLM avec des données d’abondance</b></span></li>
<li class="chapter" data-level="8" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html"><i class="fa fa-check"></i><b>8</b> Que faire avec des données d’abondance?</a>
<ul>
<li class="chapter" data-level="8.1" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-de-poisson"><i class="fa fa-check"></i><b>8.1</b> GLM avec une distribution de Poisson</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#la-distribution-de-poisson"><i class="fa fa-check"></i><b>8.1.1</b> La distribution de Poisson</a></li>
<li class="chapter" data-level="8.1.2" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-de-poisson-dans-r"><i class="fa fa-check"></i><b>8.1.2</b> GLM de Poisson dans <code>R</code></a></li>
<li class="chapter" data-level="8.1.3" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#la-validation-du-modèle-et-le-problème-de-la-surdispersion"><i class="fa fa-check"></i><b>8.1.3</b> La validation du modèle et le problème de la surdispersion</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-quasi-poisson"><i class="fa fa-check"></i><b>8.2</b> GLM avec une distribution quasi-Poisson</a></li>
<li class="chapter" data-level="8.3" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-binomiale-négative"><i class="fa fa-check"></i><b>8.3</b> GLM avec une distribution binomiale négative</a></li>
<li class="chapter" data-level="8.4" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#représentation-graphique-du-modèle-final"><i class="fa fa-check"></i><b>8.4</b> Représentation graphique du modèle final</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#défi-3"><i class="fa fa-check"></i><b>8.4.1</b> Défi 3</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="que-faire-avec-des-données-dabondance.html"><a href="que-faire-avec-des-données-dabondance.html#conclusion-sur-les-glm-avec-des-données-dabondance"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les GLM avec des données d’abondance</a></li>
</ul></li>
<li class="part"><span><b>Autres distributions</b></span></li>
<li class="chapter" data-level="9" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>9</b> Autres distributions</a></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="10" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>10</b> Sommaire</a></li>
<li class="chapter" data-level="11" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>11</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 6: Modèles linéaires généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="que-faire-avec-des-données-dabondance" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapitre 8</span> Que faire avec des données d’abondance?<a href="que-faire-avec-des-données-dabondance.html#que-faire-avec-des-données-dabondance" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Les données discrètes (ou d’abondance) sont caractérisées par:</p>
<ul>
<li>Des valeurs positives: on ne peut compter -7 individus</li>
<li>Valeurs discrètes: on ne peut compter 7.56 individus</li>
<li>Démontre une variance élevée pour des valeurs élevées</li>
</ul>
<p>Afin d’illustrer l’utilisation des GLMs avec des données d’abondance, nous allons utiliser un nouveau jeux de données: <code>faramea</code>.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="que-faire-avec-des-données-dabondance.html#cb80-1" aria-hidden="true" tabindex="-1"></a>faramea <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;faramea.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Ce jeux de données s’intéresse à l’espèce d’arbre <em>Faramea occidentalis</em> sur l’île Barro Colorado au Panama. 43 transects ont été utilisés afin de mesurer le nombre d’arbre le long d’un gradient environnemental. Des caractéristiques environnementales, comme l’élévation du terrain et la précipitation, ont aussi été mesurées au niveau de chaque transect. Examinons maintenant à quoi ressemble la distribution du nombre d’arbres par transect.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="que-faire-avec-des-données-dabondance.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram of F. occidentalis count data</span></span>
<span id="cb81-2"><a href="que-faire-avec-des-données-dabondance.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(faramea<span class="sc">$</span>Faramea.occidentalis, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">45</span>, <span class="dv">1</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Nombre de &quot;</span>,</span>
<span id="cb81-3"><a href="que-faire-avec-des-données-dabondance.html#cb81-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">italic</span>(Faramea <span class="sc">~</span> occidentalis))), <span class="at">ylab =</span> <span class="st">&quot;Fréquence&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb81-4"><a href="que-faire-avec-des-données-dabondance.html#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-66-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Nous pouvons remarquer qu’il n’y a que des valeurs entières et
positives.</p>
<p>Pour cet exemple, nous voulons tester si l’élévation (un prédicteur à valeurs continues) influence l’abondance de <em>Faramea occidentalis</em>.</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Etant donné cette spécificité propre aux données de dénombrement, la distribution de Poisson, semble un choix approprié pour modéliser ces données avec l’élévation.</p>
<div id="glm-avec-une-distribution-de-poisson" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> GLM avec une distribution de Poisson<a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-de-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="la-distribution-de-poisson" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> La distribution de Poisson<a href="que-faire-avec-des-données-dabondance.html#la-distribution-de-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La distribution de Poisson specifie que la probabilité d’une variable
discrète aléatoire <span class="math inline">\(Y\)</span> est donné par:</p>
<p><span class="math display">\[f(y, \,\mu)\, =\, Pr(Y = y)\, =\, \frac{\mu^y \times e^{-\mu}}{y!}\]</span></p>
<p><span class="math display">\[E(Y)\, =\, Var(Y)\, =\, \mu\]</span></p>
<p>où <span class="math inline">\(\mu\)</span> est le paramètre de la distribution de Poisson</p>
<p>La distribution de Poisson est particulièrement appropriée pour modéliser des données de dénombrement
car :</p>
<ul>
<li>elle ne spécifie des probabilités que pour des valeurs entières</li>
<li><span class="math inline">\(P(y&lt;0) = 0\)</span>, en d’autres termes la probabilité d’observer une
valeur négative est nulle</li>
<li>la relation entre la moyenne et la variance permet de manipuler des données hétérogènes (e.g. quand la variance dans les données augmente avec la moyenne)</li>
</ul>
<p>Un GLM de Poisson va modéliser la valeur de <span class="math inline">\(\mu\)</span> comme un fonction de différente variables prédictrices:</p>
<p><strong>Étape 1.</strong></p>
<p>Nous assumons que <span class="math inline">\(Y_i\)</span> suit une distribution de Poisson avec un moyenne et une variance <span class="math inline">\(\mu_i\)</span>.</p>
<p><span class="math display">\[Y_i ∼ Poisson(\mu_i)\]</span></p>
<p><span class="math display">\[E(Y_i) = Var(Y_i) = \mu_i\]</span></p>
<p><span class="math display">\[f(y_i, \, \mu_i) = \frac{\mu^{y_i}_i \times e^{-\mu_i}}{y!}\]</span></p>
<p><span class="math inline">\(\mu_i\)</span> est le nombre attendu d’individus.</p>
<p><strong>Étape 2.</strong></p>
<p>Nous spécifions le prédicteur linéaire du modèle en tant qu’un modèle linéaire.</p>
<p><span class="math display">\[\underbrace{\alpha}_\text{Interception} + \underbrace{\beta_1}_\text{pente de &#39;Élévation&#39;} \times \text{Élévation}_i + \underbrace{\beta_2}_\text{pente de &#39;Précipitation&#39;} \times \text{Précipitation}_i\]</span></p>
<p><strong>Étape 3.</strong></p>
<p>La fonction de lien entre la moyenne <span class="math inline">\(Y_i\)</span> et le prédicteur linéaire est une fonction logarithmique et peut être écrit de cette façon:</p>
<p><span class="math display">\[log(\mu_i) = \alpha + \beta_1 \times \text{Élévation}_i + \beta_2 \times \text{Précipitation}_i\]</span></p>
<p>ou écrit tel que:</p>
<p><span class="math display">\[\mu_i = e^{ \alpha + \beta_1 \times \text{Élévation}_i + \beta_2 \times \text{Précipitation}_i}\]</span></p>
<p>Ceci démontre que l’impact de chaque variable prédictrice est multiplicatif. En augmentant l’élévation de 1, on augmente <span class="math inline">\(μ\)</span> par un incrément de exp( <span class="math inline">\(\beta_\text{Élévation}\)</span>)</p>
<p>Nous pouvons aussi l’écrire de cette façon:</p>
<p><span class="math display">\[\mu_i = e^{\alpha} \times e^{\beta_1^{\text{Élévation}_i}} \times e^{\beta_2^{\text{Précipitation}_i}}\]</span></p>
<p>Si <span class="math inline">\(β_j = 0\)</span> alors <span class="math inline">\(exp(β_j) = 1\)</span> et <span class="math inline">\(μ\)</span> n’est pas lié à <span class="math inline">\(x_j\)</span>. Si <span class="math inline">\(β_j &gt; 0\)</span> alors <span class="math inline">\(μ\)</span> augmente aussi si <span class="math inline">\(x_j\)</span> augmente; si <span class="math inline">\(β_j &lt; 0\)</span> alors <span class="math inline">\(μ\)</span> diminue si <span class="math inline">\(x_j\)</span> augmente.</p>
</div>
<div id="glm-de-poisson-dans-r" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> GLM de Poisson dans <code>R</code><a href="que-faire-avec-des-données-dabondance.html#glm-de-poisson-dans-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour ajuster un GLM avec une distribution de Poisson sous R, il suffit
de spécifier <code>family = poisson</code> dans la fonction <code>glm()</code>. Par défaut la fonction de lien est la fonction logarithmique.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="que-faire-avec-des-données-dabondance.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit a Poisson GLM</span></span>
<span id="cb82-2"><a href="que-faire-avec-des-données-dabondance.html#cb82-2" aria-hidden="true" tabindex="-1"></a>glm.poisson <span class="ot">=</span> <span class="fu">glm</span>(Faramea.occidentalis <span class="sc">~</span> Elevation, <span class="at">data =</span> faramea,</span>
<span id="cb82-3"><a href="que-faire-avec-des-données-dabondance.html#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> poisson)  <span class="co"># this is what makes it a Poisson GLM! Note the default link is log.</span></span>
<span id="cb82-4"><a href="que-faire-avec-des-données-dabondance.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.poisson)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Faramea.occidentalis ~ Elevation, family = poisson, 
##     data = faramea)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.3319  -2.7509  -1.5451   0.1139  11.3995  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.7687001  0.1099136  16.092  &lt; 2e-16 ***
## Elevation   -0.0027375  0.0006436  -4.253 2.11e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 414.81  on 42  degrees of freedom
## Residual deviance: 388.12  on 41  degrees of freedom
## AIC: 462.01
## 
## Number of Fisher Scoring iterations: 10</code></pre>
<p>Ordonnée à l’origine = <span class="math inline">\(\alpha\)</span></p>
<p>Élévation = <span class="math inline">\(\beta\)</span></p>
<p>Le résumé est similaire à celui de la fonction <strong>lm</strong> ( voir l’<a href="https://github.com/QCBSRworkshops/workshop04">atelier 4</a>) et donne les estimations des paramètres. Vous pouvez aussi récupérer
les estimations des paramètres à l’aide des fonctions suivantes :</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="que-faire-avec-des-données-dabondance.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordonnée à l&#39;origine</span></span>
<span id="cb84-2"><a href="que-faire-avec-des-données-dabondance.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.poisson)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 1.7687</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="que-faire-avec-des-données-dabondance.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pente de elevation</span></span>
<span id="cb86-2"><a href="que-faire-avec-des-données-dabondance.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.poisson)<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] -0.002737509</code></pre>
<p>À partir d’ici, nous pouvons estimer les déviance résiduelle et nulle. Dans notre modèle, la paramètre inconnu est l’ordonnée à l’origine (<span class="math inline">\(\alpha\)</span>) et la pente de l’élévation (<span class="math inline">\(\beta\)</span>):</p>
<p><span class="math display">\[log(\mu_i) = 1.769 - 0.0027 \times \text{Élévation}_i\]</span></p>
<p>qui peut aussi être écrit comme:</p>
<p><span class="math display">\[\mu_i = e^{1.769 - 0.0027 \times \text{Élévation}_i}\]</span>
Rappelez-vous que pour estimer une paramètre inconnu, l’estimation de la vraisemblance maximale est utilisée.</p>
<p>La déviance rédiuelle est défini par:</p>
<p><span class="math display">\[\text{residual deviance} = 2 \, log(L(y;\,y)) - 2 \, log(L(y;\, \mu))\]</span></p>
<p>Pour un GLM de Poisson, la déviance résiduelle devrait être proche du degré de liberté résiduel. Cependant, notre déviance résiduelle est beaucoup plus élevée que le degré de liberté de notre modèle!</p>
<p><span class="math display">\[388.12 &gt;&gt; 41\]</span></p>
</div>
<div id="la-validation-du-modèle-et-le-problème-de-la-surdispersion" class="section level3 hasAnchor" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> La validation du modèle et le problème de la surdispersion<a href="que-faire-avec-des-données-dabondance.html#la-validation-du-modèle-et-le-problème-de-la-surdispersion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Un aspect important du résumé se trouve dans les dernières lignes :</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="que-faire-avec-des-données-dabondance.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Null deviance: 414.81 on 42 degrees of freedom Residual</span></span>
<span id="cb88-2"><a href="que-faire-avec-des-données-dabondance.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="do">## deviance: 388.12 on 41 degrees of freedom</span></span></code></pre></div>
<p>L’estimation du maximum de vraisemblance est utilisé afin d’estimer
les paramètres. Nous avons déjà mentionné que la déviance est
l’équivalent en maximum de vraisemblance des sommes des carrés dans un
modèle linéaire. Ici vous pouvez considérer la déviance nulle et la
déviance résiduelle comme les équivalents de la somme totale des carrés et de la somme des carrés résiduelle. La déviance résiduelle correspond à deux fois la différence entre la log-vraisemblance de deux modèles : un modèle qui s’ajuste parfaitement aux données (i.e. un modèle saturé) et le modèle que nous voulons tester. Si notre modèle est correct, la distribution de la déviance résiduelle est estimée selon une distribution du χ² avec <span class="math inline">\(n\)</span>-<span class="math inline">\(p\)</span>-1 degrés de liberté (où <span class="math inline">\(n\)</span> correspond au nombre d’observations et <span class="math inline">\(p\)</span> correspond au nombre de variables explicatives). Une implication très importante en ce qui nous concerne est que la déviance résiduelle doit être égale au nombre de degrés de liberté résiduels. Dans notre example, la déviance résiduelle vaut 388.12, tandis que nous avons 41 (43-1-1) degrés de liberté. La déviance est 9.5 fois supérieure au nombre de dégrés de liberté. Le modèle peut alors être qualifié de <strong>surdispersé</strong>.</p>
<p><strong>La surdispersion</strong> La surdispersion peut être évaluée à l’aide du
paramètre de surdispersion φ qui se mesure donc de la facon suivante :</p>
<pre><code>                      φ = déviance résiduelle / dégrés de liberté résiduels

* φ &lt; 1 indique qu&#39;il y a sousdispersion
* φ = 1 indique que la dispersion est conforme aux attendus
* φ &gt; 1 indique qu&#39;il y a surdispersion</code></pre>
<p>Mais pourquoi un GLM présente-il de la surdispersion ? En fait, des
modèles GLM sont surdispersés quand la variance dans les données est
encore plus grande que ce qu’autorise la distribution de Poisson. Par
exemple, cela peut se produire lorsque les données contiennent de
nombreux zeros ou beaucoup de très grosses valeurs. Si nous revenons sur
la distribution de nos données (ci-dessus) nous pouvons remarquer que
ces deux problèmes sont présents et que la distribution de Poisson
n’était peut être pas le choix idéal. La surdispersion peut aussi
survenir lorsque des variables explicatives ou des termes
d’intéractions sont absentes ou bien encore lorsque qu’il y a des
problèmes de valeurs aberrantes.</p>
<p>La distribution de Poisson peut tenir compte de l’hétérogénéité
présente dans des données grace à la relation entre sa moyenne et sa
variance. Toutefois dans certains cas la variance augmente bien plus
rapidement par rapport à la moyenne si bien que la distribution de
Poisson n’est plus appropriée. Pour nous convaincre une dernière fois
d’abandonner la distribution de Poisson pour modéliser l’abondance de
l’espèce <em>faramea</em> nous pouvons rapidement calculer la moyenne et la
variance dans notre jeux de données :</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="que-faire-avec-des-données-dabondance.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(faramea<span class="sc">$</span>Faramea.occidentalis)</span></code></pre></div>
<pre><code>## [1] 3.883721</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="que-faire-avec-des-données-dabondance.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(faramea<span class="sc">$</span>Faramea.occidentalis)</span></code></pre></div>
<pre><code>## [1] 60.24806</code></pre>
<p>Dans la pratique, les GLMs basés sur la distribution de Poisson sont
très pratique pour décrire la moyenne <em>µ</em><sub>i</sub> mais vont sous-estimer la
variance dans les données dès qu’il y a de la surdispersion. Par
conséquent, les tests qui découlent du modèle seront trop laxistes. Il y
a deux moyens de traiter les problèmes de surdispersion que nous allons
détailler ci-dessous :</p>
<ul>
<li>corriger la surdispersion en utilisant un <strong>GLM quasi-Poisson</strong></li>
<li>choisir une nouvelle distribution comme la <strong>binomiale négative</strong></li>
</ul>
</div>
</div>
<div id="glm-avec-une-distribution-quasi-poisson" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> GLM avec une distribution quasi-Poisson<a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-quasi-poisson" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le principe d’un GLM avec une distribution «quasi» Poisson est très
simple; le paramètre de surdispersion (φ) est ajouté dans l’équation
qui spécifie la variance du modèle :</p>
<p><span class="math display">\[E(Y_i) = \mu_i\]</span></p>
<p><span class="math display">\[Var(Y_i) = φ.\mu_i\]</span></p>
<p>Le prédicteur linéaire, ainsi que la fonction de lien (log) restent les mêmes. La seule différence est que <span class="math inline">\(φ\)</span> va être estimé afin de corriger le modèle. Les estimations des paramètres seront eux aussi inchangés, mais leurs écarts-types seront multiplés par <span class="math inline">\(√φ\)</span>. Ainsi, certains paramètres qui étaient marginalement significatifs peuvent ne plus le rester.</p>
<p>Dans R, la famille <code>quasipoisson</code> peut être utilisée pour traiter
ces problèmes de surdispersion (de la même manière la famille
<code>quasibinomial</code> peut être utilisée). L’estimation de <span class="math inline">\(φ\)</span> sera donné
dans le résumé du modèle GLM quasi-Poisson. Nous pouvons ajuster ce
modèle de deux manières différentes :</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="que-faire-avec-des-données-dabondance.html#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1, nous ajustons un nouveau modèle GLM</span></span>
<span id="cb94-2"><a href="que-faire-avec-des-données-dabondance.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># quasi-Poisson</span></span>
<span id="cb94-3"><a href="que-faire-avec-des-données-dabondance.html#cb94-3" aria-hidden="true" tabindex="-1"></a>glm.quasipoisson <span class="ot">=</span> <span class="fu">glm</span>(Faramea.occidentalis <span class="sc">~</span> Elevation, <span class="at">data =</span> faramea,</span>
<span id="cb94-4"><a href="que-faire-avec-des-données-dabondance.html#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> quasipoisson)</span>
<span id="cb94-5"><a href="que-faire-avec-des-données-dabondance.html#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2, nous actualisons le modèle précédent :</span></span>
<span id="cb94-6"><a href="que-faire-avec-des-données-dabondance.html#cb94-6" aria-hidden="true" tabindex="-1"></a>glm.quasipoisson <span class="ot">=</span> <span class="fu">update</span>(glm.poisson, <span class="at">family =</span> quasipoisson)</span>
<span id="cb94-7"><a href="que-faire-avec-des-données-dabondance.html#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co"># regardons le résumé</span></span>
<span id="cb94-8"><a href="que-faire-avec-des-données-dabondance.html#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.quasipoisson)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Faramea.occidentalis ~ Elevation, family = quasipoisson, 
##     data = faramea)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -3.3319  -2.7509  -1.5451   0.1139  11.3995  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.768700   0.439233   4.027 0.000238 ***
## Elevation   -0.002738   0.002572  -1.064 0.293391    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 15.96936)
## 
##     Null deviance: 414.81  on 42  degrees of freedom
## Residual deviance: 388.12  on 41  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 10</code></pre>
<p>En examinant le résumé du modèle, nous pouvons voir que <span class="math inline">\(φ\)</span> est estimé à 15.97. Nous avons donc eu raison de corriger le modèle afin de prendre en compte la surdispersion. Par contre, si nous regardons la
significativité du coefficient de regression associé à l’élévation,
nous remarquons qu’il n’est plus significatif. Cependant, 15.97
indique que la surdispersion est forte et en général un GLM
quasi-Poisson est favorisé lorsque <span class="math inline">\(φ\)</span> est compris entre 1 et 15. Lors que la surdispersion se trouve netre 15 et 20, il est recommandé d’utiliser une distribution <strong>binomiale négative</strong> à nos données.</p>
<p>Deux points sont importants à garder en tête lorsque vous utilisez un
GLM quasi-Poisson afin de corriger la surdispersion :</p>
<ul>
<li><p><strong>Les GLMs quasi-Poisson n’ont pas d’AIC.</strong> En effet, la
vraisemblance d’un modèle GLM quasi-Poisson ne peut pas être
spécifiée et s’appuie sur une procédure de pseudo-maximum de
vraisemblance. Par conséquence les GLMs quasi-Poisson n’ont pas
d’AIC, et ce critère ne peut pas être utilisé afin de comparer
différents modèles. Toutefois des alternatives ont été developpées
pour gérer cette situation (e.g. quasi-AIC).</p></li>
<li><p><strong>La surdispersion influence la comparaison de modèles.</strong> En
effet, la surdispersion influence la comparaison de deux modèles
emboités et doit donc être prise en considération. Par exemple,
considérons que nous voulons comparer le modèle GLM1, qui contient
<span class="math inline">\(p_1\)</span> paramètres avec le modèle GLM2, qui contient <span class="math inline">\(p_2\)</span>
paramètres. GLM1 est emboité dans GLM2 et <span class="math inline">\(p2 &gt; p1\)</span>. La
comparaison des deux modèles est basées sur le test du rapport des
vraisemblances des deux modèles, <span class="math inline">\(D_1\)</span> et <span class="math inline">\(D_2\)</span> respectivement. Si la
surdispersion est connue, les déviances doivent être corrigées de
manière approprié selon <span class="math inline">\(D^* = D/φ\)</span>, et le test final sera basé sur le
critère <span class="math inline">\(D^*_1 - D^*_2\)</span> qui est supposé être distributé selon une
distribution du <span class="math inline">\(χ²\)</span> avec <span class="math inline">\(p_1-p_2\)</span> degrés de liberté lorsque le
modèle GLM1 est correct.</p></li>
<li><p>Mais dans certain cas <span class="math inline">\(φ\)</span> n’est pas connu. Par exemple, lorsque vous spécifiez un GLM avec un distribution normale. Dans ce cas, φ peut être estimé <em>a posteriori</em> en utilisant la déviance résiduelle du
plus gros modèle de telle sorte que le critière de comparaison
devienne:</p></li>
</ul>
<p><span class="math display">\[\frac{(D_1-D_2)/(p_2-p_1)}{D_2(n-p_2)}\]</span></p>
<p>Ce critère est supposé suivre une distribution F avec <span class="math inline">\(p_1-p_2\)</span> et <span class="math inline">\(n-p_2\)</span> degrés de liberté.</p>
<p>Testons l’effet de l’élévation par une analyse de déviance.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="que-faire-avec-des-données-dabondance.html#cb96-1" aria-hidden="true" tabindex="-1"></a>null.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Faramea.occidentalis <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> faramea, <span class="at">family =</span> quasipoisson)</span>
<span id="cb96-2"><a href="que-faire-avec-des-données-dabondance.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(null.model, glm.quasipoisson, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: Faramea.occidentalis ~ 1
## Model 2: Faramea.occidentalis ~ Elevation
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)
## 1        42     414.81                     
## 2        41     388.12  1   26.686   0.1961</code></pre>
<p><strong>Paramètre de dispesion:</strong>
<img src="images/dispParam.png" /></p>
</div>
<div id="glm-avec-une-distribution-binomiale-négative" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> GLM avec une distribution binomiale négative<a href="que-faire-avec-des-données-dabondance.html#glm-avec-une-distribution-binomiale-négative" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Un GLM avec une distribution binomiale négative (BN) est utilisé lorsque
la surdispersion est très forte. La distribution BN contient un
paramètre supplémentaire, <span class="math inline">\(k\)</span>, qui va être très utile pour gérer les
problèmes de surdispersion. Avant de rentrer dans les détails sur R,
voyons rapidement ce qui se cache derrière la distribution BN. En fait, la distribution BN est la combinaison de deux distributions; une
distribution de Poisson et une distribution Gamma. La distribution BN
définie la distribution d’une variable aléatoire discrète de la même
manière qu’une distribution de Poisson mais autorise la variance à être différente de la moyenne.</p>
<p><img src="images/poisson_versus_neg.png" /></p>
<p>Le mélange entre la distribution de Poisson et la distribution Gamma peut se résumer à l’aide de deux paramètres, <span class="math inline">\(µ\)</span> et <span class="math inline">\(k\)</span> qui spécifie la distribution de la facon suivante :</p>
<p><span class="math display">\[Y \sim NB(µ, k)\]</span></p>
<p><span class="math display">\[E(Y) = µ~et~Var(Y) = µ + µ²/k\]</span></p>
<p>De cette manière nous pouvons voir comment cette distribution va gérer
la surdispersion dans les modèles GLM. Le deuxième terme de la variance
de la distribution BN va déterminer le degré de surdispersion. En effet,
la surdispersion est indirectement déterminée par <span class="math inline">\(k\)</span>, que représente le
paramètre de dispersion. Si <span class="math inline">\(k\)</span> est grand (par rapport à <span class="math inline">\(μ²\)</span>), la
deuxième partie de la variance, <span class="math inline">\(µ²/k\)</span> va s’approcher de 0, et la
variance de Y sera <span class="math inline">\(μ\)</span>. Dans ce cas la distribution BN converge vers la
distribution de Poisson et vous pourriez tout aussi bien utiliser cette
dernière. Par contre, plus <span class="math inline">\(k\)</span> sera petit et plus la surdispersion sera
grande. Comme avec toutes les autres distributions, un GLM avec une
distribution BN se spécifie en trois étapes. Tout d’abord le modèle
fait l’hypothèse que les Y<sub>i</sub> suivent une distribution BN de moyenne
<span class="math inline">\(μ_i\)</span> et de paramètre <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[Y_i \sim NB(µ_i, k)\]</span></p>
<p><span class="math display">\[E(Y_i) = µ_i~and~Var(Y_i) = µ_i + µ_i²/k\]</span>
Les deux dernières étapes définissent le prédicteur linéaire ainsi que
la fonction de lien entre la moyenne des <span class="math inline">\(Y_i\)</span> et le prédicteur linéaire.
La fonction de lien utilisée par les GLMs avec une distribution BN est
le logarithme ce qui permet de s’assurer que les valeurs prédites
soient toujours positives.</p>
<p><span class="math display">\[log(µ_i) = β_0 + βX_i\]</span></p>
<p>ou</p>
<p><span class="math display">\[µ_i = exp(β_0 + βX_i)\]</span></p>
<p>Vous pouvez ajuster un GLM avec une distribution BN à l’aide de la
fonction <code>glm.nb()</code> du package <code>MASS</code>:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="que-faire-avec-des-données-dabondance.html#cb98-1" aria-hidden="true" tabindex="-1"></a>glm.negbin <span class="ot">=</span> <span class="fu">glm.nb</span>(Faramea.occidentalis <span class="sc">~</span> Elevation, <span class="at">data =</span> faramea)</span>
<span id="cb98-2"><a href="que-faire-avec-des-données-dabondance.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.negbin)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = Faramea.occidentalis ~ Elevation, data = faramea, 
##     init.theta = 0.2593107955, link = log)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -1.36748  -1.17564  -0.51338  -0.05226   2.25716  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  2.369226   0.473841    5.00 5.73e-07 ***
## Elevation   -0.007038   0.002496   -2.82  0.00481 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(0.2593) family taken to be 1)
## 
##     Null deviance: 41.974  on 42  degrees of freedom
## Residual deviance: 36.343  on 41  degrees of freedom
## AIC: 182.51
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  0.2593 
##           Std. Err.:  0.0755 
## 
##  2 x log-likelihood:  -176.5090</code></pre>
<p>Le résumé du modèle et similaire à celui des autres GLMs (e.g. GLMs
Poisson). Cependant vous avez maintenant un nouveau paramètre, theta,
qui est le paramètre <span class="math inline">\(k\)</span> de la variance de votre distribution.
L’écart-type de ce paramètre est aussi fourni, mais attention à son
interprétation car l’intervalle n’est pas symétrique.</p>
</div>
<div id="représentation-graphique-du-modèle-final" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Représentation graphique du modèle final<a href="que-faire-avec-des-données-dabondance.html#représentation-graphique-du-modèle-final" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Le GLM avec une distribution BN semble être le meilleur modèle pour
modéliser nos données. Nous voulons maintenant représenter la relation
entre le nombre de <em>Faramea occidentalis</em> et l’élévation.</p>
<p>Utilisez <code>summary</code> pour obtenir les paramètres.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="que-faire-avec-des-données-dabondance.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.negbin)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 2.369226</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="que-faire-avec-des-données-dabondance.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.negbin)<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] -0.007038124</code></pre>
<p>Utilisez les écarts-types pour construire l’intervalle de confiance.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="que-faire-avec-des-données-dabondance.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.negbin)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 0.4738409</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="que-faire-avec-des-données-dabondance.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.negbin)<span class="sc">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 0.002496143</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="que-faire-avec-des-données-dabondance.html#cb108-1" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.negbin, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Elevation =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">800</span>),</span>
<span id="cb108-2"><a href="que-faire-avec-des-données-dabondance.html#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb108-3"><a href="que-faire-avec-des-données-dabondance.html#cb108-3" aria-hidden="true" tabindex="-1"></a>linkinv <span class="ot">&lt;-</span> <span class="fu">family</span>(glm.negbin)<span class="sc">$</span>linkinv  <span class="do">## inverse-link function</span></span>
<span id="cb108-4"><a href="que-faire-avec-des-données-dabondance.html#cb108-4" aria-hidden="true" tabindex="-1"></a>pframe <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pp<span class="sc">$</span>fit)</span>
<span id="cb108-5"><a href="que-faire-avec-des-données-dabondance.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pframe) <span class="ot">&lt;-</span> <span class="st">&quot;pred0&quot;</span></span>
<span id="cb108-6"><a href="que-faire-avec-des-données-dabondance.html#cb108-6" aria-hidden="true" tabindex="-1"></a>pframe<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">linkinv</span>(pp<span class="sc">$</span>fit)</span>
<span id="cb108-7"><a href="que-faire-avec-des-données-dabondance.html#cb108-7" aria-hidden="true" tabindex="-1"></a>sc <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.95</span>)<span class="sc">/</span><span class="dv">2</span>))  <span class="do">## Normal approx. to likelihood</span></span>
<span id="cb108-8"><a href="que-faire-avec-des-données-dabondance.html#cb108-8" aria-hidden="true" tabindex="-1"></a>pframe <span class="ot">&lt;-</span> <span class="fu">transform</span>(pframe, <span class="at">lwr =</span> <span class="fu">linkinv</span>(pred0 <span class="sc">-</span> sc <span class="sc">*</span> pp<span class="sc">$</span>se.fit),</span>
<span id="cb108-9"><a href="que-faire-avec-des-données-dabondance.html#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">upr =</span> <span class="fu">linkinv</span>(pred0 <span class="sc">+</span> sc <span class="sc">*</span> pp<span class="sc">$</span>se.fit))</span>
<span id="cb108-10"><a href="que-faire-avec-des-données-dabondance.html#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(faramea<span class="sc">$</span>Elevation, faramea<span class="sc">$</span>Faramea.occidentalis, <span class="at">ylab =</span> <span class="st">&quot;Nombre de F. occidentalis&quot;</span>,</span>
<span id="cb108-11"><a href="que-faire-avec-des-données-dabondance.html#cb108-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Élévation(m)&quot;</span>)</span>
<span id="cb108-12"><a href="que-faire-avec-des-données-dabondance.html#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(pframe<span class="sc">$</span>pred, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb108-13"><a href="que-faire-avec-des-données-dabondance.html#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(pframe<span class="sc">$</span>upr, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb108-14"><a href="que-faire-avec-des-données-dabondance.html#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(pframe<span class="sc">$</span>lwr, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>Nous pouvons voir que le nombre de <em>Faramea occidentalis</em> diminue de
manière significative avec l’élévation. Toutefois, l’intervalle de
confiance autour de notre modèle est assez large, notamment à
faible élévation.</p>
<div id="défi-3" class="section level3 hasAnchor" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Défi 3<a href="que-faire-avec-des-données-dabondance.html#défi-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Utilisez le jeu de données <code>mites</code>! Modélisez l’abondance de l’espèce
Galumna en fonction des caractéristiques du substrat (son contenu en eau <code>WatrCont</code> et sa densité <code>SubsDens</code>).</p>
<p>Faut-il contrôler pour la surdispersion?<br />
Quelles variables explicatives ont un effet significatif?<br />
Selectionnez le meilleur modèle!</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="que-faire-avec-des-données-dabondance.html#cb109-1" aria-hidden="true" tabindex="-1"></a>mites <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;mites.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Retirez une variable à la fois et comparez le modèle imbriqué au
modèle saturé (ou complet):</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="que-faire-avec-des-données-dabondance.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(MyGLM, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<p>Spécifiez un modèle imbriqué manuellement, appelez le <code>MyGLM2</code>,
et utilisez la fonction <code>anova()</code>:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="que-faire-avec-des-données-dabondance.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(MyGLM, MyGLM2, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<details>
<summary>
<strong>Cliquez pour voir la solution au Défi 3!</strong>
</summary>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="que-faire-avec-des-données-dabondance.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GLM Poisson</span></span>
<span id="cb112-2"><a href="que-faire-avec-des-données-dabondance.html#cb112-2" aria-hidden="true" tabindex="-1"></a>glm.p <span class="ot">=</span> <span class="fu">glm</span>(Galumna <span class="sc">~</span> WatrCont <span class="sc">+</span> SubsDens, <span class="at">data =</span> mites, <span class="at">family =</span> poisson)</span>
<span id="cb112-3"><a href="que-faire-avec-des-données-dabondance.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># GLM quasi-Poisson</span></span>
<span id="cb112-4"><a href="que-faire-avec-des-données-dabondance.html#cb112-4" aria-hidden="true" tabindex="-1"></a>glm.qp <span class="ot">=</span> <span class="fu">update</span>(glm.p, <span class="at">family =</span> quasipoisson)</span>
<span id="cb112-5"><a href="que-faire-avec-des-données-dabondance.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sélection du modèle</span></span>
<span id="cb112-6"><a href="que-faire-avec-des-données-dabondance.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(glm.qp, <span class="at">test =</span> <span class="st">&quot;Chi&quot;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## Galumna ~ WatrCont + SubsDens
##          Df Deviance scaled dev.  Pr(&gt;Chi)    
## &lt;none&gt;        101.49                          
## WatrCont  1   168.10      31.711 1.789e-08 ***
## SubsDens  1   108.05       3.125   0.07708 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="que-faire-avec-des-données-dabondance.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ou</span></span>
<span id="cb114-2"><a href="que-faire-avec-des-données-dabondance.html#cb114-2" aria-hidden="true" tabindex="-1"></a>glm.qp2 <span class="ot">=</span> <span class="fu">glm</span>(Galumna <span class="sc">~</span> WatrCont, <span class="at">data =</span> mites, <span class="at">family =</span> quasipoisson)</span>
<span id="cb114-3"><a href="que-faire-avec-des-données-dabondance.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glm.qp2, glm.qp, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: Galumna ~ WatrCont
## Model 2: Galumna ~ WatrCont + SubsDens
##   Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  
## 1        68     108.05                       
## 2        67     101.49  1   6.5657  0.07708 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><img src="images/Solution_3.png" /></p>
</details>
</div>
</div>
<div id="conclusion-sur-les-glm-avec-des-données-dabondance" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Conclusion sur les GLM avec des données d’abondance<a href="que-faire-avec-des-données-dabondance.html#conclusion-sur-les-glm-avec-des-données-dabondance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tous les GLM que nous venons de voir pour modéliser des données de
d’abondance (Poisson, quasi-Poisson et BN) utilisent la même relation
log-linéaire entre moyenne et prédicteur linéaire (<span class="math inline">\(log(µ) = βx\)</span>). Toutefois ils vont autoriser différentes relations entre la
moyenne et la variance et vont aussi se reposer sur des méthodes
d’estimation de la vraisemblance différentes. Les GLMs Quasi-Poisson ou BN sont privilégiés afin de traiter la surdispersion. Malheureusement dans certains cas les données peuvent contenir trop de zeros et d’autres modèles seront plus éfficaces pour traiter ces situations. C’est par exemple le cas des <em>«zero-augmented models»</em> (e.g. zero-inflated Poisson; ZIP) qui vont traiter les zéros indépendamment des autres valeurs.</p>

</div>
</div>



<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="glm-binomial-avec-des-proportions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="autres-distributions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
