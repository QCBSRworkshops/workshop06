<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 9 Negative binomial GLMs | Atelier 6: Modèles linéaires généralisés en R</title>
  <meta name="description" content="Modèles linéaires généralisés en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 9 Negative binomial GLMs | Atelier 6: Modèles linéaires généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 9 Negative binomial GLMs | Atelier 6: Modèles linéaires généralisés en R" />
  
  <meta name="twitter:description" content="Modèles linéaires généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="quasi-poisson-glms.html"/>
<link rel="next" href="conclusion-on-glms-with-count-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><i class="fa fa-check"></i><b>3</b> Quel est l’utilité des modèles linéaires généralisés?</a></li>
<li class="chapter" data-level="4" data-path="les-distributions-des-données-biologiques.html"><a href="les-distributions-des-données-biologiques.html"><i class="fa fa-check"></i><b>4</b> Les distributions des données biologiques</a></li>
<li class="part"><span><b>GLM avec des données binaires</b></span></li>
<li class="chapter" data-level="5" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html"><i class="fa fa-check"></i><b>5</b> GLM avec une distribution binomiale (Bernouilli)</a><ul>
<li class="chapter" data-level="5.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#la-fonction-de-lien"><i class="fa fa-check"></i><b>5.1</b> La fonction de lien</a><ul>
<li class="chapter" data-level="5.1.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#défi-1"><i class="fa fa-check"></i><b>5.1.1</b> Défi 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#interpréter-la-sortie-dune-régression-logistique"><i class="fa fa-check"></i><b>5.2</b> Interpréter la sortie d’une régression logistique</a></li>
<li class="chapter" data-level="5.3" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#pouvoir-prédictif-et-validation-du-modèle"><i class="fa fa-check"></i><b>5.3</b> Pouvoir prédictif et validation du modèle</a><ul>
<li class="chapter" data-level="5.3.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#défi-2"><i class="fa fa-check"></i><b>5.3.1</b> Défi 2</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#représentation-graphique-des-résultats"><i class="fa fa-check"></i><b>5.4</b> Représentation graphique des résultats</a></li>
</ul></li>
<li class="part"><span><b>GLM avec des données de proportions</b></span></li>
<li class="chapter" data-level="6" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html"><i class="fa fa-check"></i><b>6</b> GLM avec une distribution binomiale</a></li>
<li class="part"><span><b>GLM avec des données d’abondance</b></span></li>
<li class="chapter" data-level="7" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html"><i class="fa fa-check"></i><b>7</b> Que avec des données d’abondance?</a><ul>
<li class="chapter" data-level="7.1" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html#glm-avec-une-distribution-de-poisson"><i class="fa fa-check"></i><b>7.1</b> GLM avec une distribution de Poisson</a><ul>
<li class="chapter" data-level="7.1.1" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html#la-validation-du-modèle-et-le-problème-de-la-surdispersion"><i class="fa fa-check"></i><b>7.1.1</b> La validation du modèle et le problème de la surdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>8</b> quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="9" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>9</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#représentation-graphique-du-modèle-final"><i class="fa fa-check"></i><b>9.1</b> Représentation graphique du modèle final</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>10</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Autres distributions</b></span></li>
<li class="chapter" data-level="11" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>11</b> Autres distributions</a></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="12" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>12</b> Sommaire</a></li>
<li class="chapter" data-level="13" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>13</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="14" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>14</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 6: Modèles linéaires généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="negative-binomial-glms" class="section level1">
<h1><span class="header-section-number">Chapitre 9</span> Negative binomial GLMs</h1>
<p>GLM avec une distribution binomiale négative</p>
<p>Un GLM avec une distribution binomiale négative (BN) est utilisé lorsque
la surdispersion est très forte. La distribution BN contient un
paramètre supplémentaire, <em>k</em>, qui va être très utile pour gérer les
problèmes de surdispersion. Avant de rentrer dans les détails sur R,
voyons rapidement ce qui se cache derrière la distribution BN. En fait,
la distribution BN est la combinaison de deux distributions; une
distribution de Poisson et une distribution Gamma. La distribution BN
définie la distribution d’une variable aléatoire discrète de la même
manière qu’une distribution de Poisson mais autorise la variance à être
différente de la moyenne. Le mélange entre la distribution de Poisson et
la distribution Gamma peut se résumer à l’aide de deux paramètres, <em>µ</em>
et <em>k</em> qui spécifie la distribution de la facon suivante :</p>
<p>Y ~ BN(<em>µ</em>, <em>k</em>)</p>
<p>E(Y) = <em>µ</em> et Var(Y) = <em>µ</em> + <em>µ</em>²<em>/k</em></p>
<p>De cette manière nous pouvons voir comment cette distribution va gérer
la surdispersion dans les modèles GLM. Le deuxième terme de la variance
de la distribution BN va déterminer le degré de surdispersion. En effet,
la surdispersion est indirectement déterminée par <em>k</em>, que représente le
paramètre de dispersion. Si <em>k</em> est grand (par rapport à <em>μ</em>²), la
deuxième partie de la variance, <em>µ</em>²<em>/k</em> va s’approcher de 0, et la
variance de Y sera <em>μ</em>. Dans ce cas la distribution BN converge vers la
distribution de Poisson et vous pourriez tout aussi bien utiliser cette
dernière. Par contre, plus <em>k</em> sera petit et plus la surdispersion sera
grande. Comme avec toutes les autres distributions, un GLM avec une
distribution BN se spécifie en trois étapes. Tout d’abord le modèle
fait l’hypothèse que les Y<sub>i</sub> suivent une distribution BN de moyenne
<em>μ</em><sub>i</sub> et de paramètre <em>k</em>.</p>
<p>Y<sub>i</sub> ∼ BN(<em>µ</em><sub>i</sub>, <em>k</em>)</p>
<p>E(Y<sub>i</sub>) = <em>µ</em><sub>i</sub> et Var(Y<sub>i</sub>) = <em>µ</em><sub>i</sub> + <em>µ</em><sub>i</sub>²<em>/k</em></p>
<p>Les deux dernières étapes définissent le prédicteur linéaire ainsi que
la fonction de lien entre la moyenne des Yi et le prédicteur linéaire.
La fonction de lien utilisée par les GLMs avec une distribution BN est
le logarithme ce qui permet de s’assurer que les valeurs prédites
soient toujours positives.</p>
<ul>
<li>log(<em>µ</em><sub>i</sub>) = <em>β</em><sub>0</sub> + <strong>X</strong><sub>i</sub>.<em>β</em></li>
</ul>
<p>ou</p>
<ul>
<li><em>µ</em><sub>i</sub> = exp(<em>β</em><sub>0</sub> + <strong>X</strong><sub>i</sub>.<em>β</em>)</li>
</ul>
<p>La distribution NB n’est pas dans la fonction glm(), il faut donc
installer et charger la librairie MASS. Si vous ne vous souvenez plus si
cette librairie R est déjà installée, pas de problème utilisez la
fonction suivante :</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="negative-binomial-glms.html#cb35-1"></a><span class="kw">ifelse</span>(<span class="kw">length</span>(<span class="kw">which</span>(<span class="kw">installed.packages</span>() <span class="op">==</span><span class="st"> &quot;MASS&quot;</span>)) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, {</span>
<span id="cb35-2"><a href="negative-binomial-glms.html#cb35-2"></a>    <span class="kw">print</span>(<span class="st">&quot;MASS not installed. Installing... &quot;</span>)</span>
<span id="cb35-3"><a href="negative-binomial-glms.html#cb35-3"></a>    <span class="kw">install.packages</span>(<span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb35-4"><a href="negative-binomial-glms.html#cb35-4"></a>}, <span class="kw">print</span>(<span class="st">&quot;MASS already installed&quot;</span>))</span></code></pre></div>
<p>Sinon, si vous savez que cette librairie n’est pas installée, vous
pouvez directement taper la commande :</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="negative-binomial-glms.html#cb36-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;MASS&quot;</span>)</span></code></pre></div>
<p>Souvenez vous de charger la librairie</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="negative-binomial-glms.html#cb37-1"></a><span class="kw">library</span>(<span class="st">&quot;MASS&quot;</span>)</span></code></pre></div>
<p>Vous pouvez ajuster un GLM avec une distribution BN à l’aide de la
fonction glm.nb() :</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="negative-binomial-glms.html#cb38-1"></a>glm.negbin =<span class="st"> </span><span class="kw">glm.nb</span>(Faramea.occidentalis <span class="op">~</span><span class="st"> </span>Elevation, <span class="dt">data =</span> faramea)</span>
<span id="cb38-2"><a href="negative-binomial-glms.html#cb38-2"></a><span class="kw">summary</span>(glm.negbin)</span></code></pre></div>
<p>Le résumé du modèle et similaire à celui des autres GLMs (e.g. GLMs
Poisson). Cependant vous avez maintenant un nouveau paramètre, theta,
qui est le paramètre <em>k</em> de la variance de votre distribution.
L’écart-type de ce paramètre est aussi fourni, mais attention à son
interprétation car l’intervalle n’est pas symétrique.</p>
<div id="représentation-graphique-du-modèle-final" class="section level2">
<h2><span class="header-section-number">9.1</span> Représentation graphique du modèle final</h2>
<p>Le GLM avec une distribution BN semble être le meilleur modèle pour
modéliser nos données. Nous voulons maintenant représenter la relation
entre le nombre de <em>Faramea occidentalis</em> et l’élévation.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="negative-binomial-glms.html#cb39-1"></a><span class="co"># représenter les données observées</span></span>
<span id="cb39-2"><a href="negative-binomial-glms.html#cb39-2"></a><span class="kw">plot</span>(faramea<span class="op">$</span>Elevation, faramea<span class="op">$</span>Faramea.occidentalis, <span class="dt">xlab =</span> <span class="st">&quot;Elevation (m)&quot;</span>, </span>
<span id="cb39-3"><a href="negative-binomial-glms.html#cb39-3"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Number of&quot;</span>, <span class="st">&quot;  &quot;</span>, <span class="kw">italic</span>(Faramea <span class="op">~</span><span class="st"> </span></span>
<span id="cb39-4"><a href="negative-binomial-glms.html#cb39-4"></a><span class="st">        </span>occidentalis))), <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">4</span>, <span class="dv">139</span>, <span class="dv">154</span>, <span class="dv">150</span>, </span>
<span id="cb39-5"><a href="negative-binomial-glms.html#cb39-5"></a>        <span class="dt">maxColorValue =</span> <span class="dv">255</span>))</span>
<span id="cb39-6"><a href="negative-binomial-glms.html#cb39-6"></a></span>
<span id="cb39-7"><a href="negative-binomial-glms.html#cb39-7"></a><span class="co"># récupérons les valeurs de l&#39;ordonnée à l&#39;origine et de beta</span></span>
<span id="cb39-8"><a href="negative-binomial-glms.html#cb39-8"></a><span class="co"># à partir du résumé et ajoutons les dans l&#39;équation du</span></span>
<span id="cb39-9"><a href="negative-binomial-glms.html#cb39-9"></a><span class="co"># modèle</span></span>
<span id="cb39-10"><a href="negative-binomial-glms.html#cb39-10"></a><span class="kw">curve</span>(<span class="kw">exp</span>(<span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">2</span>, </span>
<span id="cb39-11"><a href="negative-binomial-glms.html#cb39-11"></a>    <span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>x), <span class="dt">from =</span> <span class="kw">range</span>(faramea<span class="op">$</span>Elevation)[<span class="dv">1</span>], <span class="dt">to =</span> <span class="kw">range</span>(faramea<span class="op">$</span>Elevation)[<span class="dv">2</span>], </span>
<span id="cb39-12"><a href="negative-binomial-glms.html#cb39-12"></a>    <span class="dt">add =</span> T, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;orangered&quot;</span>)</span>
<span id="cb39-13"><a href="negative-binomial-glms.html#cb39-13"></a></span>
<span id="cb39-14"><a href="negative-binomial-glms.html#cb39-14"></a><span class="co"># récupérons les écarts-types pour construire l&#39;intervalle de</span></span>
<span id="cb39-15"><a href="negative-binomial-glms.html#cb39-15"></a><span class="co"># confiance du modèle</span></span>
<span id="cb39-16"><a href="negative-binomial-glms.html#cb39-16"></a><span class="kw">curve</span>(<span class="kw">exp</span>(<span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">1</span>, </span>
<span id="cb39-17"><a href="negative-binomial-glms.html#cb39-17"></a>    <span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span></span>
<span id="cb39-18"><a href="negative-binomial-glms.html#cb39-18"></a><span class="st">    </span><span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>]), <span class="dt">from =</span> <span class="kw">range</span>(faramea<span class="op">$</span>Elevation)[<span class="dv">1</span>], </span>
<span id="cb39-19"><a href="negative-binomial-glms.html#cb39-19"></a>    <span class="dt">to =</span> <span class="kw">range</span>(faramea<span class="op">$</span>Elevation)[<span class="dv">2</span>], <span class="dt">add =</span> T, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;orangered&quot;</span>)</span>
<span id="cb39-20"><a href="negative-binomial-glms.html#cb39-20"></a><span class="kw">curve</span>(<span class="kw">exp</span>(<span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span><span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">1</span>, </span>
<span id="cb39-21"><a href="negative-binomial-glms.html#cb39-21"></a>    <span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span></span>
<span id="cb39-22"><a href="negative-binomial-glms.html#cb39-22"></a><span class="st">    </span><span class="kw">summary</span>(glm.negbin)<span class="op">$</span>coefficients[<span class="dv">2</span>, <span class="dv">2</span>]), <span class="dt">from =</span> <span class="kw">range</span>(faramea<span class="op">$</span>Elevation)[<span class="dv">1</span>], </span>
<span id="cb39-23"><a href="negative-binomial-glms.html#cb39-23"></a>    <span class="dt">to =</span> <span class="kw">range</span>(faramea<span class="op">$</span>Elevation)[<span class="dv">2</span>], <span class="dt">add =</span> T, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;orangered&quot;</span>)</span></code></pre></div>
<p><img src="images/nb_glm_fit_to_faramea.png" class="align-center" width="450" /></p>
<p>Nous pouvons voir que le nombre de <em>Faramea occidentalis</em> diminue de
manière significative avec l’élévation. Toutefois, l’intervalle de
confiance autour de notre modèle est assez large, notamment pour à
faible élévation.</p>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="quasi-poisson-glms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion-on-glms-with-count-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
