<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 3 Quel est l’utilité des modèles linéaires généralisés? | Atelier 6: Modèles linéaires généralisés en R</title>
  <meta name="description" content="Modèles linéaires généralisés en R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 3 Quel est l’utilité des modèles linéaires généralisés? | Atelier 6: Modèles linéaires généralisés en R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires généralisés en R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 3 Quel est l’utilité des modèles linéaires généralisés? | Atelier 6: Modèles linéaires généralisés en R" />
  
  <meta name="twitter:description" content="Modèles linéaires généralisés en R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="préparez-vous-pour-cet-atelier.html"/>
<link rel="next" href="les-distributions-des-données-biologiques.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires généralisés en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html"><i class="fa fa-check"></i><b>3</b> Quel est l’utilité des modèles linéaires généralisés?</a></li>
<li class="chapter" data-level="4" data-path="les-distributions-des-données-biologiques.html"><a href="les-distributions-des-données-biologiques.html"><i class="fa fa-check"></i><b>4</b> Les distributions des données biologiques</a></li>
<li class="part"><span><b>GLM avec des données binaires</b></span></li>
<li class="chapter" data-level="5" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html"><i class="fa fa-check"></i><b>5</b> GLM avec une distribution binomiale (Bernouilli)</a><ul>
<li class="chapter" data-level="5.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#la-fonction-de-lien"><i class="fa fa-check"></i><b>5.1</b> La fonction de lien</a><ul>
<li class="chapter" data-level="5.1.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#défi-1"><i class="fa fa-check"></i><b>5.1.1</b> Défi 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#interpréter-la-sortie-dune-régression-logistique"><i class="fa fa-check"></i><b>5.2</b> Interpréter la sortie d’une régression logistique</a></li>
<li class="chapter" data-level="5.3" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#pouvoir-prédictif-et-validation-du-modèle"><i class="fa fa-check"></i><b>5.3</b> Pouvoir prédictif et validation du modèle</a><ul>
<li class="chapter" data-level="5.3.1" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#défi-2"><i class="fa fa-check"></i><b>5.3.1</b> Défi 2</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="glm-avec-une-distribution-binomiale-bernouilli.html"><a href="glm-avec-une-distribution-binomiale-bernouilli.html#représentation-graphique-des-résultats"><i class="fa fa-check"></i><b>5.4</b> Représentation graphique des résultats</a></li>
</ul></li>
<li class="part"><span><b>GLM avec des données de proportions</b></span></li>
<li class="chapter" data-level="6" data-path="glm-avec-une-distribution-binomiale.html"><a href="glm-avec-une-distribution-binomiale.html"><i class="fa fa-check"></i><b>6</b> GLM avec une distribution binomiale</a></li>
<li class="part"><span><b>GLM avec des données d’abondance</b></span></li>
<li class="chapter" data-level="7" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html"><i class="fa fa-check"></i><b>7</b> Que avec des données d’abondance?</a><ul>
<li class="chapter" data-level="7.1" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html#glm-avec-une-distribution-de-poisson"><i class="fa fa-check"></i><b>7.1</b> GLM avec une distribution de Poisson</a><ul>
<li class="chapter" data-level="7.1.1" data-path="que-avec-des-données-dabondance.html"><a href="que-avec-des-données-dabondance.html#la-validation-du-modèle-et-le-problème-de-la-surdispersion"><i class="fa fa-check"></i><b>7.1.1</b> La validation du modèle et le problème de la surdispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>8</b> quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="9" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>9</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#représentation-graphique-du-modèle-final"><i class="fa fa-check"></i><b>9.1</b> Représentation graphique du modèle final</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>10</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Autres distributions</b></span></li>
<li class="chapter" data-level="11" data-path="autres-distributions.html"><a href="autres-distributions.html"><i class="fa fa-check"></i><b>11</b> Autres distributions</a></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="12" data-path="sommaire.html"><a href="sommaire.html"><i class="fa fa-check"></i><b>12</b> Sommaire</a></li>
<li class="chapter" data-level="13" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>13</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="14" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>14</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 6: Modèles linéaires généralisés en <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="quel-est-lutilité-des-modèles-linéaires-généralisés" class="section level1">
<h1><span class="header-section-number">Chapitre 3</span> Quel est l’utilité des modèles linéaires généralisés?</h1>
<p>Pour illustrer l’utilité des modèles linéaires généralisés (GLMs en
anglais), il est important de d’abord comprendre les limites des
modèles linéaires (non-généralisés!), soit ceux présentés lors des
ateliers 4 et 6. À cet effet, chargeons des données et appliquons
quelques modèles linéaires:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb2-1"></a><span class="kw">setwd</span>(<span class="st">&quot;~/Desktop&quot;</span>)</span>
<span id="cb2-2"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb2-2"></a>mites &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;mites.csv&quot;</span>)</span></code></pre></div>
<p>Le jeu de données que vous venez de charger contient une partie du jeu
de données des "mites Oribatidae". Ce dernier a été utilisé par
plusieurs ouvrages sur R (p.ex. Borcard, Gillet &amp; Legendre, <em>Numerical
Ecology with R</em>) et est disponible dans la bibliothèque "vegan". Le
jeu de données contient 70 échantillons de mousse et de mites provenant
de la Station de Biologie des Laurentides de l’Université de Montréal,
à Saint-Hippolyte, QC. Chaque échantillon contient des valeurs pour 5
variables environnementales de même que l’abondance de 35 taxa de
mites. Le jeu de données que nous utiliserons pour cet atelier contient
l’abondance d’un seul taxon de mite, "<em>Galumna sp.</em>", de même que
les valeurs pour les 5 variables environnementales. Notre objectif est
de modéliser l’abondance, la présence, et la proportion de Galumna en
fonction des 5 variables environnentales. Nous avons donc créé une
variable binaire présence/absence (1=présent, 0=absent) et une variable
proportion (abondance de Galumna/abondance totale de mites).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-1"></a><span class="kw">head</span>(mites)</span>
<span id="cb3-2"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-2"></a><span class="kw">str</span>(mites)</span>
<span id="cb3-3"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-3"></a></span>
<span id="cb3-4"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-4"></a><span class="co"># 70 communautés de mites échantillonées à partir de carottes</span></span>
<span id="cb3-5"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-5"></a><span class="co"># de mousse prises à la Station de Biologie des Laurentides,</span></span>
<span id="cb3-6"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-6"></a><span class="co"># QC.  Pour chaque carotte/échantillon, les valeurs suivantes</span></span>
<span id="cb3-7"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-7"></a><span class="co"># sont fournies $Galumna: abondance de mites du genre Galumna</span></span>
<span id="cb3-8"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-8"></a><span class="co"># $pa: présence (1) ou absence (0) de Galumna, peu importe</span></span>
<span id="cb3-9"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-9"></a><span class="co"># l&#39;abondance $totalabund: abondance totale de mites, toutes</span></span>
<span id="cb3-10"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-10"></a><span class="co"># espèces confondues $prop: proportion de Galumna dans la</span></span>
<span id="cb3-11"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-11"></a><span class="co"># communauté de mites, i.e. Galumna/totalabund $SubsDens:</span></span>
<span id="cb3-12"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-12"></a><span class="co"># densité du substrat $WatrCont: contenu d&#39;eau de la carotte</span></span>
<span id="cb3-13"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-13"></a><span class="co"># $Substrate: type de substrat $Shrub: abondance de buissons.</span></span>
<span id="cb3-14"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-14"></a><span class="co"># Traité comme un facteur (une variable qualitative).  $Topo:</span></span>
<span id="cb3-15"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-15"></a><span class="co"># microtopographie du sol. &#39;couverture&#39; (blanket) ou &#39;hammac&#39;</span></span>
<span id="cb3-16"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb3-16"></a><span class="co"># (hummock).</span></span></code></pre></div>
<p>Regardons si nous pouvons voir une relation entre Galumna et les
variables environnementales à l’aide d’une simple matrice de
diagrammes:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb4-1"></a><span class="kw">plot</span>(mites)</span></code></pre></div>
<p><img src="images/6_spm.jpg" width="800" /></p>
<p>Il semble y avoir une relation négative entre l’abondance de Galumna et
le contenu d’eau (WatrCont). La présence (pa) et la proportion (prop)
de Galumna semblent aussi montrer une corrélation négative avec le
contenu d’eau. Nous pouvons regarder ça de plus près en représentant
dans des diagrammes les relations entre ces 3 variables réponses et avec
le contenu d’eau:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb5-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))  <span class="co">#division de la fenêtre de diagramme en une ligne et 3 colonnes pour avoir 3 diagrammes sur la même figure.</span></span>
<span id="cb5-2"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb5-2"></a><span class="kw">plot</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites, <span class="dt">xlab =</span> <span class="st">&quot;Water content&quot;</span>, </span>
<span id="cb5-3"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb5-3"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Abundance&quot;</span>)</span>
<span id="cb5-4"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb5-4"></a><span class="kw">boxplot</span>(WatrCont <span class="op">~</span><span class="st"> </span>pa, <span class="dt">data =</span> mites, <span class="dt">xlab =</span> <span class="st">&quot;Presence/Absence&quot;</span>, </span>
<span id="cb5-5"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb5-5"></a>    <span class="dt">ylab =</span> <span class="st">&quot;Water content&quot;</span>)</span>
<span id="cb5-6"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb5-6"></a><span class="kw">plot</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites, <span class="dt">xlab =</span> <span class="st">&quot;Water content&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Proportion&quot;</span>)</span>
<span id="cb5-7"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb5-7"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co">#retour aux paramètres par défaut (un seul diagramme par figure)</span></span></code></pre></div>
<p><img src="images/6_3plot.jpeg" width="600" /></p>
<p>En effet, Galumna montre une relation négative avec le contenu d’eau,
ce qui suggère que Galumna préfère les sites moins humides. Nous pouvons
utiliser des modèles linéaires (fonction "lm") pour voir si ces
relations sont statistiquement significatives.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb6-1"></a>lm.abund &lt;-<span class="st"> </span><span class="kw">lm</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb6-2"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb6-2"></a><span class="kw">summary</span>(lm.abund)</span>
<span id="cb6-3"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb6-3"></a>lm.pa &lt;-<span class="st"> </span><span class="kw">lm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb6-4"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb6-4"></a><span class="kw">summary</span>(lm.pa)</span>
<span id="cb6-5"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb6-5"></a>lm.prop &lt;-<span class="st"> </span><span class="kw">lm</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb6-6"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb6-6"></a><span class="kw">summary</span>(lm.prop)</span></code></pre></div>
<p>Oui, il y a une forte relation significative pour les 3 variables
réponses! Ça y est, on soummet à Nature. Attends une minute... Validons
d’abord ces modèles pour voir s’ils respectent les suppositions des
modèles linéaires, en commençant par le modèle d’abondance.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb7-1"></a><span class="kw">plot</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb7-2"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb7-2"></a><span class="kw">abline</span>(lm.abund)</span></code></pre></div>
<p><img src="images/6_lm1.jpeg" /></p>
<p>Le modèle ne représente pas très bien les données. Il prédit des valeurs
négatives d’abondance lorsque le contenu d’eau excède 600, ce qui est
insensé. En plus, le modèle ne prédit pas bien les valeurs élevées
d’abondance lorsque le contenu d’eau est faible.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb8-1"></a><span class="kw">plot</span>(lm.abund)</span></code></pre></div>
<p><img src="images/6_diagplots.jpeg" /></p>
<p>Les diagrammes diagnostiques montrent que le modèle ne respecte pas les
suppositions d’homogénéité de la variance (le diagramme à gauche montre
que les rédidus sont plus grands pour les valeurs prédites élevées) ni
de normalité (le diagramme à droite indique que les résidus ne sont pas
distribués tel que prédit par une distribution normale, i.e. plusieurs
points sont loin de la ligne pointillée). En conséquence, il nous faut
rejeter ce modèle; nous ne pouvons pas l’utiliser pour conclure que
l’abondance de Galumna varie en fonction du contenu d’eau. Les
diagrammes diagnostiques indiquent que les modèles pour présence-absence
et proportion sont eux aussi innapropriés:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-1"></a><span class="co"># Proportion</span></span>
<span id="cb9-2"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-2"></a><span class="kw">plot</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb9-3"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-3"></a><span class="kw">abline</span>(lm.prop)</span>
<span id="cb9-4"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-4"></a><span class="kw">plot</span>(lm.prop)</span>
<span id="cb9-5"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-5"></a><span class="co"># Présence/Absence</span></span>
<span id="cb9-6"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-6"></a><span class="kw">plot</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb9-7"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-7"></a><span class="kw">abline</span>(lm.pa)</span>
<span id="cb9-8"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb9-8"></a><span class="kw">plot</span>(lm.pa)</span></code></pre></div>
<p>C’est très commun que les jeux de données biologiques ne respectent pas
les suppositions d’homogénéité de la variance ou de normalité. Ces deux
suppositions constituent les problèmes principaux des modèles linéaires,
et sont la raison principale pourquoi nous avons besoin des modèles
linéaires généralisés. Revoyons l’équation de base d’un modèle
linéaire pour mieux comprendre d’où viennent ces suppositions. Cette
équation est:</p>
<p>y<sub>i</sub> = β<sub>0</sub> + β<sub>1</sub>x<sub>i</sub> + ε<sub>i</sub>, où:</p>
<ul>
<li>y<sub>i</sub> est la valeur prédite pour la variable réponse,</li>
<li>β<sub>0</sub> est l’ordonnée à l’origine de la droite de régression entre y
et x,</li>
<li>β<sub>1</sub> est la pente de la droite de régression entre y et x,</li>
<li>x<sub>i</sub> est la valeur de la variable indépendante,</li>
<li>ε<sub>i</sub> sont les résidus du modèle, qui proviennent d’une distribution
normale avec une moyenne variable mais une variance constante.</li>
</ul>
<p>Ce dernier point à propos de ε<sub>i</sub> est important. C’est de là que
proviennent les suppositions de normalité et d’homogénéité de la
variance (homoscédasticité). Ceci veut dire que les residus du modèle
(les distances entre chaque observation et la droite de régression)
peuvent être prédits en pigeant de façon aléatoire des valeurs dans une
distribution normale. Souvenez-vous que toutes les distributions/lois
normales ont deux paramètres, soit μ (la moyenne de la distribution) et
σ<sup>2</sup> (la variance de la distribution):</p>
<p><img src="images/6_normal_params.jpeg" /></p>
<p>Dans un modèle linéaire, μ change selon la valeur de x (la variable
indépendante), mais σ<sup>2</sup> garde la même valeur pour toutes les valeurs de
y<sub>i</sub>. En effet, une autre équation pour représenter un modèle linéaire
est la suivante:</p>
<p>y<sub>i</sub> ~ <em>N</em>(μ = β<sub>0</sub> + β<sub>1</sub>x<sub>i</sub>, σ<sup>2</sup>),</p>
<p>ce qui signifie littéralement que chaque observation (y<sub>i</sub>) provient
d’une distribution normale avec les paramètres μ (qui dépend de la
valeur de x<sub>i</sub>) et σ<sup>2</sup>. Éssayons de prédire l’abondance de Galumna en
fonction du contenu d’eau en utilisant cette équation et les paramètres
que nous avons estimé plus tôt avec la fonction lm(). D’abord, il nous
faut des valeurs pour β<sub>0</sub> et β<sub>1</sub> (les coéfficients de régression), que
nous pouvons obtenir ainsi:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb10-1"></a><span class="kw">coef</span>(lm.abund)</span>
<span id="cb10-2"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb10-2"></a><span class="co"># (Intercept) WatrCont 3.439348672 -0.006044788</span></span></code></pre></div>
<p>Ce modèle prédit que pour un contenu d’eau de disons 300, nous devrions
obtenir une abondance de Galumna de 1.63:</p>
<p>3.44 + (-0.006 x 300) = 1.63.</p>
<p>1.63 est l’abondance prédite s’il n’y avait pas de variance
résiduelle (i.e. si notre modèle avait un r2 de 1). Pour modéliser les
valeurs prédites, nous devons donc ajouter ε<sub>i</sub>, i.e. la distance entre
les valeurs observées et la droite de régression. C’est ici que nous
utilisons la distribution normale. Pour x = 300, notre modèle prédit que
ε<sub>i</sub> devrait suivre une distribution normale avec une moyenne = 1.63.
Lorsque le contenu d’eau = 400, ε<sub>i</sub> devrait suivre une distribution
normale avec une moyenne = 3.44 + (-0.006 x 400) = 1.02. Chaque valeur
de y<sub>i</sub> est modélisée en utilisant une distribution normale différente,
chacune avec une moyenne distincte qui dépend de x<sub>i</sub>. Par contre, la
variance de toutes ces distributions (σ<sup>2</sup>) reste toujours la même. La
fonction lm() trouve la valeur de σ<sup>2</sup> optimale pour minimiser la somme
des carrés résiduelle et utilise ensuite cette valeur pour toutes les
distributions normales servant à modéliser y. Nous pouvons trouver la
valeur de σ<sup>2</sup> de notre modèle dans le résumé du modèle:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="quel-est-lutilité-des-modèles-linéaires-généralisés.html#cb11-1"></a><span class="kw">summary</span>(lm.abund)<span class="op">$</span>sigma</span></code></pre></div>
<p>Nous trouvons que sigma est plus ou moins 1.51. Nous avons maintenant
tous les coéfficients nécessaires pour modéliser manuellement
l’abondance de Galuman comme le ferait la fonction lm(). À un contenu
d’eau de 300, les résidus devraient suivre une distribution normale
avec les paramètres μ = 1.63 et σ<sup>2</sup> = 1.51. À un contenu d’eau de 400,
les résidus devraient suivre une distribution normale avec les
paramètres μ = 1.02 et σ<sup>2</sup> = 1.51, etc. Graphiquement, ça ressemble à
ça:</p>
<p><img src="images/6_lm_assump.jpeg" /></p>
<p>Les quatres lois normales sur ce graphique donnent la probabilité
d’observer toutes valeurs possibles de Galumna à 4 contenus d’eau
différents. La moyenne de la distribution varie selon le contenu d’eau
(donc μ diminue avec le contenu d’eau), mais σ<sup>2</sup> est toujours 1.51. La
<strong>variance est donc homogène</strong> pour toutes les valeurs de x. Ce modèle
est inadéquat pour au moins deux raisons:</p>
<p>1. Les valeurs prédites sont en moyenne plus loin de la droite de
régression lorsque le contenu d’eau est faible. Ceci signifie que la
variance résiduelle est plus grande lorsque x est faible, ce qui revient
à dire que ε<sub>i</sub> varie en fonction de x et que la variance n’est donc
pas homogène. Il est innaproprié ici d’utiliser une valeur constante de
σ<sup>2</sup>: les distributions normales utilisées pour prédire y devraient être
plus larges (avoir une plus grande variance) lorsque x est faible que
lorsqu’il est élevé. Malheureusement, les modèles linéaires ne
permettent pas ceci.</p>
<p>2. C’est innaproprié d’utiliser une distribution normale pour prédire
y en fonction de x. Notre variable réponse est l’abondance qui, par
définition, doit être un nombre entier. Pourtant, lorsque le contenu
d’eau = 300, notre modèle prédit que l’abondance la plus probable est
1.63! Nous savons pourtant que la probabilité d’observer une telle
valeur (ou toute autre fraction) est 0. Nos valeurs prédites devraient
être modélisées en utilisant une distribution qui ne contient que des
nombres entiers, plutôt qu’avec une distribution continue telle que la
distribution normale. Ceci est un problème courant car les variables
biologiques peuvent être distribuées de bien d’autres façon que ce qui
est prédit par la distribution normale.</p>
<p>Les modèles linéaires généralisés peuvent résoudrent ces deux problèmes.
Poursuivez votre lecture!</p>

</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="préparez-vous-pour-cet-atelier.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="les-distributions-des-données-biologiques.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
