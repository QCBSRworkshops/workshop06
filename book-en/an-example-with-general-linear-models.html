<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 An example with general linear models | Workshop 6: Generalized linear models</title>
  <meta name="description" content="Generalized linear models in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 An example with general linear models | Workshop 6: Generalized linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Generalized linear models in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 An example with general linear models | Workshop 6: Generalized linear models" />
  
  <meta name="twitter:description" content="Generalized linear models in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="reviewing-linear-models.html"/>
<link rel="next" href="the-distributions-of-biological-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Generalized linear models in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html"><i class="fa fa-check"></i><b>3</b> Reviewing linear models</a><ul>
<li class="chapter" data-level="3.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#general-linear-models"><i class="fa fa-check"></i><b>3.1</b> General linear models</a><ul>
<li class="chapter" data-level="3.1.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#definition"><i class="fa fa-check"></i><b>3.1.1</b> Definition</a></li>
<li class="chapter" data-level="3.1.2" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#assumptions"><i class="fa fa-check"></i><b>3.1.2</b> Assumptions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html"><i class="fa fa-check"></i><b>4</b> An example with general linear models</a><ul>
<li class="chapter" data-level="4.1" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html#recalling-linear-models-assumptions"><i class="fa fa-check"></i><b>4.1</b> Recalling linear models: assumptions</a><ul>
<li class="chapter" data-level="4.1.1" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html#model-prediction"><i class="fa fa-check"></i><b>4.1.1</b> Model prediction</a></li>
<li class="chapter" data-level="4.1.2" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html#so-what-do-we-do-now-transform-our-data"><i class="fa fa-check"></i><b>4.1.2</b> So, what do we do now? Transform our data?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-distributions-of-biological-data.html"><a href="the-distributions-of-biological-data.html"><i class="fa fa-check"></i><b>5</b> The distributions of biological data</a></li>
<li class="part"><span><b>GLMs with binary data</b></span></li>
<li class="chapter" data-level="6" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html"><i class="fa fa-check"></i><b>6</b> Binomial GLMs (Bernouilli)</a><ul>
<li class="chapter" data-level="6.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#the-link-function"><i class="fa fa-check"></i><b>6.1</b> The link function</a><ul>
<li class="chapter" data-level="6.1.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#challenge-1"><i class="fa fa-check"></i><b>6.1.1</b> Challenge 1</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#interpreting-the-output-of-a-logistic-regression"><i class="fa fa-check"></i><b>6.2</b> Interpreting the output of a logistic regression</a></li>
<li class="chapter" data-level="6.3" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#predictive-power-and-goodness-of-fit"><i class="fa fa-check"></i><b>6.3</b> Predictive power and goodness-of-fit</a><ul>
<li class="chapter" data-level="6.3.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#challenge-2"><i class="fa fa-check"></i><b>6.3.1</b> Challenge 2</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#plotting-results"><i class="fa fa-check"></i><b>6.4</b> Plotting results</a></li>
</ul></li>
<li class="part"><span><b>GLMs with proportion data</b></span></li>
<li class="chapter" data-level="7" data-path="binomial-glms.html"><a href="binomial-glms.html"><i class="fa fa-check"></i><b>7</b> Binomial GLMS</a></li>
<li class="part"><span><b>GLMs with count data</b></span></li>
<li class="chapter" data-level="8" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html"><i class="fa fa-check"></i><b>8</b> What can we do with count data?</a></li>
<li class="chapter" data-level="9" data-path="poisson-glms.html"><a href="poisson-glms.html"><i class="fa fa-check"></i><b>9</b> Poisson GLMs</a><ul>
<li class="chapter" data-level="9.1" data-path="poisson-glms.html"><a href="poisson-glms.html#the-problem-of-overdispersion"><i class="fa fa-check"></i><b>9.1</b> The problem of overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>10</b> Quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="11" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>11</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="11.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#plotting-the-final-glm-to-the-data"><i class="fa fa-check"></i><b>11.1</b> Plotting the final GLM to the data</a><ul>
<li class="chapter" data-level="11.1.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#challenge-3"><i class="fa fa-check"></i><b>11.1.1</b> Challenge 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>12</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Other distributions</b></span></li>
<li class="chapter" data-level="13" data-path="other-distributions.html"><a href="other-distributions.html"><i class="fa fa-check"></i><b>13</b> Other distributions</a></li>
<li class="part"><span><b>Additional GLM resources</b></span></li>
<li class="chapter" data-level="14" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>14</b> Summary</a></li>
<li class="chapter" data-level="15" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>15</b> Additional resources</a></li>
<li class="chapter" data-level="16" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>16</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 6: Generalized linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="an-example-with-general-linear-models" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> An example with general linear models</h1>
<p>Let us use our prior knowledge on general linear models to explore the relationship between variables within the <em>Oribatid mite dataset</em>.</p>
<p>Let us begin by loading this dataset into <code>R</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="an-example-with-general-linear-models.html#cb9-1"></a><span class="co"># Use setwd() to set your working directory</span></span>
<span id="cb9-2"><a href="an-example-with-general-linear-models.html#cb9-2"></a></span>
<span id="cb9-3"><a href="an-example-with-general-linear-models.html#cb9-3"></a>mites &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/mites.csv&#39;</span>,</span>
<span id="cb9-4"><a href="an-example-with-general-linear-models.html#cb9-4"></a>                  <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>The dataset that you just loaded is a subset from the classic ‘Oribatid
mite dataset’, which has been used in numerous texts (e.g. Borcard,
Gillet &amp; Legendre, <em>Numerical Ecology with R</em>), and which is available
in the <code>vegan</code> library.</p>
<p>The Oribatid mite dataset has <strong>70 observations with moss and mite samples</strong> collected Station de Biologie des
Laurentides from the Université de Montréal, within the municipality of Saint-Hippolyte, Québec (Canada). Each sample includes <strong>5</strong> variables of <strong>environmental measurements</strong> and abundance for <em>Galumna</em> sp. for each site.</p>
<p>We can peek into the structure and the first six rows of the dataset using the <code>head()</code> and <code>str()</code> functions:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="an-example-with-general-linear-models.html#cb10-1"></a><span class="kw">head</span>(mites)</span></code></pre></div>
<pre><code>##   Galumna pa totalabund        prop SubsDens WatrCont Substrate Shrub    Topo
## 1       8  1        140 0.057142857    39.18   350.15   Sphagn1   Few Hummock
## 2       3  1        268 0.011194030    54.99   434.81    Litter   Few Hummock
## 3       1  1        186 0.005376344    46.07   371.72 Interface   Few Hummock
## 4       1  1        286 0.003496503    48.19   360.50   Sphagn1   Few Hummock
## 5       2  1        199 0.010050251    23.55   204.13   Sphagn1   Few Hummock
## 6       1  1        209 0.004784689    57.32   311.55   Sphagn1   Few Hummock</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="an-example-with-general-linear-models.html#cb12-1"></a><span class="kw">str</span>(mites)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    70 obs. of  9 variables:
##  $ Galumna   : int  8 3 1 1 2 1 1 1 2 5 ...
##  $ pa        : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ totalabund: int  140 268 186 286 199 209 162 126 123 166 ...
##  $ prop      : num  0.05714 0.01119 0.00538 0.0035 0.01005 ...
##  $ SubsDens  : num  39.2 55 46.1 48.2 23.6 ...
##  $ WatrCont  : num  350 435 372 360 204 ...
##  $ Substrate : Factor w/ 7 levels &quot;Barepeat&quot;,&quot;Interface&quot;,..: 4 3 2 4 4 4 4 2 3 4 ...
##  $ Shrub     : Factor w/ 3 levels &quot;Few&quot;,&quot;Many&quot;,&quot;None&quot;: 1 1 1 1 1 1 1 2 2 2 ...
##  $ Topo      : Factor w/ 2 levels &quot;Blanket&quot;,&quot;Hummock&quot;: 2 2 2 2 2 2 2 1 1 2 ...</code></pre>
<p>Our first glance into the dataset already allows us to separate potential response variables from potential predictors:</p>
<div class="split">
<div class="split-left">
<p>Response variables:</p>
<ol style="list-style-type: decimal">
<li>Occurrence: <code>pa</code></li>
<li>Abundance: <code>Galumna</code></li>
<li>Relative Frequency or Proportion: <code>prop</code></li>
</ol>
</div>
<div class="split-right">
<p>Predictive variables:</p>
<ol style="list-style-type: decimal">
<li>Substract Density: <code>SubsDens</code></li>
<li>Water Content: <code>WatrCont</code></li>
<li>Substrate: <code>Substrate</code></li>
<li>Shrubs Nearby: <code>Shrub</code></li>
<li>Topography: <code>Topo</code></li>
</ol>
</div>
</div>
<p>We can also already ellaborate an initial question: <em>Could the abundance, occurrence or proportion of Galumna sp. be predicted by environmental features?</em></p>
<p>To answer this question, we can think of a variety of functions:</p>
<div class="split">
<div class="split-left">
<p><span class="math inline">\(\text{Abundance} = f(\text{Water content}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Proportion} = f(\text{Water content}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Occurrence} = f(\text{Substrate}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Abundance} = f(\text{Topography}, \epsilon)\)</span></p>
</div>
<div class="split-right">
<p><span class="math inline">\(\text{Occurrence} = f(\text{Shrubs Nearby}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Relative Frequency} = f(\text{Topography}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Occurrence} = f(\text{Substract Density}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Abundance} = f(\text{Substrate}, \epsilon)\)</span>
]</p>
</div>
</div>
<p>Let us attempt to be more specific and ask <strong>wether <em>Galumna</em>’s community values (abundance, occurrence and relative frequency) vary as a function of water content</strong>.</p>
<p>We can begin by representing all three response variables against the predictor:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="an-example-with-general-linear-models.html#cb14-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">cex =</span> <span class="fl">1.4</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="an-example-with-general-linear-models.html#cb15-1"></a><span class="kw">plot</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont,</span>
<span id="cb15-2"><a href="an-example-with-general-linear-models.html#cb15-2"></a>     <span class="dt">data =</span> mites,</span>
<span id="cb15-3"><a href="an-example-with-general-linear-models.html#cb15-3"></a>     <span class="dt">xlab =</span> <span class="st">&#39;Water content&#39;</span>,</span>
<span id="cb15-4"><a href="an-example-with-general-linear-models.html#cb15-4"></a>     <span class="dt">ylab =</span> <span class="st">&#39;Abundance&#39;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="an-example-with-general-linear-models.html#cb16-1"></a><span class="kw">boxplot</span>(WatrCont <span class="op">~</span><span class="st"> </span>pa,</span>
<span id="cb16-2"><a href="an-example-with-general-linear-models.html#cb16-2"></a>        <span class="dt">data =</span> mites,</span>
<span id="cb16-3"><a href="an-example-with-general-linear-models.html#cb16-3"></a>        <span class="dt">xlab=</span><span class="st">&#39;Presence/Absence&#39;</span>,</span>
<span id="cb16-4"><a href="an-example-with-general-linear-models.html#cb16-4"></a>        <span class="dt">ylab =</span> <span class="st">&#39;Water content&#39;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="an-example-with-general-linear-models.html#cb17-1"></a><span class="kw">plot</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont,</span>
<span id="cb17-2"><a href="an-example-with-general-linear-models.html#cb17-2"></a>     <span class="dt">data =</span> mites,</span>
<span id="cb17-3"><a href="an-example-with-general-linear-models.html#cb17-3"></a>     <span class="dt">xlab =</span> <span class="st">&#39;Water content&#39;</span>,</span>
<span id="cb17-4"><a href="an-example-with-general-linear-models.html#cb17-4"></a>     <span class="dt">ylab =</span> <span class="st">&#39;Proportion&#39;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Indeed, <code>Galumna</code> seems to vary negatively as a function of <code>WatrCont</code>, <em>i</em>.<em>e</em>.
<em>Galumna</em> sp. seems to prefer dryer sites.</p>
<p>We can go step further and fit general linear models to test whether <code>Galumna</code>, <code>pa</code>, and/or <code>prop</code> vary as a function of <code>WatrCont</code></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="an-example-with-general-linear-models.html#cb18-1"></a>lm.abund &lt;-<span class="st"> </span><span class="kw">lm</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb18-2"><a href="an-example-with-general-linear-models.html#cb18-2"></a><span class="co">## summary(lm.abund)</span></span>
<span id="cb18-3"><a href="an-example-with-general-linear-models.html#cb18-3"></a></span>
<span id="cb18-4"><a href="an-example-with-general-linear-models.html#cb18-4"></a>lm.pa &lt;-<span class="st"> </span><span class="kw">lm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb18-5"><a href="an-example-with-general-linear-models.html#cb18-5"></a><span class="co">## summary(lm.pa)</span></span>
<span id="cb18-6"><a href="an-example-with-general-linear-models.html#cb18-6"></a></span>
<span id="cb18-7"><a href="an-example-with-general-linear-models.html#cb18-7"></a>lm.prop &lt;-<span class="st"> </span><span class="kw">lm</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span></code></pre></div>
<p>Then, we can check the model output to verify whether these relationships are statistically significant:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="an-example-with-general-linear-models.html#cb19-1"></a><span class="kw">summary</span>(lm.abund)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Galumna ~ WatrCont, data = mites)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.7210 -0.8236 -0.3270  0.3910  6.6772 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.439349   0.555825   6.188 3.98e-08 ***
## WatrCont    -0.006045   0.001280  -4.723 1.21e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.514 on 68 degrees of freedom
## Multiple R-squared:  0.247,  Adjusted R-squared:  0.2359 
## F-statistic: 22.31 on 1 and 68 DF,  p-value: 1.206e-05</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="an-example-with-general-linear-models.html#cb21-1"></a><span class="kw">summary</span>(lm.pa)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pa ~ WatrCont, data = mites)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.61320 -0.30889 -0.05498  0.30247  0.80073 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.1892142  0.1431306   8.309 6.03e-12 ***
## WatrCont    -0.0020263  0.0003296  -6.148 4.68e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3897 on 68 degrees of freedom
## Multiple R-squared:  0.3573, Adjusted R-squared:  0.3478 
## F-statistic:  37.8 on 1 and 68 DF,  p-value: 4.677e-08</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="an-example-with-general-linear-models.html#cb23-1"></a><span class="kw">summary</span>(lm.prop)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = prop ~ WatrCont, data = mites)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.010208 -0.004927 -0.002056  0.003240  0.049252 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.020e-02  3.294e-03   6.133 4.98e-08 ***
## WatrCont    -3.516e-05  7.586e-06  -4.635 1.67e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.008971 on 68 degrees of freedom
## Multiple R-squared:  0.2401, Adjusted R-squared:  0.2289 
## F-statistic: 21.49 on 1 and 68 DF,  p-value: 1.665e-05</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="an-example-with-general-linear-models.html#cb25-1"></a><span class="co"># Extracting the Pr(&gt;|t|)</span></span>
<span id="cb25-2"><a href="an-example-with-general-linear-models.html#cb25-2"></a></span>
<span id="cb25-3"><a href="an-example-with-general-linear-models.html#cb25-3"></a><span class="kw">summary</span>(lm.abund)<span class="op">$</span>coefficients[, <span class="dv">4</span>]</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
## 3.981563e-08 1.206117e-05</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="an-example-with-general-linear-models.html#cb27-1"></a><span class="kw">summary</span>(lm.pa)<span class="op">$</span>coefficients[, <span class="dv">4</span>]</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
## 6.030252e-12 4.676755e-08</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="an-example-with-general-linear-models.html#cb29-1"></a><span class="kw">summary</span>(lm.prop)<span class="op">$</span>coefficients[, <span class="dv">4</span>]</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
## 4.977432e-08 1.665437e-05</code></pre>
<p>Yes, there is a strong and significant relationship for all 3 response variables! <strong>Wait a minute…</strong> We are forgetting something important here! What about the assumptions of linear models?</p>
<div id="recalling-linear-models-assumptions" class="section level2">
<h2><span class="header-section-number">4.1</span> Recalling linear models: assumptions</h2>
<p>Let’s validate these models to make sure that we
respect assumptions of linear models, starting with the abundance model.</p>
<p>We can see a strong and significant relationship for all three models, concerning each one of the three response variables!</p>
<p>Nevertheless, we cannot forget the most important step: verifying if the assumptions for these general linear models have not been violated.</p>
<p>Let us begin by validating these models to make sure that we respect assumptions of linear models, starting with the abundance model.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="an-example-with-general-linear-models.html#cb31-1"></a><span class="kw">plot</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb31-2"><a href="an-example-with-general-linear-models.html#cb31-2"></a><span class="kw">abline</span>(lm.abund)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The model does not fit well. It predicts negative abundance values when
<code>WatrCont</code> exceeds <code>600</code>, which does not make any sense. Also, the model
does poorly at predicting high abundance values at low values of <code>WatrCont</code>.</p>
<p>We can also check the model diagnostic plots:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="an-example-with-general-linear-models.html#cb32-1"></a><span class="kw">plot</span>(lm.abund)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-18-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-18-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-18-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-18-4.png" width="50%" height="50%" /></p>
<p>Diagnostic plots show that the data/model violate assumptions of
homogeneity of variance (the graph on the left shows that residuals are
larger at higher fitted values) and normality (the graph on the right
indicates that residuals are not distributed as expected from a normal
distribution, i.e. many points are far from predicted values given by
the dotted line). Therefore, we need to reject this model, and can’t
use it to conclude that Galumna abundance varies as a function of water
content.</p>
<p>Looking at diagnostic plots for the presence-absence model and
the proportion model also indicate that these models are also inappropriate:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="an-example-with-general-linear-models.html#cb33-1"></a><span class="co"># Plot the proportion model</span></span>
<span id="cb33-2"><a href="an-example-with-general-linear-models.html#cb33-2"></a><span class="kw">plot</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb33-3"><a href="an-example-with-general-linear-models.html#cb33-3"></a><span class="kw">abline</span>(lm.prop)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="an-example-with-general-linear-models.html#cb34-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb34-2"><a href="an-example-with-general-linear-models.html#cb34-2"></a><span class="kw">plot</span>(lm.prop)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-20-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-20-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-20-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-20-4.png" width="50%" height="50%" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="an-example-with-general-linear-models.html#cb35-1"></a><span class="co"># Plot the presence/absence model</span></span>
<span id="cb35-2"><a href="an-example-with-general-linear-models.html#cb35-2"></a><span class="kw">plot</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb35-3"><a href="an-example-with-general-linear-models.html#cb35-3"></a><span class="kw">abline</span>(lm.pa)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="an-example-with-general-linear-models.html#cb36-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb36-2"><a href="an-example-with-general-linear-models.html#cb36-2"></a><span class="kw">plot</span>(lm.pa)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-22-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-22-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-22-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-22-4.png" width="50%" height="50%" /></p>
<p>Let’s take a step back here and review the assumptions of linear models, and where they come from. Remember our simple linear model?</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(Y_i\)</span> is the predicted value of a response variable</li>
<li><span class="math inline">\(\beta_0\)</span> is the <em>unknown coefficient</em> <strong>intercept</strong></li>
<li>_1$ is the <em>unknown coefficient</em> <strong>slope</strong></li>
<li><span class="math inline">\(X_i\)</span> is the value of the explanatory variable</li>
<li><span class="math inline">\(\varepsilon_i\)</span> is the model residual drawn from a normal distribution with a varying mean but a constant variance.</li>
</ul>
<p>This last point about <span class="math inline">\(\varepsilon_i\)</span> is important. This is where assumptions of
normality and homoscedasticity originate. <strong>It means that the residuals
(the distance between each observation and the regression line) can be
predicted by drawing random values from a normal distribution.</strong></p>
<p>Recall
that all normal distributions have two parameters, <span class="math inline">\(\mu\)</span> (the mean of the distribution) and <span class="math inline">\(\sigma^2\)</span> (the variance of the distribution). In a linear model, <span class="math inline">\(\mu\)</span> changes based on values of <span class="math inline">\(X\)</span> (the predictor
variable), but <span class="math inline">\(\sigma^2\)</span> has the same value for all values of <span class="math inline">\(Y\)</span>. Our simple linear can also be written as this:</p>
<p><span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span></p>
<p>with <span class="math inline">\(N(\cdot)\)</span> meaning that <span class="math inline">\(Y_i\)</span> is drawn from a <strong>normal distribution</strong> with parameters <span class="math inline">\(\mu\)</span> (mean; which depends on <span class="math inline">\(x_i\)</span>) and <span class="math inline">\(\sigma\)</span> (variance; which has the same value for all <span class="math inline">\(Y_i\)</span>s).</p>
<p>Let’s take a look at what happens to the distribution when we vary the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>Varying <span class="math inline">\(\mu\)</span> while <span class="math inline">\(\sigma = 5\)</span> shifts the mean of the distribution.</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we keep <span class="math inline">\(\mu = 25\)</span>, varying <span class="math inline">\(\sigma\)</span> changes the shape of the distribution, where smaller <span class="math inline">\(\sigma\)</span> (low variance) means there is higher probability around the mean, while larger <span class="math inline">\(\sigma\)</span> spreads out the probabilities across the full range of values.</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="model-prediction" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Model prediction</h3>
<p>When the assumptions of the linear model are not met, model prediction becomes problematic. Let’s work through an example to demonstrate some of the problems that arise from a poorly fitted model.</p>
<p>Remember that when we predict, we aim at estimating the <em>unknown coefficients</em> <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> so that a line effectively predicting every value of <span class="math inline">\(Y\)</span> as a function of <span class="math inline">\(X\)</span> can be drawn!</p>
<p><span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span></p>
<p>Let’s predict <em>Galumna</em> abundance at a water content = 300 using the linear model we fit above. <strong>What are the parameters of the normal distribution used to model <span class="math inline">\(Y\)</span> when water content is <span class="math inline">\(300\)</span>?</strong></p>
<p>Let’s begin by obtaining the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> for a normal distribution corresponding to our equation. To obtain the coefficients from our models, we can use the function <code>coef()</code>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="an-example-with-general-linear-models.html#cb37-1"></a><span class="kw">coef</span>(lm.abund)</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
##  3.439348672 -0.006044788</code></pre>
<p>These coefficients would allow us to predict <em>Galumna</em> abundance if there was no error. However, we know that error is an <strong>irrevocable</strong> part of our model. To get our predicted values, we therefore also need to add . This is where we use the normal
distribution! For <span class="math inline">\(X\)</span> = 300, our model predicts that should follow a normal distribution with mean = 1.63. We can extract the variance (<span class="math inline">\(\sigma^2\)</span>) from our model summary:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="an-example-with-general-linear-models.html#cb39-1"></a><span class="kw">summary</span>(lm.abund)<span class="op">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 1.513531</code></pre>
<p>We can plug these values into the equation we just discussed above:
<span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span>
<span class="math inline">\(\mu = 3.44 + (-0.006 \times 300) = 1.63\)</span></p>
<p><span class="math inline">\(\sigma^2 = 1.51\)</span></p>
<p>This tells us that randomly drawn <span class="math inline">\(Y\)</span> values when water content is <span class="math inline">\(300\)</span> should be on average <span class="math inline">\(1.63\)</span> and have a variance of <span class="math inline">\(1.51\)</span>. In other words, at <span class="math inline">\(x = 300\)</span>, residuals should follow a normal distribution with <span class="math inline">\(\mu = 1.63\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>. At <span class="math inline">\(x = 400\)</span>, we get <span class="math inline">\(\mu = 1.02\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>, etc.</p>
<p>At a water content of 400, residuals should follow a normal
distribution with parameters <span class="math inline">\(\mu = 3.44 + (-0.006 x 400) = 1.02\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>, etc. Each <span class="math inline">\(Y\)</span> value is modeled using a normal distribution with a mean that depends on <span class="math inline">\(X_i\)</span>, but with a variance that is constant <span class="math inline">\(\sigma^2 = 1.51\)</span> across all <span class="math inline">\(X_i\)</span> values. Graphically, this looks like this:</p>
<p><img src="images/modelPredic.png" /></p>
<p>The four normal distributions on this graph represent the probability of
observing a given Galumna abundance for 4 different water content
values. The mean of the normal distribution varies as a function of
water content (hence <span class="math inline">\(\mu\)</span> decreases with water content), but <span class="math inline">\(\sigma^2\)</span> is always 1.51 (i.e. the variance is homogeneous across all values of <span class="math inline">\(X\)</span>).</p>
<p>This model is inappropriate for at least two reasons:</p>
<p><strong>1. Values are on average further from the regression line at low water content values.</strong> That is, there is more residual variance around the predicted values for low values of <span class="math inline">\(X\)</span>, such that <span class="math inline">\(\varepsilon\)</span> varies as a function of <span class="math inline">\(X\)</span>, thus violating the assumption of homoscedasticity. It makes no sense to use a constant value of <span class="math inline">\(\sigma^2\)</span>: the normal distributions used to predict <span class="math inline">\(Y\)</span> at low values of <span class="math inline">\(X\)</span> should ideally be wider (have a larger <span class="math inline">\(\sigma^2\)</span>) than normal distributions used to predict <span class="math inline">\(Y\)</span> at large <span class="math inline">\(X\)</span> values, but linear models do not permit this.</p>
<p><strong>2. The residuals do not follow a normal distribution with constant variance across all values of</strong> <span class="math inline">\(X\)</span>. The variance of the residuals’ distribution changes as a function of <span class="math inline">\(X\)</span> (see the spread of the data points around the trendline!).</p>
<p><strong>3. The predicted values do not make sense, given the observations.</strong> Our response variable is abundance, which can only take integer values. Yet, at water content = 300, the abundance value that our model predicts to be the most probable is 1.63! We know that the probability of observing 1.63 individuals at water content = 300 is actually zero, as is the probability of observing any fraction (non-integers). Our predicted values should be modeled using a distribution that only predicts integers, rather than a continuous distribution like the normal distribution. This is a very common problem, as biological data often follows one of the myriad other statistical distributions besides the normal distribution.</p>
</div>
<div id="so-what-do-we-do-now-transform-our-data" class="section level3">
<h3><span class="header-section-number">4.1.2</span> So, what do we do now? Transform our data?</h3>
<p>Very often, data will not “behave” and will violate the assumptions we have seen, showing evidence for <strong>non-normality</strong> and/or <strong>heteroskedasticity</strong>.</p>
<p>We have been told to <strong>transform</strong> our data using logarithmic, square-root, and cosine transformations to get around these problems. Unfortunately, transformations not always work and come with a few drawbacks:</p>
<p><strong>1.</strong> They change the response variable (!), making interpretation challenging;
<strong>2.</strong> They may not simulateneously improve linearity and homogeneity of variance;
<strong>3.</strong> The boundaries of the sample space change.</p>
<p>For instance, our simple linear model:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>looks like this under a log-transform:</p>
<p><span class="math display">\[E(\log{Y_i}) = \beta_0 + \beta_1X_i \]</span></p>
<p>It is, of course, much less intuitive to interpret that for every <span class="math inline">\(300\)</span> units increase in water content, Galumna abundance takes the form of <span class="math inline">\(\log(1.63)\)</span>…</p>
<p>Thankfully, the <strong>normal distribution is not our only option!</strong></p>

</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="reviewing-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-distributions-of-biological-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
