<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Binomial GLMs (Bernouilli) | Workshop 6: Generalized linear models</title>
  <meta name="description" content="Generalized linear models in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Binomial GLMs (Bernouilli) | Workshop 6: Generalized linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Generalized linear models in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Binomial GLMs (Bernouilli) | Workshop 6: Generalized linear models" />
  
  <meta name="twitter:description" content="Generalized linear models in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="the-distributions-of-biological-data.html"/>
<link rel="next" href="binomial-glms.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Generalized linear models in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="why-are-generalized-linear-models-useful.html"><a href="why-are-generalized-linear-models-useful.html"><i class="fa fa-check"></i><b>3</b> Why are generalized linear models useful?</a></li>
<li class="chapter" data-level="4" data-path="the-distributions-of-biological-data.html"><a href="the-distributions-of-biological-data.html"><i class="fa fa-check"></i><b>4</b> The distributions of biological data</a></li>
<li class="part"><span><b>GLMs with binary data</b></span></li>
<li class="chapter" data-level="5" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html"><i class="fa fa-check"></i><b>5</b> Binomial GLMs (Bernouilli)</a><ul>
<li class="chapter" data-level="5.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#the-link-function"><i class="fa fa-check"></i><b>5.1</b> The link function</a><ul>
<li class="chapter" data-level="5.1.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#challenge-1"><i class="fa fa-check"></i><b>5.1.1</b> Challenge 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#interpreting-the-output-of-a-logistic-regression"><i class="fa fa-check"></i><b>5.2</b> Interpreting the output of a logistic regression</a></li>
<li class="chapter" data-level="5.3" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#predictive-power-and-goodness-of-fit"><i class="fa fa-check"></i><b>5.3</b> Predictive power and goodness-of-fit</a><ul>
<li class="chapter" data-level="5.3.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#challenge-2"><i class="fa fa-check"></i><b>5.3.1</b> Challenge 2</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#plotting-results"><i class="fa fa-check"></i><b>5.4</b> Plotting results</a></li>
</ul></li>
<li class="part"><span><b>GLMs with proportion data</b></span></li>
<li class="chapter" data-level="6" data-path="binomial-glms.html"><a href="binomial-glms.html"><i class="fa fa-check"></i><b>6</b> Binomial GLMs</a></li>
<li class="part"><span><b>GLMs with count data</b></span></li>
<li class="chapter" data-level="7" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html"><i class="fa fa-check"></i><b>7</b> What can we do with count data?</a></li>
<li class="chapter" data-level="8" data-path="poisson-glms.html"><a href="poisson-glms.html"><i class="fa fa-check"></i><b>8</b> Poisson GLMs</a><ul>
<li class="chapter" data-level="8.1" data-path="poisson-glms.html"><a href="poisson-glms.html#the-problem-of-overdispersion"><i class="fa fa-check"></i><b>8.1</b> The problem of overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>9</b> quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="10" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>10</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="10.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#plotting-the-final-glm-to-the-data"><i class="fa fa-check"></i><b>10.1</b> Plotting the final GLM to the data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>11</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Other distributions</b></span></li>
<li class="chapter" data-level="12" data-path="other-distributions.html"><a href="other-distributions.html"><i class="fa fa-check"></i><b>12</b> Other distributions</a></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="13" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>13</b> Summary</a></li>
<li class="chapter" data-level="14" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>14</b> Additional resources</a></li>
<li class="chapter" data-level="15" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>15</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 6: Generalized linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="binomial-glms-bernouilli" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Binomial GLMs (Bernouilli)</h1>
<p>A common response variable in ecological datasets is the binary
variable: we observe a phenomenon X or its “absence”. For example,
species presence/absence is frequently recorded in ecological monitoring
studies. We usually wish to determine whether a species’ presence is
affected by some environmental variables. Other examples include the
presence/absence of a disease within a wild population, the
success/failure to record a specific behaviour, and the survival/death
of organisms. A regression that has a binary response variable is one of
many generalized linear models and is called a logistic regression or a
logit model.</p>
<p>In R, presence (or success, survival…) is usually coded as 1 and
absence (or failure, death…) as 0. A logistic regression (or any other
generalized linear model) is performed with the <code>glm()</code> function. This
function is different from the basic <code>lm()</code> as it allows one to specify
a statistical distribution other than the normal distribution. We’ve
already seen that binary variables are not normally distributed (<em>i.e.</em>
we see a peak at 0 and a peak at 1 and nothing in between). Like we have
seen in the previous section, the Bernoulli distribution is well suited
for binary response variables. The mean of this distribution is the
probability <em>p</em> of observing an outcome and the variance is <em>p</em>*(1 -
<em>p</em>). The (1 - <em>p</em>) term represents the probability of <strong>not</strong> observing
an outcome. In R, we specify the distribution with the <code>family</code>
argument. For the logistic regression, we code it as:
<code>family='binomial</code>’. Remember that the Bernoulli distribution is a
special case of the binomial distribution when the number of repetitions
is 1: R will “understand” that it is a Bernoulli distribution.</p>
<p>When predicting the probability of observing some phenomenon Y, which is
a binary variable, the expected values should be bound between 0 and 1:
that’s the range of a probability value! If we use a basic linear model
to relate a binary response variable to various explanatory variables,
we might obtain fitted values outside of the <span class="math display">\[0,1\]</span> range, which is
nonsensical. The following example will help you understand why a basic
linear model is inappropriate here. The next subsection will show you
how to avoid this problem with a link function. Briefly, a link function
is used to linearize the relationship between predicted values of the
response variable and the linear predictor (see next subsection).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="binomial-glms-bernouilli.html#cb15-1"></a>model.lm &lt;-<span class="st"> </span><span class="kw">lm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mites)</span>
<span id="cb15-2"><a href="binomial-glms-bernouilli.html#cb15-2"></a><span class="kw">fitted</span>(model.lm)</span>
<span id="cb15-3"><a href="binomial-glms-bernouilli.html#cb15-3"></a><span class="co"># The &#39;fitted()&#39; function gives us expected values for the</span></span>
<span id="cb15-4"><a href="binomial-glms-bernouilli.html#cb15-4"></a><span class="co"># response variable.  Some values are lower than 0, which</span></span>
<span id="cb15-5"><a href="binomial-glms-bernouilli.html#cb15-5"></a><span class="co"># does not make sense for a logistic regression.  Let’s try</span></span>
<span id="cb15-6"><a href="binomial-glms-bernouilli.html#cb15-6"></a><span class="co"># the same model with a binomial distribution instead.</span></span>
<span id="cb15-7"><a href="binomial-glms-bernouilli.html#cb15-7"></a><span class="co"># Notice the &#39;family&#39; argument to specify the distribution.</span></span>
<span id="cb15-8"><a href="binomial-glms-bernouilli.html#cb15-8"></a>model.glm &lt;-<span class="st"> </span><span class="kw">glm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mites, <span class="dt">family =</span> binomial)</span>
<span id="cb15-9"><a href="binomial-glms-bernouilli.html#cb15-9"></a><span class="kw">fitted</span>(model.glm)</span>
<span id="cb15-10"><a href="binomial-glms-bernouilli.html#cb15-10"></a><span class="co"># All values are bound between 0 and 1.</span></span></code></pre></div>
<div id="the-link-function" class="section level2">
<h2><span class="header-section-number">5.1</span> The link function</h2>
<p>To move away from the traditional linear model and to avoid its biases,
we need to specify two things when using a logistic regression: a
distribution for the residuals of the model and a link function for the
expected values. We already presented the Bernoulli distribution in the
previous section so let’s have a look at what the link function is.</p>
<p>In the case of a simple linear model of a normally distributed
continuous response variable, the following equation gives the expected
values:</p>
<p><em>μ</em> = <em>Xβ</em></p>
<p>where <em>μ</em> is the expected value of the response variable, <em>X</em> is the
model matrix (<em>i.e.</em> representing your data) and <em>β</em> corresponds to the
parameters we estimate from the data (<em>i.e.</em> the intercept and the
slope). The right-hand side of this equation is called the linear
predictor. In mathematical terms, it is the matrix product of the model
matrix <em>X</em> of a statistical model and the vector of estimated parameters
<em>β</em>. Let’s have a look at this in R:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="binomial-glms-bernouilli.html#cb16-1"></a><span class="co"># Load the CO2 dataset. We used it during workshop 4!</span></span>
<span id="cb16-2"><a href="binomial-glms-bernouilli.html#cb16-2"></a><span class="kw">data</span>(CO2)</span>
<span id="cb16-3"><a href="binomial-glms-bernouilli.html#cb16-3"></a><span class="kw">head</span>(CO2)</span>
<span id="cb16-4"><a href="binomial-glms-bernouilli.html#cb16-4"></a><span class="co"># Build a linear model of plant CO2 uptake as a function of</span></span>
<span id="cb16-5"><a href="binomial-glms-bernouilli.html#cb16-5"></a><span class="co"># CO2 ambient concentration</span></span>
<span id="cb16-6"><a href="binomial-glms-bernouilli.html#cb16-6"></a>model.CO2 &lt;-<span class="st"> </span><span class="kw">lm</span>(uptake <span class="op">~</span><span class="st"> </span>conc, <span class="dt">data =</span> CO2)</span>
<span id="cb16-7"><a href="binomial-glms-bernouilli.html#cb16-7"></a><span class="co"># Extract the design matrix of the model with the</span></span>
<span id="cb16-8"><a href="binomial-glms-bernouilli.html#cb16-8"></a><span class="co"># model.matrix() function.</span></span>
<span id="cb16-9"><a href="binomial-glms-bernouilli.html#cb16-9"></a>X &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(model.CO2)</span>
<span id="cb16-10"><a href="binomial-glms-bernouilli.html#cb16-10"></a><span class="co"># And the estimated coefficients.</span></span>
<span id="cb16-11"><a href="binomial-glms-bernouilli.html#cb16-11"></a>B &lt;-<span class="st"> </span>model.CO2<span class="op">$</span>coefficients</span>
<span id="cb16-12"><a href="binomial-glms-bernouilli.html#cb16-12"></a><span class="co"># Let’s multiply both X and B matrices to obtain the linear</span></span>
<span id="cb16-13"><a href="binomial-glms-bernouilli.html#cb16-13"></a><span class="co"># predictor.  The &#39;%*%&#39; symbol indicates that it is a matrix</span></span>
<span id="cb16-14"><a href="binomial-glms-bernouilli.html#cb16-14"></a><span class="co"># product.</span></span>
<span id="cb16-15"><a href="binomial-glms-bernouilli.html#cb16-15"></a>XB &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>B</span>
<span id="cb16-16"><a href="binomial-glms-bernouilli.html#cb16-16"></a><span class="co"># Compare the values of XB to the values obtained with the</span></span>
<span id="cb16-17"><a href="binomial-glms-bernouilli.html#cb16-17"></a><span class="co"># predict() function.  All statements should be TRUE.  We use</span></span>
<span id="cb16-18"><a href="binomial-glms-bernouilli.html#cb16-18"></a><span class="co"># the round() function so that all elements have 5 digits.</span></span>
<span id="cb16-19"><a href="binomial-glms-bernouilli.html#cb16-19"></a><span class="kw">round</span>(<span class="kw">fitted</span>(model.CO2), <span class="dt">digits =</span> <span class="dv">5</span>) <span class="op">==</span><span class="st"> </span><span class="kw">round</span>(XB, <span class="dt">digits =</span> <span class="dv">5</span>)</span></code></pre></div>
<p>When using a simple linear model with a normally distributed response
variable, the linear predictor is directly equal to the expected values
of the model. But, what if our response variable is not normally
distributed? If that is the case, we have to use a transformation on the
expected values, <em>i.e.</em> a link function. A link function can be
understood as a transformation of the expected values so that it can be
<strong>linearly related</strong> to the linear predictor:</p>
<p><em>g</em>(<em>μ</em>) = <em>Xβ</em></p>
<p>where <em>g</em>(<em>μ</em>) is the link function for the expected values. This allows
us to relax the normality assumption. In the case of a binary response
variable, the link function is called the logit function and is given
by:</p>
<p>logit(<em>μ</em>) = log (<em>μ</em> / 1-<em>μ</em>) = <em>Xβ</em></p>
<p>where <em>μ</em> represents expected values (<em>i.e.</em> the probability that Y = 1
because we observed the presence of a species, disease, success, or some
other event). The ratio <em>μ</em> / 1-<em>μ</em> represents the odds that some
outcome occured and it transforms the expected values into continuous
values from 0 to infinity. If we have a 0.8 probability of observing
species X, then our odds are 4 times more likely to observe the species
than to not observe it: 0.8/(1-0.8) = 4. The log transformation, called
the log odds, allows values to be spread across -infinity to infinity.
Hence, the logit function took the expected values of a model and
transformed them into continuous values without boundaries. The expected
values can now be directly related to a linear predictor. This is why we
still call this model a generalized <strong>linear</strong> model even though the
plot of our response variable as a function of some explanatory variable
doesn’t look like a “straight line”!</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="binomial-glms-bernouilli.html#cb17-1"></a><span class="co"># Let’s build a regression model of the presence/absence of a</span></span>
<span id="cb17-2"><a href="binomial-glms-bernouilli.html#cb17-2"></a><span class="co"># mite species (Galumna sp.)  as a function of water content</span></span>
<span id="cb17-3"><a href="binomial-glms-bernouilli.html#cb17-3"></a><span class="co"># and topography.  To do this, we need to use the glm()</span></span>
<span id="cb17-4"><a href="binomial-glms-bernouilli.html#cb17-4"></a><span class="co"># function and specify the family argument.</span></span>
<span id="cb17-5"><a href="binomial-glms-bernouilli.html#cb17-5"></a>logit.reg &lt;-<span class="st"> </span><span class="kw">glm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mites, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb17-6"><a href="binomial-glms-bernouilli.html#cb17-6"></a><span class="co"># The logit function is the default for the binomial</span></span>
<span id="cb17-7"><a href="binomial-glms-bernouilli.html#cb17-7"></a><span class="co"># distribution, so it is not necessary to include it in the</span></span>
<span id="cb17-8"><a href="binomial-glms-bernouilli.html#cb17-8"></a><span class="co"># &#39;family&#39; argument:</span></span>
<span id="cb17-9"><a href="binomial-glms-bernouilli.html#cb17-9"></a>logit.reg &lt;-<span class="st"> </span><span class="kw">glm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont <span class="op">+</span><span class="st"> </span>Topo, <span class="dt">data =</span> mites, <span class="dt">family =</span> binomial)</span>
<span id="cb17-10"><a href="binomial-glms-bernouilli.html#cb17-10"></a><span class="kw">summary</span>(logit.reg)</span></code></pre></div>
<div id="challenge-1" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Challenge 1</h3>
<p>Using the <code>bacteria</code> dataset (from the <code>MASS</code> package), model the
presence of <em>H. influenzae</em> as a function of treatment and week of test.
Start with a full model and reduce it to the most parsimonious model.</p>
<p>Challenge 1: Solution</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="binomial-glms-bernouilli.html#cb18-1"></a>model.bact1 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>trt <span class="op">*</span><span class="st"> </span>week, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>), </span>
<span id="cb18-2"><a href="binomial-glms-bernouilli.html#cb18-2"></a>    <span class="dt">data =</span> bacteria)</span>
<span id="cb18-3"><a href="binomial-glms-bernouilli.html#cb18-3"></a>model.bact2 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>trt <span class="op">+</span><span class="st"> </span>week, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>), </span>
<span id="cb18-4"><a href="binomial-glms-bernouilli.html#cb18-4"></a>    <span class="dt">data =</span> bacteria)</span>
<span id="cb18-5"><a href="binomial-glms-bernouilli.html#cb18-5"></a>model.bact3 &lt;-<span class="st"> </span><span class="kw">glm</span>(y <span class="op">~</span><span class="st"> </span>week, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>), <span class="dt">data =</span> bacteria)</span>
<span id="cb18-6"><a href="binomial-glms-bernouilli.html#cb18-6"></a><span class="kw">anova</span>(model.bact1, model.bact2, model.bact3, <span class="dt">test =</span> <span class="st">&quot;LRT&quot;</span>)</span>
<span id="cb18-7"><a href="binomial-glms-bernouilli.html#cb18-7"></a><span class="co"># Analysis of Deviance Table Model 1: y ~ trt * week Model 2:</span></span>
<span id="cb18-8"><a href="binomial-glms-bernouilli.html#cb18-8"></a><span class="co"># y ~ trt + week Model 3: y ~ week Resid. Df Resid. Dev Df</span></span>
<span id="cb18-9"><a href="binomial-glms-bernouilli.html#cb18-9"></a><span class="co"># Deviance Pr(&gt;Chi) 1 214 203.12 2 216 203.81 -2 -0.6854</span></span>
<span id="cb18-10"><a href="binomial-glms-bernouilli.html#cb18-10"></a><span class="co"># 0.70984 3 218 210.91 -2 -7.1026 0.02869 * Based on these</span></span>
<span id="cb18-11"><a href="binomial-glms-bernouilli.html#cb18-11"></a><span class="co"># results, we select model #2 as the best candidate to model</span></span>
<span id="cb18-12"><a href="binomial-glms-bernouilli.html#cb18-12"></a><span class="co"># these data.</span></span></code></pre></div>
</div>
</div>
<div id="interpreting-the-output-of-a-logistic-regression" class="section level2">
<h2><span class="header-section-number">5.2</span> Interpreting the output of a logistic regression</h2>
<p>The output of the previous logistic regression indicates that both water
content and topography are significant, but how do we interpret the
slope coefficients? Remember that we applied a transformation on our
expected values (<em>i.e.</em> the probability that Y = 1) so we have to use a
reverse function to properly interpret the results. We can use the
natural exponential function <code>ex</code> to obtain the odds of probability of
success for each explanatory variable.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="binomial-glms-bernouilli.html#cb19-1"></a><span class="co"># Obtaining the odds of the slope.  Use the &#39;exp()&#39; function</span></span>
<span id="cb19-2"><a href="binomial-glms-bernouilli.html#cb19-2"></a><span class="co"># to put the coefficients back on the odds scale.</span></span>
<span id="cb19-3"><a href="binomial-glms-bernouilli.html#cb19-3"></a><span class="co"># Mathematically, this line of code corresponds to: exp(model</span></span>
<span id="cb19-4"><a href="binomial-glms-bernouilli.html#cb19-4"></a><span class="co"># coefficients) = exp(log(μ / (1 - μ)) = u / (1 - μ) This</span></span>
<span id="cb19-5"><a href="binomial-glms-bernouilli.html#cb19-5"></a><span class="co"># corresponds to an odds ratio!</span></span>
<span id="cb19-6"><a href="binomial-glms-bernouilli.html#cb19-6"></a><span class="kw">exp</span>(logit.reg<span class="op">$</span>coefficients[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb19-7"><a href="binomial-glms-bernouilli.html#cb19-7"></a><span class="co"># WatrCont TopoHummock 0.9843118 8.0910340 To obtain</span></span>
<span id="cb19-8"><a href="binomial-glms-bernouilli.html#cb19-8"></a><span class="co"># confidence intervals on the odds scale:</span></span>
<span id="cb19-9"><a href="binomial-glms-bernouilli.html#cb19-9"></a><span class="kw">exp</span>(<span class="kw">confint</span>(logit.reg)[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, ])</span>
<span id="cb19-10"><a href="binomial-glms-bernouilli.html#cb19-10"></a><span class="co"># 2.5 % 97.5 % WatrCont 0.9741887 0.9919435 TopoHummock</span></span>
<span id="cb19-11"><a href="binomial-glms-bernouilli.html#cb19-11"></a><span class="co"># 2.0460547 38.6419693</span></span></code></pre></div>
<p>Note that the odds values here are considered when all other parameters
are kept constant. The topography parameter value is 8.09. It means that
the probability of observing <em>Galumna</em> sp. is 8.09 times more likely
when the topography is hummock compared to blanket.</p>
<p>When the odds value is smaller than 1, interpretation is a little bit
more complicated. When this is the case, we have to take the inverse
value (<em>i.e.</em> 1 divided by the odds) to facilitate interpretation. The
interpretation is then how <strong>LESS</strong> likely it is to observe the event of
interest. For water content, the odds is 0.984. The inverse is 1 / 0.984
= 1.0159. This means that a one-unit increase in water content decreases
the likelihood of observing <em>Galumna</em> sp. by 1.0159. We can also
substract 1 from the odds value to obtain a percentage: (1.0159 - 1) *
100 = 1.59% decrease in probability of observing <em>Galumna</em> sp. with a
one-unit increase in water content. To convince ourselves that it is an
appropriate interpretation, we can plot the presence of <em>Galumna</em> sp. as
a function of water content. We see that, on average, <em>Galumna</em> sp.
presence is higher at lower water content than its “absence”.</p>
<p><img src="images/galumna_pa.png" width="400" /></p>
<p>When the parameter estimate is between 0 and 1 on the odds scales, it
indicates a negative relationship between the response variable and the
explanatory variable. If the parameter is greater than 1, it indicates a
positive relationship between the response variable and the explanatory
variable. If the confidence interval includes 1, it indicates that the
variable is not significant. Remember that a value of 1 on the odds
scale means that the probability of Y = 1 is the same as the probability
of Y = 0 (<em>i.e.</em> when p = 0.5, 0.5/(1-0.5) = 1).</p>
<p>If you want to obtain the probabilities instead of the odds for each
explanatory variable, the inverse logit function is what you need:</p>
<p>logit<sup>-1</sup> = 1/(1+1/exp(x))</p>
<p>where x is the parameter to transform from log odds to the probability
scale. The parameter estimate of topography in our <code>logit.reg</code> model is
2.091, which is on the log odds scale. So, the probability value is
given by:</p>
<p>1/(1+1/exp(2.091)) = 0.89 which is the same as 1/(1+1/8.09). Remember
that the value 8.09 is on the odds scale. We have a 0.89 probability of
observing <em>Galumna</em> sp. when the topography is Hummock.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="binomial-glms-bernouilli.html#cb20-1"></a><span class="co"># Let&#39;s start with our odds ratio for topography from the logit.reg model:</span></span>
<span id="cb20-2"><a href="binomial-glms-bernouilli.html#cb20-2"></a>µ<span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>µ) =<span class="st"> </span><span class="fl">8.09</span></span>
<span id="cb20-3"><a href="binomial-glms-bernouilli.html#cb20-3"></a><span class="co"># Let&#39;s rearrange this to isolate µ</span></span>
<span id="cb20-4"><a href="binomial-glms-bernouilli.html#cb20-4"></a>µ =<span class="st"> </span><span class="fl">8.09</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>µ) =<span class="st"> </span><span class="fl">8.09</span> <span class="op">-</span><span class="st"> </span><span class="fl">8.09</span>µ</span>
<span id="cb20-5"><a href="binomial-glms-bernouilli.html#cb20-5"></a><span class="fl">8.09</span>µ <span class="op">+</span><span class="st"> </span>µ =<span class="st"> </span><span class="fl">8.09</span></span>
<span id="cb20-6"><a href="binomial-glms-bernouilli.html#cb20-6"></a>µ(<span class="fl">8.09</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) =<span class="st"> </span><span class="fl">8.09</span></span>
<span id="cb20-7"><a href="binomial-glms-bernouilli.html#cb20-7"></a>µ =<span class="st"> </span><span class="fl">8.09</span> <span class="op">/</span><span class="st"> </span>(<span class="fl">8.09</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb20-8"><a href="binomial-glms-bernouilli.html#cb20-8"></a>µ =<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="fl">8.09</span>)) =<span class="st"> </span><span class="fl">0.89</span></span>
<span id="cb20-9"><a href="binomial-glms-bernouilli.html#cb20-9"></a><span class="co"># We obtained the same result without using the exp() function!</span></span></code></pre></div>
</div>
<div id="predictive-power-and-goodness-of-fit" class="section level2">
<h2><span class="header-section-number">5.3</span> Predictive power and goodness-of-fit</h2>
<p>An easy and intuitive way to evaluate the predictive power of your model
is to compare its deviance to the deviance of a null model. Deviance can
be understood as a generalisation of the residual sum of squares when
models are estimated by maximum likelihood (i.e. it is how parameters
are estimated in GLM). This allows us to compute a pseudo-R<sup>2</sup>
statistic, which is analogous to the coefficient of determination R<sup>2</sup>
in ordinary least square regression (i.e. the basic method for linear
models). The null model is a model without any explanatory variable. Its
notation in R is:
<code>null.model &lt;- glm(Response.variable ~ 1, family = binomial)</code>. The
generic formula to compute a pseudo-R<sup>2</sup> is given by:</p>
<p>Pseudo-R<sup>2</sup> = (null deviance – residual deviance) / null deviance</p>
<p>where “null deviance” is the deviance of the null model and “residual
deviance” is the deviance of the model of interest. The difference is
divided by the null deviance so that the result is bound between 0 and
1.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="binomial-glms-bernouilli.html#cb21-1"></a><span class="co"># Residual and null deviances are already stored in the glm object.</span></span>
<span id="cb21-2"><a href="binomial-glms-bernouilli.html#cb21-2"></a><span class="kw">objects</span>(logit.reg)</span>
<span id="cb21-3"><a href="binomial-glms-bernouilli.html#cb21-3"></a>pseudoR2 &lt;-<span class="st"> </span>(logit.reg<span class="op">$</span>null.deviance – logit.reg<span class="op">$</span>deviance) <span class="op">/</span><span class="st"> </span>logit.reg<span class="op">$</span>null.deviance</span>
<span id="cb21-4"><a href="binomial-glms-bernouilli.html#cb21-4"></a>pseudoR2</span>
<span id="cb21-5"><a href="binomial-glms-bernouilli.html#cb21-5"></a><span class="co"># [1]  0.4655937</span></span></code></pre></div>
<p>Hence, the model explains 46.6% of the variability in the data.</p>
<p>Recently, <a href="http://www.tandfonline.com/doi/abs/10.1198/tast.2009.08210#.VFpKZYcc4ow">Tjur
(2009)</a>
proposed a new statistic, the coefficient of discrimination (<em>D</em>), to
evaluate the predictive power of logistic regression models.
Intuitively, <em>D</em> is a measure of how well a logistic regression can
classify an outcome as a success or a failure. In mathematical terms, it
is the difference between the means of expected probability values for
successes (<em>i.e.</em> Y =1) and failures (<em>i.e.</em> Y = 0):</p>
<p>&lt;m&gt;D = overline{π}_1 - overline{π}_0&lt;/m&gt;</p>
<p>where &lt;m&gt;overline{π}_1&lt;/m&gt; is the mean of expected probability
values when the outcome is observed and &lt;m&gt;overline{π}_0&lt;/m&gt; is the
mean of expected probability values when the outcome is not observed. A
<em>D</em> value close to 1 indicates that the model gives a high probability
of observing an outcome to cases where the outcome was actually observed
and a low probability of observing an outcome to cases where the outcome
was not observed. A <em>D</em> value close to 0 indicates that the model is not
efficient at discriminating between the occurrences and “non
occurrences” of an outcome. The following code shows how to obtain <em>D</em>
and how to plot the histograms of &lt;m&gt;overline{π}_1&lt;/m&gt; and
&lt;m&gt;overline{π}_0&lt;/m&gt;.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="binomial-glms-bernouilli.html#cb22-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;binomTools&quot;</span>)</span>
<span id="cb22-2"><a href="binomial-glms-bernouilli.html#cb22-2"></a><span class="kw">library</span>(<span class="st">&quot;binomTools&quot;</span>)</span>
<span id="cb22-3"><a href="binomial-glms-bernouilli.html#cb22-3"></a><span class="co"># The Rsq function computes several fit indices, including</span></span>
<span id="cb22-4"><a href="binomial-glms-bernouilli.html#cb22-4"></a><span class="co"># the coefficient of discrimination.  For information on the</span></span>
<span id="cb22-5"><a href="binomial-glms-bernouilli.html#cb22-5"></a><span class="co"># other fit indices, see Tjur (2009).  The plot shows the</span></span>
<span id="cb22-6"><a href="binomial-glms-bernouilli.html#cb22-6"></a><span class="co"># distribution of expected values when the outcome is</span></span>
<span id="cb22-7"><a href="binomial-glms-bernouilli.html#cb22-7"></a><span class="co"># observed and not observed.  Ideally, the overlap between</span></span>
<span id="cb22-8"><a href="binomial-glms-bernouilli.html#cb22-8"></a><span class="co"># the two histograms should be small.</span></span>
<span id="cb22-9"><a href="binomial-glms-bernouilli.html#cb22-9"></a>fit &lt;-<span class="st"> </span><span class="kw">Rsq</span>(<span class="dt">object =</span> logit.reg)</span>
<span id="cb22-10"><a href="binomial-glms-bernouilli.html#cb22-10"></a>fit</span>
<span id="cb22-11"><a href="binomial-glms-bernouilli.html#cb22-11"></a><span class="co"># R-square measures and the coefficient of discrimination,</span></span>
<span id="cb22-12"><a href="binomial-glms-bernouilli.html#cb22-12"></a><span class="co"># &#39;D&#39;: R2mod R2res R2cor D 0.5205221 0.5024101 0.5025676</span></span>
<span id="cb22-13"><a href="binomial-glms-bernouilli.html#cb22-13"></a><span class="co"># 0.5114661 Number of binomial observations: 70 Number of</span></span>
<span id="cb22-14"><a href="binomial-glms-bernouilli.html#cb22-14"></a><span class="co"># binary observation: 70 Average group size: 1</span></span>
<span id="cb22-15"><a href="binomial-glms-bernouilli.html#cb22-15"></a><span class="kw">plot</span>(fit, <span class="dt">which =</span> <span class="st">&quot;hist&quot;</span>)</span></code></pre></div>
<p>To assess the goodness-of-fit of a logistic regression, the diagnostic
plots (see workshop 4) are not useful. Instead, you can do a
<a href="http://en.wikipedia.org/wiki/Hosmer-Lemeshow_test">Hosmer-Lemeshow
test</a> to evaluate
whether your model is appropriate. This test separates the expected
values (ordered from smallest to largest) in groups of approximately
equal size. Ten is usually the recommended group number. In each group,
we compare the observed and expected number of outcomes. It is similar
to a chi-square test with G - 2 degrees of freedom (G is the number of
groups). In R, this test is available in the <code>binomTools</code> package.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="binomial-glms-bernouilli.html#cb23-1"></a>fit &lt;-<span class="st"> </span><span class="kw">Rsq</span>(<span class="dt">object =</span> logit.reg)</span>
<span id="cb23-2"><a href="binomial-glms-bernouilli.html#cb23-2"></a><span class="kw">HLtest</span>(<span class="dt">object =</span> fit)</span>
<span id="cb23-3"><a href="binomial-glms-bernouilli.html#cb23-3"></a><span class="co"># The p value is 0.9051814. Hence, we do not reject the</span></span>
<span id="cb23-4"><a href="binomial-glms-bernouilli.html#cb23-4"></a><span class="co"># model.  We can consider it as appropriate for the data.</span></span></code></pre></div>
<div id="challenge-2" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Challenge 2</h3>
<p>Assess goodness-of-fit and predictive power of the <code>model.bact2</code> model. How can you improve the predictive power of this model?</p>
<p>Challenge 2: Solution</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="binomial-glms-bernouilli.html#cb24-1"></a>null.d &lt;-<span class="st"> </span>model.bact2<span class="op">$</span>null.deviance</span>
<span id="cb24-2"><a href="binomial-glms-bernouilli.html#cb24-2"></a>resid.d &lt;-<span class="st"> </span>model.bact2<span class="op">$</span>deviance</span>
<span id="cb24-3"><a href="binomial-glms-bernouilli.html#cb24-3"></a>bact.pseudoR2 &lt;-<span class="st"> </span>(null.d <span class="op">-</span><span class="st"> </span>resid.d)<span class="op">/</span>null.d</span>
<span id="cb24-4"><a href="binomial-glms-bernouilli.html#cb24-4"></a>bact.pseudoR2</span>
<span id="cb24-5"><a href="binomial-glms-bernouilli.html#cb24-5"></a><span class="co"># 0.0624257 This is very low!</span></span>
<span id="cb24-6"><a href="binomial-glms-bernouilli.html#cb24-6"></a><span class="kw">library</span>(binomTools)</span>
<span id="cb24-7"><a href="binomial-glms-bernouilli.html#cb24-7"></a><span class="kw">HLtest</span>(<span class="kw">Rsq</span>(model.bact2))</span>
<span id="cb24-8"><a href="binomial-glms-bernouilli.html#cb24-8"></a><span class="co"># Chi-square statistic: 7.812347 with 8 df P-value: 0.4520122</span></span>
<span id="cb24-9"><a href="binomial-glms-bernouilli.html#cb24-9"></a><span class="co"># Fit is adequate.</span></span></code></pre></div>
<p>Predictive power could be increased by including more relevant explanatory varibles.</p>
</div>
</div>
<div id="plotting-results" class="section level2">
<h2><span class="header-section-number">5.4</span> Plotting results</h2>
<p>Once we’ve created a model and verified its validity, we can plot the
results to show how the response variable is related to some explanatory
variables. One way to graphically summarise the data is by plotting both
the response variable and the expected values as a function of some
predictor. Here is an example with the <code>ggplot2</code> package. See <a href="r_workshop3">workshop
3</a> for more information on this package.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="binomial-glms-bernouilli.html#cb25-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb25-2"><a href="binomial-glms-bernouilli.html#cb25-2"></a><span class="kw">ggplot</span>(mites, <span class="kw">aes</span>(<span class="dt">x =</span> WatrCont, <span class="dt">y =</span> pa)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>, </span>
<span id="cb25-3"><a href="binomial-glms-bernouilli.html#cb25-3"></a>    <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Water content&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-4"><a href="binomial-glms-bernouilli.html#cb25-4"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Probability of presence&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Probability of presence of Galumna sp. as a function of water content&quot;</span>)</span></code></pre></div>
<p><img src="images//logistic_regression_plot.png" width="500" /></p>

</div>
</div>



<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="the-distributions-of-biological-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="binomial-glms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
