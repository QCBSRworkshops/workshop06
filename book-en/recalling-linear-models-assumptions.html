<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Recalling linear models: assumptions | Workshop 6: Generalized linear models</title>
  <meta name="description" content="Generalized linear models in R" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Recalling linear models: assumptions | Workshop 6: Generalized linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Generalized linear models in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Recalling linear models: assumptions | Workshop 6: Generalized linear models" />
  
  <meta name="twitter:description" content="Generalized linear models in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="example-with-real-data.html"/>
<link rel="next" href="the-distributions-of-biological-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Generalized linear models in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html"><i class="fa fa-check"></i><b>3</b> Reviewing linear models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#general-linear-models"><i class="fa fa-check"></i><b>3.1</b> General linear models</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#definition"><i class="fa fa-check"></i><b>3.1.1</b> Definition</a></li>
<li class="chapter" data-level="3.1.2" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#assumptions"><i class="fa fa-check"></i><b>3.1.2</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#an-example-with-general-linear-models"><i class="fa fa-check"></i><b>3.2</b> An example with general linear models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="example-with-real-data.html"><a href="example-with-real-data.html"><i class="fa fa-check"></i><b>4</b> Example with real data</a></li>
<li class="chapter" data-level="5" data-path="recalling-linear-models-assumptions.html"><a href="recalling-linear-models-assumptions.html"><i class="fa fa-check"></i><b>5</b> Recalling linear models: assumptions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="recalling-linear-models-assumptions.html"><a href="recalling-linear-models-assumptions.html#model-prediction"><i class="fa fa-check"></i><b>5.1</b> Model prediction</a></li>
<li class="chapter" data-level="5.2" data-path="recalling-linear-models-assumptions.html"><a href="recalling-linear-models-assumptions.html#so-what-do-we-do-now-transform-our-data"><i class="fa fa-check"></i><b>5.2</b> So, what do we do now? Transform our data?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-distributions-of-biological-data.html"><a href="the-distributions-of-biological-data.html"><i class="fa fa-check"></i><b>6</b> The distributions of biological data</a></li>
<li class="chapter" data-level="7" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>7</b> Generalized linear models</a></li>
<li class="part"><span><b>GLM with binary data</b></span></li>
<li class="chapter" data-level="8" data-path="binomial-glm.html"><a href="binomial-glm.html"><i class="fa fa-check"></i><b>8</b> Binomial GLM</a>
<ul>
<li class="chapter" data-level="8.1" data-path="binomial-glm.html"><a href="binomial-glm.html#glm-with-binomial-data-logit-link"><i class="fa fa-check"></i><b>8.1</b> GLM with binomial data: logit link</a></li>
<li class="chapter" data-level="8.2" data-path="binomial-glm.html"><a href="binomial-glm.html#example"><i class="fa fa-check"></i><b>8.2</b> Example</a></li>
<li class="chapter" data-level="8.3" data-path="binomial-glm.html"><a href="binomial-glm.html#challenge-1"><i class="fa fa-check"></i><b>8.3</b> Challenge 1</a></li>
<li class="chapter" data-level="8.4" data-path="binomial-glm.html"><a href="binomial-glm.html#interpreting-the-output-of-a-logistic-regression"><i class="fa fa-check"></i><b>8.4</b> Interpreting the output of a logistic regression</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="binomial-glm.html"><a href="binomial-glm.html#an-example-using-the-identity-link"><i class="fa fa-check"></i><b>8.4.1</b> An example using the identity link</a></li>
<li class="chapter" data-level="8.4.2" data-path="binomial-glm.html"><a href="binomial-glm.html#interpreting-the-coefficients-using-the-logit-link"><i class="fa fa-check"></i><b>8.4.2</b> Interpreting the coefficients using the logit link</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="binomial-glm.html"><a href="binomial-glm.html#predictive-power-and-goodness-of-fit"><i class="fa fa-check"></i><b>8.5</b> Predictive power and goodness-of-fit</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="binomial-glm.html"><a href="binomial-glm.html#challenge-2"><i class="fa fa-check"></i><b>8.5.1</b> Challenge 2</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="binomial-glm.html"><a href="binomial-glm.html#visual-representation-of-results"><i class="fa fa-check"></i><b>8.6</b> Visual representation of results</a></li>
</ul></li>
<li class="part"><span><b>GLM with proportion data</b></span></li>
<li class="chapter" data-level="9" data-path="binomial-glm-and-proportions.html"><a href="binomial-glm-and-proportions.html"><i class="fa fa-check"></i><b>9</b> Binomial GLM and proportions</a></li>
<li class="part"><span><b>GLMs with count data</b></span></li>
<li class="chapter" data-level="10" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html"><i class="fa fa-check"></i><b>10</b> What can we do with count data?</a>
<ul>
<li class="chapter" data-level="10.1" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#poisson-glms"><i class="fa fa-check"></i><b>10.1</b> Poisson GLMs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#the-poisson-distribution"><i class="fa fa-check"></i><b>10.1.1</b> The Poisson distribution</a></li>
<li class="chapter" data-level="10.1.2" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#poisson-glms-in-r"><i class="fa fa-check"></i><b>10.1.2</b> Poisson GLMs in <code>R</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#the-problem-of-overdispersion"><i class="fa fa-check"></i><b>10.2</b> The problem of overdispersion</a></li>
<li class="chapter" data-level="10.3" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#quasi-poisson-glms"><i class="fa fa-check"></i><b>10.3</b> Quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="10.4" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#negative-binomial-glms"><i class="fa fa-check"></i><b>10.4</b> Negative binomial GLMs</a></li>
<li class="chapter" data-level="10.5" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#plotting-the-final-glm-to-the-data"><i class="fa fa-check"></i><b>10.5</b> Plotting the final GLM to the data</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#challenge-3"><i class="fa fa-check"></i><b>10.5.1</b> Challenge 3</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#conclusion-on-glms-with-count-data"><i class="fa fa-check"></i><b>10.6</b> Conclusion on GLMs with count data</a></li>
</ul></li>
<li class="part"><span><b>Other distributions</b></span></li>
<li class="chapter" data-level="11" data-path="other-distributions.html"><a href="other-distributions.html"><i class="fa fa-check"></i><b>11</b> Other distributions</a></li>
<li class="part"><span><b>Additional GLM resources</b></span></li>
<li class="chapter" data-level="12" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>12</b> Summary</a></li>
<li class="chapter" data-level="13" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>13</b> Additional resources</a></li>
<li class="chapter" data-level="14" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>14</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 6: Generalized linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="recalling-linear-models-assumptions" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Recalling linear models: assumptions<a href="recalling-linear-models-assumptions.html#recalling-linear-models-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Let us validate these models to confirm that the assumptions of linear models are being respected, starting with the abundance model.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="recalling-linear-models-assumptions.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the abundance model</span></span>
<span id="cb27-2"><a href="recalling-linear-models-assumptions.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Galumna <span class="sc">~</span> WatrCont, <span class="at">data =</span> mites)</span>
<span id="cb27-3"><a href="recalling-linear-models-assumptions.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.abund)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The model does not fit well. It predicts negative abundance values when <code>WatrCont</code> exceeds 600, which does not make any sense. Also, the model does poorly at predicting high abundance values at low values of <code>WatrCont</code>.</p>
<p>We can also check the model diagnostic plots:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="recalling-linear-models-assumptions.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb28-2"><a href="recalling-linear-models-assumptions.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.abund)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-21-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-21-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-21-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-21-4.png" width="50%" height="50%" /></p>
<p>Diagnostic plots show that the data/model violate assumptions of
homogeneity of variance (the graph on the left shows that residuals are larger at higher fitted values) and normality (the graph on the right indicates that residuals are not distributed as expected from a normal distribution, <em>i.e.</em> many points are far from predicted values given by the dotted line).
Therefore, we need to reject this model, and cannot use it to conclude that <em>Galumna</em> abundances vary as a function of water
content.</p>
<p>The diagnostic plots for the presence-absence model and
the proportion model also indicate that these models are also inappropriate:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="recalling-linear-models-assumptions.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the proportion model</span></span>
<span id="cb29-2"><a href="recalling-linear-models-assumptions.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prop <span class="sc">~</span> WatrCont, <span class="at">data =</span> mites)</span>
<span id="cb29-3"><a href="recalling-linear-models-assumptions.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.prop)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="recalling-linear-models-assumptions.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb30-2"><a href="recalling-linear-models-assumptions.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.prop)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-23-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-23-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-23-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-23-4.png" width="50%" height="50%" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="recalling-linear-models-assumptions.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the presence/absence model</span></span>
<span id="cb31-2"><a href="recalling-linear-models-assumptions.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pa <span class="sc">~</span> WatrCont, <span class="at">data =</span> mites)</span>
<span id="cb31-3"><a href="recalling-linear-models-assumptions.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm.pa)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="recalling-linear-models-assumptions.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb32-2"><a href="recalling-linear-models-assumptions.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.pa)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-25-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-25-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-25-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-25-4.png" width="50%" height="50%" /></p>
<p>Let us take a step back here and review the assumptions of linear models, and where they come from. Remember our simple linear model?</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>The last entry <span class="math inline">\(\varepsilon_i\)</span> is important. This is where assumptions of
normality and homoscedasticity originate. In linear models, <strong>the residuals <span class="math inline">\(\varepsilon_i\)</span> (the distance between each observation and the regression line) can be predicted by drawing random values from a normal distribution.</strong></p>
<p>Recall that all normal distributions have two parameters, <span class="math inline">\(\mu\)</span> (the mean of the distribution) and <span class="math inline">\(\sigma^2\)</span> (the variance of the distribution). In a linear model, <span class="math inline">\(\mu\)</span> changes based on values of <span class="math inline">\(X\)</span> (the predictor
variable), but <span class="math inline">\(\sigma^2\)</span> has the same value for all values of <span class="math inline">\(Y\)</span>. Our simple linear can also be written as this:</p>
<p><span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span></p>
<p>with <span class="math inline">\(N(\cdot)\)</span> meaning that <span class="math inline">\(Y_i\)</span> is drawn from a <strong>normal distribution</strong> with parameters <span class="math inline">\(\mu\)</span> (mean; which depends on <span class="math inline">\(x_i\)</span>) and <span class="math inline">\(\sigma\)</span> (variance; which has the same value for all <span class="math inline">\(Y_i\)</span>s).</p>
<p>Let us take a look at what happens to the distribution when we vary the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>Varying <span class="math inline">\(\mu\)</span> while <span class="math inline">\(\sigma = 5\)</span> shifts the mean of the distribution.</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we keep <span class="math inline">\(\mu = 25\)</span>, varying <span class="math inline">\(\sigma\)</span> changes the shape of the distribution, where smaller <span class="math inline">\(\sigma\)</span> (low variance) means there is higher probability around the mean, while larger <span class="math inline">\(\sigma\)</span> spreads out the probabilities across the full range of values.</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="model-prediction" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Model prediction<a href="recalling-linear-models-assumptions.html#model-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When the assumptions of the linear model are not met, model prediction becomes problematic. Let us work through an example to demonstrate some of the problems that arise from a poorly fitted model.</p>
<p>Remember that when we predict, we aim at estimating the <em>unknown coefficients</em> <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> so that a line effectively predicting every value of <span class="math inline">\(Y\)</span> as a function of <span class="math inline">\(X\)</span> can be drawn!</p>
<p><span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span></p>
<p>Let us predict <em>Galumna</em> abundance at a water content = 300 using the linear model we fit above. <strong>What are the parameters of the normal distribution used to model <span class="math inline">\(Y\)</span> when water content is <span class="math inline">\(300\)</span>?</strong></p>
<p>Let us begin by obtaining the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> for a normal distribution corresponding to our equation. To obtain the coefficients from our models, we can use the function <code>coef()</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="recalling-linear-models-assumptions.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract model coefficients</span></span>
<span id="cb33-2"><a href="recalling-linear-models-assumptions.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm.abund)</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
##  3.439348672 -0.006044788</code></pre>
<p>These coefficients would allow us to predict <em>Galumna</em> abundance if there was no error. However, we know that error is an <strong>irrevocable</strong> part of our model. To get our predicted values, we therefore also need to add . This is where we use the normal
distribution! For <span class="math inline">\(X\)</span> = 300, our model predicts that should follow a normal distribution with mean = 1.63. We can extract the variance (<span class="math inline">\(\sigma^2\)</span>) from our model summary:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="recalling-linear-models-assumptions.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract variance from the model summary</span></span>
<span id="cb35-2"><a href="recalling-linear-models-assumptions.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.abund)<span class="sc">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 1.513531</code></pre>
<p>We can plug these values into the equation we just discussed above:
<span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span>
<span class="math inline">\(\mu = 3.44 + (-0.006 \times 300) = 1.63\)</span></p>
<p><span class="math inline">\(\sigma^2 = 1.51\)</span></p>
<p>This tells us that randomly drawn <span class="math inline">\(Y\)</span> values when water content is <span class="math inline">\(300\)</span> should be on average <span class="math inline">\(1.63\)</span> and have a variance of <span class="math inline">\(1.51\)</span>. In other words, at <span class="math inline">\(x = 300\)</span>, residuals should follow a normal distribution with <span class="math inline">\(\mu = 1.63\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>. At <span class="math inline">\(x = 400\)</span>, we get <span class="math inline">\(\mu = 1.02\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>, etc.</p>
<p>At a water content of 400, residuals should follow a normal distribution with parameters <span class="math inline">\(\mu = 3.44 + (-0.006 x 400) = 1.02\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>, and thereon.</p>
<p>Each <span class="math inline">\(Y\)</span> value is modeled using a normal distribution with a mean that depends on <span class="math inline">\(X_i\)</span>, but with a variance that is constant <span class="math inline">\(\sigma^2 = 1.51\)</span> across all <span class="math inline">\(X_i\)</span> values.</p>
<p>We can represent these expectations like this:</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-30-1.png" width="480" /></p>
<p>The four normal distributions on this graph represent the probability of observing a given Galumna abundance for 4 different water content values.</p>
<p>The mean of the normal distribution varies as a function of water content (hence <span class="math inline">\(\mu\)</span> decreases with water content), but <span class="math inline">\(\sigma^2\)</span> is always 1.51 (<em>i.e.</em> the variance is homogeneous across all values of <span class="math inline">\(X\)</span>).</p>
<p>Our model thus expects observations to fall within the following shaded areas. However, what happens if we add our observations to this plot?</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-31-1.png" width="480" /></p>
<p>This model seems inappropriate (!) for at least two reasons:</p>
<p><strong>1. Values are on average further from the regression line at low water content values.</strong> That is, there is more residual variance around the predicted values for low values of <span class="math inline">\(X\)</span>, such that <span class="math inline">\(\varepsilon\)</span> varies as a function of <span class="math inline">\(X\)</span>, thus violating the assumption of homoscedasticity. It makes no sense to use a constant value of <span class="math inline">\(\sigma^2\)</span>: the normal distributions used to predict <span class="math inline">\(Y\)</span> at low values of <span class="math inline">\(X\)</span> should ideally be wider (have a larger <span class="math inline">\(\sigma^2\)</span>) than normal distributions used to predict <span class="math inline">\(Y\)</span> at large <span class="math inline">\(X\)</span> values, but linear models do not permit this.</p>
<p><strong>2. The residuals do not follow a normal distribution with constant variance across all values of</strong> <span class="math inline">\(X\)</span>. The variance of the residuals’ distribution changes as a function of <span class="math inline">\(X\)</span> (see the spread of the data points around the trend line!).</p>
<p><strong>3. The predicted values do not make sense, given the observations.</strong> Our response variable is abundance, which can only take integer values. Yet, when water content is 300, the abundance value that our model predicts to be the most probable is 1.63! We know that the probability of observing 1.63 individuals at water content = 300 is actually zero, as is the probability of observing any fraction (non-integers). Our predicted values should be modelled using a distribution that only predicts integers, rather than a continuous distribution like the normal distribution. This is a very common problem, as biological data often follows one of the myriad other statistical distributions besides the normal distribution.</p>
</div>
<div id="so-what-do-we-do-now-transform-our-data" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> So, what do we do now? Transform our data?<a href="recalling-linear-models-assumptions.html#so-what-do-we-do-now-transform-our-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Very often, data will not “behave” and will violate the assumptions we have seen, showing evidence for <strong>non-normality</strong> and/or <strong>heteroskedasticity</strong>.</p>
<p>We have been told to <strong>transform</strong> our data using logarithmic, square-root, and cosine transformations to get around these problems. Unfortunately, transformations not always work and come with a few drawbacks:</p>
<p><strong>1.</strong> They change the response variable (!), making interpretation challenging;<br />
<strong>2.</strong> They may not simultaneously improve linearity and homogeneity of variance;<br />
<strong>3.</strong> The boundaries of the sample space change.<br />
</p>
<p>For instance, our simple linear model:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>looks like this after the log-transformation of <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[E(\log{Y_i}) = \beta_0 + \beta_1X_i\]</span></p>
<p>It is, of course, much less intuitive to interpret that for every <span class="math inline">\(300\)</span> units increase in water content, <em>Galumna</em> abundance takes the form of <span class="math inline">\(\log(1.63)\)</span>…</p>
<p>Thankfully, the <strong>normal distribution is not our only option!</strong></p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="example-with-real-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-distributions-of-biological-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
