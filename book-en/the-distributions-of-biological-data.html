<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 The distributions of biological data | Workshop 6: Generalized linear models</title>
  <meta name="description" content="Generalized linear models in R" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 The distributions of biological data | Workshop 6: Generalized linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Generalized linear models in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 The distributions of biological data | Workshop 6: Generalized linear models" />
  
  <meta name="twitter:description" content="Generalized linear models in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="an-example-with-general-linear-models.html"/>
<link rel="next" href="generalized-linear-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Generalized linear models in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html"><i class="fa fa-check"></i><b>3</b> Reviewing linear models</a><ul>
<li class="chapter" data-level="3.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#general-linear-models"><i class="fa fa-check"></i><b>3.1</b> General linear models</a><ul>
<li class="chapter" data-level="3.1.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#definition"><i class="fa fa-check"></i><b>3.1.1</b> Definition</a></li>
<li class="chapter" data-level="3.1.2" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#assumptions"><i class="fa fa-check"></i><b>3.1.2</b> Assumptions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html"><i class="fa fa-check"></i><b>4</b> An example with general linear models</a><ul>
<li class="chapter" data-level="4.1" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html#recalling-linear-models-assumptions"><i class="fa fa-check"></i><b>4.1</b> Recalling linear models: assumptions</a><ul>
<li class="chapter" data-level="4.1.1" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html#model-prediction"><i class="fa fa-check"></i><b>4.1.1</b> Model prediction</a></li>
<li class="chapter" data-level="4.1.2" data-path="an-example-with-general-linear-models.html"><a href="an-example-with-general-linear-models.html#so-what-do-we-do-now-transform-our-data"><i class="fa fa-check"></i><b>4.1.2</b> So, what do we do now? Transform our data?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-distributions-of-biological-data.html"><a href="the-distributions-of-biological-data.html"><i class="fa fa-check"></i><b>5</b> The distributions of biological data</a></li>
<li class="chapter" data-level="6" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>6</b> Generalized Linear Models</a></li>
<li class="part"><span><b>GLMs with binary data</b></span></li>
<li class="chapter" data-level="7" data-path="binomial-glms.html"><a href="binomial-glms.html"><i class="fa fa-check"></i><b>7</b> Binomial GLMs</a><ul>
<li class="chapter" data-level="7.1" data-path="binomial-glms.html"><a href="binomial-glms.html#glm-with-binomial-data-logit-link"><i class="fa fa-check"></i><b>7.1</b> GLM with binomial data: logit link</a></li>
<li class="chapter" data-level="7.2" data-path="binomial-glms.html"><a href="binomial-glms.html#exercise-1"><i class="fa fa-check"></i><b>7.2</b> Exercise 1</a></li>
<li class="chapter" data-level="7.3" data-path="binomial-glms.html"><a href="binomial-glms.html#challenge-1"><i class="fa fa-check"></i><b>7.3</b> Challenge 1</a><ul>
<li class="chapter" data-level="7.3.1" data-path="binomial-glms.html"><a href="binomial-glms.html#challenge-1-solution"><i class="fa fa-check"></i><b>7.3.1</b> Challenge 1: Solution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="binomial-glms.html"><a href="binomial-glms.html#interpreting-the-output-of-a-logistic-regression"><i class="fa fa-check"></i><b>7.4</b> Interpreting the output of a logistic regression</a><ul>
<li class="chapter" data-level="7.4.1" data-path="binomial-glms.html"><a href="binomial-glms.html#an-example-using-the-identity-link"><i class="fa fa-check"></i><b>7.4.1</b> An example using the identity link</a></li>
<li class="chapter" data-level="7.4.2" data-path="binomial-glms.html"><a href="binomial-glms.html#interpreting-the-coefficients-using-the-logit-link"><i class="fa fa-check"></i><b>7.4.2</b> Interpreting the coefficients using the logit link</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="binomial-glms.html"><a href="binomial-glms.html#predictive-power-and-goodness-of-fit"><i class="fa fa-check"></i><b>7.5</b> Predictive power and goodness-of-fit</a><ul>
<li class="chapter" data-level="7.5.1" data-path="binomial-glms.html"><a href="binomial-glms.html#challenge-2"><i class="fa fa-check"></i><b>7.5.1</b> Challenge 2</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>GLMs with proportion data</b></span></li>
<li class="chapter" data-level="8" data-path="binomial-glms-and-proportions.html"><a href="binomial-glms-and-proportions.html"><i class="fa fa-check"></i><b>8</b> Binomial GLMs and proportions</a></li>
<li class="part"><span><b>GLMs with count data</b></span></li>
<li class="chapter" data-level="9" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html"><i class="fa fa-check"></i><b>9</b> What can we do with count data?</a></li>
<li class="chapter" data-level="10" data-path="poisson-glms.html"><a href="poisson-glms.html"><i class="fa fa-check"></i><b>10</b> Poisson GLMs</a><ul>
<li class="chapter" data-level="10.1" data-path="poisson-glms.html"><a href="poisson-glms.html#poisson-glms-in-r"><i class="fa fa-check"></i><b>10.1</b> Poisson GLMs in <code>R</code></a></li>
<li class="chapter" data-level="10.2" data-path="poisson-glms.html"><a href="poisson-glms.html#the-problem-of-overdispersion"><i class="fa fa-check"></i><b>10.2</b> The problem of overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>11</b> Quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="12" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>12</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="12.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#plotting-the-final-glm-to-the-data"><i class="fa fa-check"></i><b>12.1</b> Plotting the final GLM to the data</a><ul>
<li class="chapter" data-level="12.1.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#challenge-3"><i class="fa fa-check"></i><b>12.1.1</b> Challenge 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>13</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Other distributions</b></span></li>
<li class="chapter" data-level="14" data-path="other-distributions.html"><a href="other-distributions.html"><i class="fa fa-check"></i><b>14</b> Other distributions</a></li>
<li class="part"><span><b>Additional GLM resources</b></span></li>
<li class="chapter" data-level="15" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>15</b> Summary</a></li>
<li class="chapter" data-level="16" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>16</b> Additional resources</a></li>
<li class="chapter" data-level="17" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>17</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 6: Generalized linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="the-distributions-of-biological-data" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> The distributions of biological data</h1>
<p>Statisticians have described a multitude of distributions that
correspond to different types of data. A distribution provides the
probability of observing each possible outcome of an experiment or
survey (for example, abundance = 8 <em>Galumna</em> is one such “outcome” of a
survey). <strong>Discrete</strong> distributions have a range that only includes
integers, while <strong>continuous</strong> distributions have a range that also
includes fractions (the normal distribution is an example of a
continuous distribution). All distributions have parameters that dictate
the shape of the distribution (for example <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> for the normal
distribution). For a good overview of statistical distributions, we
recommend that you refer to Chapter 4 in Ben Bolker’s <em>Ecological
Models and Data in R</em>. Here, we briefly discuss a few distributions
that are useful for ecologists and generalized linear modeling.</p>
<p>We have already seen that our response variable “<em>Galumna</em> abundance”
can only take integer values. Abundance, therefore, follows a discrete
distribution, with no fractions in its range. A useful distribution to
model abundance data is the <strong>Poisson</strong> distribution, named after Siméon
Denis Poisson. The Poisson distribution is a discrete distribution with
a single parameter, <span class="math inline">\(\lambda\)</span> (lambda), which defines both the mean and the
variance of the distribution (i.e. the mean and the variance of a
Poisson distribution are equal). Here are 3 examples of Poisson
distributions with different values of <span class="math inline">\(\lambda\)</span>, corresponding in this case to
the mean number of <em>Galumna</em> observed in a fictive set of samples:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="the-distributions-of-biological-data.html#cb40-1"></a><span class="co"># examples of Poisson distributions with different values of lambda</span></span>
<span id="cb40-2"><a href="the-distributions-of-biological-data.html#cb40-2"></a><span class="kw">par</span>(<span class="dt">cex =</span> <span class="dv">2</span>)</span>
<span id="cb40-3"><a href="the-distributions-of-biological-data.html#cb40-3"></a>x =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dv">1</span>)</span>
<span id="cb40-4"><a href="the-distributions-of-biological-data.html#cb40-4"></a><span class="kw">plot</span>(x, <span class="kw">dpois</span>(x, <span class="dt">lambda =</span> <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">xlab =</span> <span class="st">&quot;Frequency of Galumna&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Probability&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;lambda = 1&quot;</span>)</span>
<span id="cb40-5"><a href="the-distributions-of-biological-data.html#cb40-5"></a><span class="kw">plot</span>(x, <span class="kw">dpois</span>(x, <span class="dt">lambda =</span> <span class="dv">10</span>), <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">xlab =</span> <span class="st">&quot;Frequency of Galumna&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Probability&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;lambda = 10&quot;</span>)</span>
<span id="cb40-6"><a href="the-distributions-of-biological-data.html#cb40-6"></a><span class="kw">plot</span>(x, <span class="kw">dpois</span>(x, <span class="dt">lambda =</span> <span class="dv">30</span>), <span class="dt">type =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">xlab =</span> <span class="st">&quot;Frequency of Galumna&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Probability&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;lambda = 30&quot;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-26-1.png" width="33%" /><img src="book-en_files/figure-html/unnamed-chunk-26-2.png" width="33%" /><img src="book-en_files/figure-html/unnamed-chunk-26-3.png" width="33%" /></p>
<p>Note that at low <span class="math inline">\(\lambda\)</span> values (when the mean is close to zero), the
distribution is skewed to the right, while at large <span class="math inline">\(\lambda\)</span> values (large
mean) the distribution is symmetrical. The variance increases with the
mean, predicted values are always integers, and the range of a Poisson
distribution is always strictly positive; all of these properties are
useful to model count data, for example abundance of a given taxon,
number of seeds in a plot, etc. Our variable mites <code>$Galumna</code> seems to
follow a Poisson distribution with a low value of <span class="math inline">\(\lambda\)</span> (indeed, if we
calculate the mean abundance of <em>Galumna</em> across all samples using the
function <code>mean()</code>, we find that it is close to zero):</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="the-distributions-of-biological-data.html#cb41-1"></a><span class="co"># Explore the dataset</span></span>
<span id="cb41-2"><a href="the-distributions-of-biological-data.html#cb41-2"></a><span class="kw">hist</span>(mites<span class="op">$</span>Galumna)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="the-distributions-of-biological-data.html#cb42-1"></a><span class="kw">mean</span>(mites<span class="op">$</span>Galumna)</span></code></pre></div>
<pre><code>## [1] 0.9571429</code></pre>
<p>Our variable <code>$pa</code> (presence-absence) takes yet another form. It
consists of only zeros and ones, such that a Poisson distribution would
not be appropriate to model this variable.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="the-distributions-of-biological-data.html#cb44-1"></a><span class="kw">hist</span>(mites<span class="op">$</span>pa)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-29-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We need a distribution with a range that only includes two possible
outcomes: zero or one. The <strong>Bernoulli</strong> distribution is such a
distribution. It is often the first distribution that students of
statistics are introduced to, for example when discussing the
probability of obtaining the outcome “heads” when flipping a coin. The
Bernoulli distribution has only one parameter, <span class="math inline">\(p\)</span>, the probability of
success (i.e. the probability of obtaining heads on a coin flip). If we
consider that each of our samples is equivalent to a coin toss, then we
can use the Bernouilli distribution to calculate the probability of
obtaining the outcome “<em>Galumna</em> present” (1) vs. “<em>Galumna</em> absent”
(0). Here are some examples of Bernoulli distributions with various
probabilities of presence (<span class="math inline">\(p\)</span>):</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-30-1.png" width="30%" /><img src="book-en_files/figure-html/unnamed-chunk-30-2.png" width="30%" /><img src="book-en_files/figure-html/unnamed-chunk-30-3.png" width="30%" /></p>
<p>We can calculate the number of sites where <em>Galumna</em> is present out of the
total number of sites to get an idea of what <span class="math inline">\(p\)</span> might be in our case:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="the-distributions-of-biological-data.html#cb45-1"></a><span class="co"># Calculate probabilities of presence of Galumna (p)</span></span>
<span id="cb45-2"><a href="the-distributions-of-biological-data.html#cb45-2"></a><span class="kw">sum</span>(mites<span class="op">$</span>pa) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>(mites)</span></code></pre></div>
<pre><code>## [1] 0.3571429</code></pre>
<p><span class="math inline">\(p\)</span> for the variable mites <code>$pa</code> is more or less <code>0.36</code>, such that roughly
twice as many sites have the outcome “<em>Galumna</em> absent” (0) than the
outcome “<em>Galumna</em> present” (1).</p>
<p>When there are multiple trials/coin tosses, the Bernouilli distribution
expands into the binomial distribution, which has the additional
parameter <span class="math inline">\(n\)</span>, corresponding to the number of trials. The binomial
distribution predicts the probability of observing a given proportion of
successes, <span class="math inline">\(p\)</span>, out of a known total number of trials, <span class="math inline">\(n\)</span>.
“Successes” can be anything from taxon occurrence, number of surviving
individuals out of a sample, etc. Imagine that instead of only working
in the Laurentians, we took 50 mite samples at each of 30 regions across
Canada. In each sample from each region, we determine if <em>Galumna</em> is
present or absent. We could model this data using a binomial
distribution with <span class="math inline">\(n\)</span> = 50 samples (i.e. “trials” or coin flips where
<em>Galumna</em> can be either present or absent) and <span class="math inline">\(p\)</span> = the average
proportion of samples in which <em>Galumna</em> is present. We would have 30 data
points, corresponding to the 30 regions. Here are some examples of
binomial distributions with <span class="math inline">\(n\)</span> = 50 and 3 different values of <span class="math inline">\(p\)</span>:</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-32-1.png" width="33%" /><img src="book-en_files/figure-html/unnamed-chunk-32-2.png" width="33%" /><img src="book-en_files/figure-html/unnamed-chunk-32-3.png" width="33%" /></p>
<p>Notice that the binomial distribution is right-skewed at low <span class="math inline">\(p\)</span> values
but left-skewed at high <span class="math inline">\(p\)</span> values. This is the main difference with the
Poisson distribution: the binomial distribution has an upper limit to
its range, corresponding to the number of trials, <span class="math inline">\(n\)</span>. Consequently, the
binomial distribution is often used to model data where the number of
successes are integers and where the number of trials is known. For
example, we could use the binomial distribution to model our proportion
data, where each individual mite in a sample could be considered a
trial, and if the mite is a <em>Galumna</em> individual then the trial is a
success. In this case, the number of trials <span class="math inline">\(n\)</span> varies among our 70
samples based on the total number of individuals in the sample, while
<span class="math inline">\(p\)</span>, the probability of success, is given by the proportion of <em>Galumna</em>
in each sample.</p>
<p>Why are we discussing all of these distributions? Because all of them
can be used to replace the normal distribution when calculating
predicted values in a linear model. For example, we could use the
Poisson distribution and model our abundance data with the following
equation:</p>
<p><span class="math display">\[Y_i \sim Poisson(\lambda = \beta_0 + \beta_1X_i)\]</span></p>
<p>Notice that <span class="math inline">\(\lambda\)</span> varies as a function of <span class="math inline">\(X\)</span> (water content), meaning that
the residual variance will also vary with <span class="math inline">\(X\)</span>. This means that we just
relaxed the homogeneity of variance assumption! Also, predicted values
will now be integers instead of fractions because they will all be drawn
from Poisson distributions with different <span class="math inline">\(\lambda\)</span> values. The model will never
predict negative values because Poisson distributions have strictly
positive ranges. By simply switching the distribution of error terms
(<span class="math inline">\(\varepsilon\)</span>) from normal to Poisson, we solved most of the problems of our
abundance linear model. This new model is <em>almost</em> a Poisson
generalized linear model, which basically looks like this:</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Notice that probabilities of observations/predicted values (in orange,
as for the lm model above) are now integers, and that both the variance
and the mean of the distribution decline as <span class="math inline">\(\lambda\)</span> decreases with increasing
water content. Why is the fitted line of predicted values curved? Why is
this called a “generalized” linear model?</p>

</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="an-example-with-general-linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
