<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 The distributions of biological data | Workshop 6: Generalized linear models</title>
  <meta name="description" content="Generalized linear models in R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 The distributions of biological data | Workshop 6: Generalized linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Generalized linear models in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 The distributions of biological data | Workshop 6: Generalized linear models" />
  
  <meta name="twitter:description" content="Generalized linear models in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="why-are-generalized-linear-models-useful.html"/>
<link rel="next" href="binomial-glms-bernouilli.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Generalized linear models in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="why-are-generalized-linear-models-useful.html"><a href="why-are-generalized-linear-models-useful.html"><i class="fa fa-check"></i><b>3</b> Why are generalized linear models useful?</a></li>
<li class="chapter" data-level="4" data-path="the-distributions-of-biological-data.html"><a href="the-distributions-of-biological-data.html"><i class="fa fa-check"></i><b>4</b> The distributions of biological data</a></li>
<li class="part"><span><b>GLMs with binary data</b></span></li>
<li class="chapter" data-level="5" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html"><i class="fa fa-check"></i><b>5</b> Binomial GLMs (Bernouilli)</a><ul>
<li class="chapter" data-level="5.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#the-link-function"><i class="fa fa-check"></i><b>5.1</b> The link function</a><ul>
<li class="chapter" data-level="5.1.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#challenge-1"><i class="fa fa-check"></i><b>5.1.1</b> Challenge 1</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#interpreting-the-output-of-a-logistic-regression"><i class="fa fa-check"></i><b>5.2</b> Interpreting the output of a logistic regression</a></li>
<li class="chapter" data-level="5.3" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#predictive-power-and-goodness-of-fit"><i class="fa fa-check"></i><b>5.3</b> Predictive power and goodness-of-fit</a><ul>
<li class="chapter" data-level="5.3.1" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#challenge-2"><i class="fa fa-check"></i><b>5.3.1</b> Challenge 2</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="binomial-glms-bernouilli.html"><a href="binomial-glms-bernouilli.html#plotting-results"><i class="fa fa-check"></i><b>5.4</b> Plotting results</a></li>
</ul></li>
<li class="part"><span><b>GLMs with proportion data</b></span></li>
<li class="chapter" data-level="6" data-path="binomial-glms.html"><a href="binomial-glms.html"><i class="fa fa-check"></i><b>6</b> Binomial GLMs</a></li>
<li class="part"><span><b>GLMs with count data</b></span></li>
<li class="chapter" data-level="7" data-path="poisson-glms.html"><a href="poisson-glms.html"><i class="fa fa-check"></i><b>7</b> Poisson GLMs</a><ul>
<li class="chapter" data-level="7.1" data-path="poisson-glms.html"><a href="poisson-glms.html#the-problem-of-overdispersion"><i class="fa fa-check"></i><b>7.1</b> The problem of overdispersion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="quasi-poisson-glms.html"><a href="quasi-poisson-glms.html"><i class="fa fa-check"></i><b>8</b> quasi-Poisson GLMs</a></li>
<li class="chapter" data-level="9" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html"><i class="fa fa-check"></i><b>9</b> Negative binomial GLMs</a><ul>
<li class="chapter" data-level="9.1" data-path="negative-binomial-glms.html"><a href="negative-binomial-glms.html#plotting-the-final-glm-to-the-data"><i class="fa fa-check"></i><b>9.1</b> Plotting the final GLM to the data</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="conclusion-on-glms-with-count-data.html"><a href="conclusion-on-glms-with-count-data.html"><i class="fa fa-check"></i><b>10</b> Conclusion on GLMs with count data</a></li>
<li class="part"><span><b>Other distributions</b></span></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="11" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>11</b> Summary</a></li>
<li class="chapter" data-level="12" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>12</b> Additional resources</a></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 6: Generalized linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="the-distributions-of-biological-data" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> The distributions of biological data</h1>
<p>Statisticians have described a multitude of distributions that
correspond to different types of data. A distribution provides the
probability of observing each possible outcome of an experiment or
survey (for example, abundance = 8 Galumna is one such "outcome" of a
survey). "Discrete" distributions have a range that only includes
integers, while "continuous" distributions have a range that also
includes fractions (the normal distribution is an example of a
continuous distribution). All distributions have parameters that dictate
the shape of the distribution (for example μ and σ<sup>2</sup> for the normal
distribution). For a good overview of statistical distributions, we
recommend that you refer to chapter 4 in Ben Bolker’s <em>Ecological
Models and Data in R</em>. Here we just discuss briefly a few distributions
that are useful for ecologists and generalized linear modeling.</p>
<p>We have already seen that our response variable "Galumna abundance"
can only take integer values. Abundance, therefore, follows a discrete
distribution, with no fractions in its range. A useful distribution to
model abundance data is the "Poisson" distribution, named after Siméon
Denis Poisson. The Poisson distribution is a discrete distribution with
a single parameter, λ (lambda), which defines both the mean and the
variance of the distribution (i.e. the mean and the variance of a
Poisson distribution are equal). Here are 3 examples of Poisson
distributions with different values of λ, corresponding in this case to
the mean number of Galumna observed in a fictive set of samples:</p>
<p><img src="images/6_poisson.jpeg" /></p>
<p>Note that at low λ values (when the mean is close to zero), the
distribution is skewed to the right, while at large λ values (large
mean) the distribution is symmetrical. The variance increases with the
mean, predicted values are always integers, and the range of a Poisson
distribution is always strictly positive; all of these properties are
useful to model count data, for example abundance of a given taxon,
number of seeds in a plot, etc. Our variable mites$Galumna seems to
follow a Poisson distribution with a low value of λ (indeed, if we
calculate the mean abundance of Galumna across all samples using the
function mean(), we find that it is close to zero):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="the-distributions-of-biological-data.html#cb12-1"></a><span class="kw">hist</span>(mites<span class="op">$</span>Galumna)</span>
<span id="cb12-2"><a href="the-distributions-of-biological-data.html#cb12-2"></a><span class="kw">mean</span>(mites<span class="op">$</span>Galumna)</span></code></pre></div>
<p><img src="images/6_galumnahist.jpeg" /></p>
<p>Our variable mites$pa (presence-absence) takes yet another form. It
consists of only zeros and ones, such that a Poisson distribution would
not be appropriate to model this variable.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="the-distributions-of-biological-data.html#cb13-1"></a><span class="kw">hist</span>(mites<span class="op">$</span>pa)</span></code></pre></div>
<p><img src="images/6_pa.jpeg" /></p>
<p>We need a distribution with a range that only includes two possible
outcomes: zero or one. The "Bernoulli" distribution is such a
distribution. It is often the first distribution that students of
statistics are introduced to, for example when discussing the
probability of obtaining the outcome "heads" when flipping a coin. The
Bernoulli distribution has only one parameter, <em>p</em>, the probability of
success (i.e. the probability of obtaining heads on a coin flip). If we
consider that each of our samples is equivalent to a coin toss, then we
can use the Bernouilli distribution to calculate the probability of
obtaining the outcome "Galumna present" (1) vs. "Galumna absent"
(0). Here are some examples of Bernoulli distributions with various
probabilities of presence (<em>p</em>):</p>
<p><img src="images/6_bernouill.jpeg" /></p>
<p>We can calculate the number of sites where Galumna is present out of the
total number of sites to get an idea of what <em>p</em> might be in our case:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="the-distributions-of-biological-data.html#cb14-1"></a><span class="kw">sum</span>(mites<span class="op">$</span>pa)<span class="op">/</span><span class="kw">nrow</span>(mites)</span></code></pre></div>
<p><em>p</em> for the variable mites$pa is more or less 0.36, such that roughly
twice as many sites have the outcome "Galumna absent" (0) than the
outcome "Galumna present" (1).</p>
<p>When there are multiple trials/coin tosses, the Bernoulli distribution
expands into the binomial distribution, which has the additional
parameter <em>n</em>, corresponding to the number of trials. The binomial
distribution predicts the probability of observing a given proportion of
successes, <em>p</em>, out of a known total number of trials, <em>n</em>.
"Successes" can be anything from taxon occurrence, number of surviving
individuals out of a sample, etc. Imagine that instead of only working
in the Laurentians, we took 50 mite samples at each of 30 regions across
Canada. In each sample from each region, we determine if Galumna is
present or absent. We could model this data using a binomial
distribution with <em>n</em> = 50 samples (i.e. "trials" or coin flips where
Galumna can be either present or absent) and <em>p</em> = the average
proportion of samples in which Galumna is present. We would have 30 data
points, corresponding to the 30 regions. Here are some examples of
binomial distributions with <em>n</em> = 50 and 3 different values of <em>p</em>:</p>
<p><img src="images/6_binomial.jpeg" /></p>
<p>Notice that the binomial distribution is right-skewed at low <em>p</em> values
but left-skewed at high <em>p</em> values. This is the main difference with the
Poisson distribution: the binomial distribution has an upper limit to
its range, corresponding to the number of trials, <em>n</em>. Consequently, the
binomial distribution is often used to model data where the number of
successes are integers and where the number of trials is known. For
example, we could use the binomial distribution to model our proportion
data, where each individual mite in a sample could be considered a
trial, and if the mite is a Galumna individual then the trial is a
success. In this case, the number of trials <em>n</em> varies among our 70
samples based on the total number of individuals in the sample, while
<em>p</em>, the probability of success, is given by the proportion of Galumna
in each sample.</p>
<p>Why are we discussing all of these distributions? Because all of them
can be used to replace the normal distribution when calculating
predicted values in a linear model. For example, we could use the
Poisson distribution and model our abundance data with the following
equation:</p>
<p>y<sub>i</sub> ~ Poisson(λ = β<sub>0</sub> + β<sub>1</sub>x<sub>i</sub>)</p>
<p>Notice that λ varies as a function of x (water content), meaning that
the residual variance will also vary with x. This means that we just
relaxed the homogeneity of variance assumption! Also, predicted values
will now be integers instead of fractions because they will all be drawn
from Poisson distributions with different λ values. The model will never
predict negative values because Poisson distributions have strictly
positive ranges. By simply switching the distribution of error terms
(ε<sub>i</sub>) from normal to Poisson, we solved most of the problems of our
abundance linear model. This new model is <span class="ul">almost</span> a Poisson
generalized linear model, which basically looks like this:</p>
<p><img src="images/6_poissonglm.jpeg" /></p>
<p>Notice that probabilities of observations/predicted values (in orange,
as for the lm model above) are now integers, and that both the variance
and the mean of the distribution decline as λ decreases with increasing
water content. Why is the fitted line of predicted values curved? Why is
this called a "generalized" linear model? Keep reading and you’ll
find out!</p>

</div>



<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="why-are-generalized-linear-models-useful.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="binomial-glms-bernouilli.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
