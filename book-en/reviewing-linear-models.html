<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Reviewing linear models | Workshop 6: Generalized linear models</title>
  <meta name="description" content="Generalized linear models in R" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Reviewing linear models | Workshop 6: Generalized linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Generalized linear models in R" />
  <meta name="github-repo" content="qcbsRworkshops/workshop06" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Reviewing linear models | Workshop 6: Generalized linear models" />
  
  <meta name="twitter:description" content="Generalized linear models in R" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops/assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="preparing-for-the-workshop.html"/>
<link rel="next" href="the-distributions-of-biological-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series<span></span></b></span></li>
<li><a href="index.html#preface">Preface<span></span></a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>0.1</b> Code of conduct<span></span></a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour<span></span></a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour<span></span></a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors<span></span></a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing<span></span></a></li>
</ul></li>
<li class="part"><span><b>Generalized linear models in <code>R</code><span></span></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives<span></span></a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop<span></span></a></li>
<li class="chapter" data-level="3" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html"><i class="fa fa-check"></i><b>3</b> Reviewing linear models<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#general-linear-models"><i class="fa fa-check"></i><b>3.1</b> General linear models<span></span></a><ul>
<li class="chapter" data-level="3.1.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#definition"><i class="fa fa-check"></i><b>3.1.1</b> Definition<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#assumptions"><i class="fa fa-check"></i><b>3.1.2</b> Assumptions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#an-example-with-general-linear-models"><i class="fa fa-check"></i><b>3.2</b> An example with general linear models<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#recalling-linear-models-assumptions"><i class="fa fa-check"></i><b>3.3</b> Recalling linear models: assumptions<span></span></a><ul>
<li class="chapter" data-level="3.3.1" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#model-prediction"><i class="fa fa-check"></i><b>3.3.1</b> Model prediction<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="reviewing-linear-models.html"><a href="reviewing-linear-models.html#so-what-do-we-do-now-transform-our-data"><i class="fa fa-check"></i><b>3.3.2</b> So, what do we do now? Transform our data?<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-distributions-of-biological-data.html"><a href="the-distributions-of-biological-data.html"><i class="fa fa-check"></i><b>4</b> The distributions of biological data<span></span></a></li>
<li class="chapter" data-level="5" data-path="generalized-linear-models.html"><a href="generalized-linear-models.html"><i class="fa fa-check"></i><b>5</b> Generalized linear models<span></span></a></li>
<li class="part"><span><b>GLMs with binary data<span></span></b></span></li>
<li class="chapter" data-level="6" data-path="binomial-glms.html"><a href="binomial-glms.html"><i class="fa fa-check"></i><b>6</b> Binomial GLMs<span></span></a><ul>
<li class="chapter" data-level="6.1" data-path="binomial-glms.html"><a href="binomial-glms.html#glm-with-binomial-data-logit-link"><i class="fa fa-check"></i><b>6.1</b> GLM with binomial data: logit link<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="binomial-glms.html"><a href="binomial-glms.html#example"><i class="fa fa-check"></i><b>6.2</b> Example<span></span></a></li>
<li class="chapter" data-level="6.3" data-path="binomial-glms.html"><a href="binomial-glms.html#challenge-1"><i class="fa fa-check"></i><b>6.3</b> Challenge 1<span></span></a></li>
<li class="chapter" data-level="6.4" data-path="binomial-glms.html"><a href="binomial-glms.html#interpreting-the-output-of-a-logistic-regression"><i class="fa fa-check"></i><b>6.4</b> Interpreting the output of a logistic regression<span></span></a><ul>
<li class="chapter" data-level="6.4.1" data-path="binomial-glms.html"><a href="binomial-glms.html#an-example-using-the-identity-link"><i class="fa fa-check"></i><b>6.4.1</b> An example using the identity link<span></span></a></li>
<li class="chapter" data-level="6.4.2" data-path="binomial-glms.html"><a href="binomial-glms.html#interpreting-the-coefficients-using-the-logit-link"><i class="fa fa-check"></i><b>6.4.2</b> Interpreting the coefficients using the logit link<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="binomial-glms.html"><a href="binomial-glms.html#predictive-power-and-goodness-of-fit"><i class="fa fa-check"></i><b>6.5</b> Predictive power and goodness-of-fit<span></span></a><ul>
<li class="chapter" data-level="6.5.1" data-path="binomial-glms.html"><a href="binomial-glms.html#challenge-2"><i class="fa fa-check"></i><b>6.5.1</b> Challenge 2<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="binomial-glms.html"><a href="binomial-glms.html#visual-representation-of-results"><i class="fa fa-check"></i><b>6.6</b> Visual representation of results<span></span></a></li>
</ul></li>
<li class="part"><span><b>GLMs with proportion data<span></span></b></span></li>
<li class="chapter" data-level="7" data-path="binomial-glms-and-proportions.html"><a href="binomial-glms-and-proportions.html"><i class="fa fa-check"></i><b>7</b> Binomial GLMs and proportions<span></span></a></li>
<li class="part"><span><b>GLMs with count data<span></span></b></span></li>
<li class="chapter" data-level="8" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html"><i class="fa fa-check"></i><b>8</b> What can we do with count data?<span></span></a><ul>
<li class="chapter" data-level="8.1" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#poisson-glms"><i class="fa fa-check"></i><b>8.1</b> Poisson GLMs<span></span></a><ul>
<li class="chapter" data-level="8.1.1" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#the-poisson-distribution"><i class="fa fa-check"></i><b>8.1.1</b> The Poisson distribution<span></span></a></li>
<li class="chapter" data-level="8.1.2" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#poisson-glms-in-r"><i class="fa fa-check"></i><b>8.1.2</b> Poisson GLMs in <code>R</code><span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#the-problem-of-overdispersion"><i class="fa fa-check"></i><b>8.2</b> The problem of overdispersion<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#quasi-poisson-glms"><i class="fa fa-check"></i><b>8.3</b> Quasi-Poisson GLMs<span></span></a></li>
<li class="chapter" data-level="8.4" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#negative-binomial-glms"><i class="fa fa-check"></i><b>8.4</b> Negative binomial GLMs<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#plotting-the-final-glm-to-the-data"><i class="fa fa-check"></i><b>8.5</b> Plotting the final GLM to the data<span></span></a><ul>
<li class="chapter" data-level="8.5.1" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#challenge-3"><i class="fa fa-check"></i><b>8.5.1</b> Challenge 3<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="what-can-we-do-with-count-data.html"><a href="what-can-we-do-with-count-data.html#conclusion-on-glms-with-count-data"><i class="fa fa-check"></i><b>8.6</b> Conclusion on GLMs with count data<span></span></a></li>
</ul></li>
<li class="part"><span><b>Other distributions<span></span></b></span></li>
<li class="chapter" data-level="9" data-path="other-distributions.html"><a href="other-distributions.html"><i class="fa fa-check"></i><b>9</b> Other distributions<span></span></a></li>
<li class="part"><span><b>Additional GLM resources<span></span></b></span></li>
<li class="chapter" data-level="10" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>10</b> Summary<span></span></a></li>
<li class="chapter" data-level="11" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>11</b> Additional resources<span></span></a></li>
<li class="chapter" data-level="12" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>12</b> References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 6: Generalized linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="reviewing-linear-models" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 3</span> Reviewing linear models<a href="reviewing-linear-models.html#reviewing-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Much of our research focuses on investigating how patterns we observe can be explained by predictive variables.</p>
<p>We are often looking for a function <span class="math inline">\(f\)</span> that can explain a response variable ( <span class="math inline">\(Y\)</span> ) <em>in terms of</em> one ( <span class="math inline">\(X_1\)</span> ) or many other predictors ( <span class="math inline">\(X_2\)</span>, <span class="math inline">\(X_3\)</span>, <span class="math inline">\(...\)</span> , <span class="math inline">\(X_n\)</span> ):</p>
<p><span class="math display">\[Y = f(X_1)\]</span>
The combination of predictive variables we have sampled will <em>never</em> fully explain <span class="math inline">\(Y\)</span>. Because of this, there is always <em>unpredictable disturbance</em> in our models, <em>i</em>.<em>e</em>. the error <span class="math inline">\(\epsilon\)</span>. As such, the error is an irrevocable part of our function:</p>
<p><span class="math display">\[Y = f(X_1, \epsilon)\]</span>
In <a href="https://qcbsrworkshops.github.io/workshop04/pres-en/workshop04-pres-en.html#1">Workshop 4</a>, we have learned how to use <strong>general linear models</strong> as <span class="math inline">\(f(\cdot)\)</span> to describe the relationship between variables. They were: the <span class="math inline">\(t\)</span>-test, the analysis of variance (or, ANOVA), the linear regression (both simple, with one predictor, and multiple, with more than one predictor), and the analysis of covariance (ANCOVA).</p>
<div id="general-linear-models" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> General linear models<a href="reviewing-linear-models.html#general-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="definition" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.1</span> Definition<a href="reviewing-linear-models.html#definition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The general form of our function <span class="math inline">\(Y = f(X_1)\)</span> as a linear function can be represented by:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>where:</p>
<p><span class="math inline">\(Y_i\)</span> is thepredicted value of a response variable</p>
<p><span class="math inline">\(\beta_0\)</span> is the <em>unknown coefficient</em> <strong>intercept</strong></p>
<p><span class="math inline">\(\beta_1\)</span> is the <em>unknown coefficient</em> <strong>slope</strong></p>
<p><span class="math inline">\(X_i\)</span> is the value for the explanatory variable</p>
<p><span class="math inline">\(\varepsilon_i\)</span> is the model residual drawn from a normal distribution with a varying mean but a constant variance.</p>
</div>
<div id="assumptions" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.2</span> Assumptions<a href="reviewing-linear-models.html#assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Linear models</strong> only produce unbiased estimators (i.e. are only reliable) if they follow certain assumptions. Most importantly:</p>
<p>1. The population can be described by a linear relationship:</p>
<p><span class="math display">\[Y = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>2. The error term <span class="math inline">\(\varepsilon\)</span> has the same variance given any value of the explanatory variable (i.e. homoskedasticity), and the error terms are not correlated across observations (i.e. no autocorrelation):</p>
<p><span class="math display">\[\mathbb{V}{\rm ar} (\epsilon_i | \mathbf{X} ) = \sigma^2_\epsilon,\ \forall i = 1,..,N\]</span>
and,</p>
<p><span class="math display">\[\mathbb{C}{\rm ov} (\epsilon_i, \epsilon_j) = 0,\ i \neq j\]</span></p>
<p>3. And, the residuals are normal:</p>
<p><span class="math display">\[\boldsymbol{\varepsilon} | \mathbf{X} \sim \mathcal{N} \left( \mathbf{0}, \sigma^2_\epsilon \mathbf{I} \right)\]</span>
The estimations of general linear models as in <span class="math inline">\(\widehat{Y} = \widehat{\beta}_0 + \widehat{\beta}_1 X\)</span> assumes that data is generated following these assumptions.</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-7-1.png" width="768" /></p>
</div>
</div>
<div id="an-example-with-general-linear-models" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.2</span> An example with general linear models<a href="reviewing-linear-models.html#an-example-with-general-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s simulate 250 observations which satisfies our assumptions: <span class="math inline">\(\epsilon_i \sim \mathcal{N}(0, 2^2), i = 1,...,250\)</span>.</p>
<p>.pull-left[</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="reviewing-linear-models.html#cb4-1"></a>nSamples &lt;-<span class="st"> </span><span class="dv">250</span></span>
<span id="cb4-2"><a href="reviewing-linear-models.html#cb4-2"></a>ID &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>nSamples)))</span>
<span id="cb4-3"><a href="reviewing-linear-models.html#cb4-3"></a></span>
<span id="cb4-4"><a href="reviewing-linear-models.html#cb4-4"></a>PredVar &lt;-<span class="st"> </span><span class="kw">runif</span>(nSamples, </span>
<span id="cb4-5"><a href="reviewing-linear-models.html#cb4-5"></a>                  <span class="dt">min =</span> <span class="dv">0</span>, </span>
<span id="cb4-6"><a href="reviewing-linear-models.html#cb4-6"></a>                  <span class="dt">max =</span> <span class="dv">50</span>)</span>
<span id="cb4-7"><a href="reviewing-linear-models.html#cb4-7"></a></span>
<span id="cb4-8"><a href="reviewing-linear-models.html#cb4-8"></a>simNormData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb4-9"><a href="reviewing-linear-models.html#cb4-9"></a>  <span class="dt">ID =</span> ID,</span>
<span id="cb4-10"><a href="reviewing-linear-models.html#cb4-10"></a>  <span class="dt">PredVar =</span> PredVar,</span>
<span id="cb4-11"><a href="reviewing-linear-models.html#cb4-11"></a>  <span class="dt">RespVar =</span> (<span class="dv">2</span><span class="op">*</span>PredVar <span class="op">+</span><span class="st"> </span></span>
<span id="cb4-12"><a href="reviewing-linear-models.html#cb4-12"></a><span class="st">               </span><span class="kw">rnorm</span>(nSamples,</span>
<span id="cb4-13"><a href="reviewing-linear-models.html#cb4-13"></a>                     <span class="dt">mean =</span> <span class="dv">0</span>,</span>
<span id="cb4-14"><a href="reviewing-linear-models.html#cb4-14"></a>                     <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb4-15"><a href="reviewing-linear-models.html#cb4-15"></a>             )</span>
<span id="cb4-16"><a href="reviewing-linear-models.html#cb4-16"></a>  )</span>
<span id="cb4-17"><a href="reviewing-linear-models.html#cb4-17"></a></span>
<span id="cb4-18"><a href="reviewing-linear-models.html#cb4-18"></a><span class="co"># We have learned how to use lm() </span></span>
<span id="cb4-19"><a href="reviewing-linear-models.html#cb4-19"></a></span>
<span id="cb4-20"><a href="reviewing-linear-models.html#cb4-20"></a>lm.simNormData &lt;-<span class="st"> </span><span class="kw">lm</span>(RespVar <span class="op">~</span><span class="st"> </span>PredVar, </span>
<span id="cb4-21"><a href="reviewing-linear-models.html#cb4-21"></a>                     <span class="dt">data =</span> simNormData)</span></code></pre></div>
<p>]</p>
<p>.pull-right[</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="reviewing-linear-models.html#cb5-1"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)) </span>
<span id="cb5-2"><a href="reviewing-linear-models.html#cb5-2"></a><span class="kw">plot</span>(lm.simNormData)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>]</p>
<ol style="list-style-type: decimal">
<li><p>These graphs allows one to check the assumption of linearity and homoscedasticity;</p></li>
<li><p>QQ-plot allows the comparison of the residuals to “ideal” normal observations;</p></li>
<li><p>Scale-location plot (square rooted standardized residual vs. predicted value) is useful for checking the assumption of homoscedasticity;</p></li>
<li><p>Cook’s Distance, which is a measure of the influence of each observation on the regression coefficients and helps identify outliers.</p></li>
</ol>
<p>Residuals are <span class="math inline">\(Y-\widehat{Y}\)</span>, or the observed value minus the predicted value.</p>
<p>Outliers are observations <span class="math inline">\(Y\)</span> with large residuals, i.e. the observed value <span class="math inline">\(Y\)</span> for a point <span class="math inline">\(X\)</span> is very different from the one predicted by the regression model <span class="math inline">\(\widehat{Y}\)</span>.</p>
<p>A leverage point is defined as an observation <span class="math inline">\(Y\)</span> that has a value of <span class="math inline">\(x\)</span> that is far away from the mean of <span class="math inline">\(x\)</span>.</p>
<p>An influential observation is defined as an observation <span class="math inline">\(Y\)</span> that changes the slope of the line <span class="math inline">\(\beta_1\)</span>. Thus, influential points have a large influence on the fit of the model. One method to find influential points is to compare the fit of the model with and without each observation.</p>
<p>#Example with real data
Let us use our prior knowledge on general linear models to explore the relationship between variables within the <em>Oribatid mite dataset</em>.</p>
<p>Let us begin by loading this dataset into <code>R</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="reviewing-linear-models.html#cb6-1"></a><span class="co"># Use setwd() to set your working directory</span></span>
<span id="cb6-2"><a href="reviewing-linear-models.html#cb6-2"></a></span>
<span id="cb6-3"><a href="reviewing-linear-models.html#cb6-3"></a>mites &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/mites.csv&#39;</span>,</span>
<span id="cb6-4"><a href="reviewing-linear-models.html#cb6-4"></a>                  <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>The dataset that you just loaded is a subset from the classic <a href="http://adn.biol.umontreal.ca/~numericalecology/data/oribates.html">Oribatid mites (Acari,Oribatei)</a>, which has been used in numerous texts (e.g. Borcard,
Gillet &amp; Legendre, <em>Numerical Ecology with R</em>), and which is available
in the <code>vegan</code> library.</p>
<p>The Oribatid mite dataset has <strong>70 observations with moss and mite samples</strong> collected at the <a href="https://goo.gl/maps/PxN1Q7KUPnUt92Eu5">Station de Biologie from the Université de Montréal</a>.
], within the municipality of Saint-Hippolyte, Québec (Canada). Each sample includes <strong>5</strong> variables of <strong>environmental measurements</strong> and abundance for <em>Galumna</em> sp. for each site.</p>
<p>We can peek into the structure and the first six rows of the dataset using the <code>head()</code> and <code>str()</code> functions:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="reviewing-linear-models.html#cb7-1"></a><span class="kw">head</span>(mites)</span></code></pre></div>
<pre><code>##   Galumna pa totalabund        prop SubsDens WatrCont Substrate Shrub    Topo
## 1       8  1        140 0.057142857    39.18   350.15   Sphagn1   Few Hummock
## 2       3  1        268 0.011194030    54.99   434.81    Litter   Few Hummock
## 3       1  1        186 0.005376344    46.07   371.72 Interface   Few Hummock
## 4       1  1        286 0.003496503    48.19   360.50   Sphagn1   Few Hummock
## 5       2  1        199 0.010050251    23.55   204.13   Sphagn1   Few Hummock
## 6       1  1        209 0.004784689    57.32   311.55   Sphagn1   Few Hummock</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="reviewing-linear-models.html#cb9-1"></a><span class="kw">str</span>(mites)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    70 obs. of  9 variables:
##  $ Galumna   : int  8 3 1 1 2 1 1 1 2 5 ...
##  $ pa        : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ totalabund: int  140 268 186 286 199 209 162 126 123 166 ...
##  $ prop      : num  0.05714 0.01119 0.00538 0.0035 0.01005 ...
##  $ SubsDens  : num  39.2 55 46.1 48.2 23.6 ...
##  $ WatrCont  : num  350 435 372 360 204 ...
##  $ Substrate : Factor w/ 7 levels &quot;Barepeat&quot;,&quot;Interface&quot;,..: 4 3 2 4 4 4 4 2 3 4 ...
##  $ Shrub     : Factor w/ 3 levels &quot;Few&quot;,&quot;Many&quot;,&quot;None&quot;: 1 1 1 1 1 1 1 2 2 2 ...
##  $ Topo      : Factor w/ 2 levels &quot;Blanket&quot;,&quot;Hummock&quot;: 2 2 2 2 2 2 2 1 1 2 ...</code></pre>
<p>Our first glance into the dataset already allows us to separate potential response variables from potential predictors:</p>
<div class="split">
<div class="split-left">
<p>Response variables:</p>
<ol style="list-style-type: decimal">
<li>Occurrence: <code>pa</code></li>
<li>Abundance: <code>Galumna</code></li>
<li>Relative Frequency or Proportion: <code>prop</code></li>
</ol>
</div>
<div class="split-right">
<p>Predictive variables:</p>
<ol style="list-style-type: decimal">
<li>Substract Density: <code>SubsDens</code></li>
<li>Water Content: <code>WatrCont</code></li>
<li>Substrate: <code>Substrate</code></li>
<li>Shrubs Nearby: <code>Shrub</code></li>
<li>Topography: <code>Topo</code></li>
</ol>
</div>
</div>
<p>We can also already ellaborate an initial question: <em>Could the abundance, occurrence or proportion of Galumna sp. be predicted by environmental features?</em></p>
<p>To answer this question, we can think of a variety of functions:</p>
<div class="split">
<div class="split-left">
<p><span class="math inline">\(\text{Abundance} = f(\text{Water content}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Proportion} = f(\text{Water content}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Occurrence} = f(\text{Substrate}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Abundance} = f(\text{Topography}, \epsilon)\)</span></p>
</div>
<div class="split-right">
<p><span class="math inline">\(\text{Occurrence} = f(\text{Shrubs Nearby}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Relative Frequency} = f(\text{Topography}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Occurrence} = f(\text{Substract Density}, \epsilon)\)</span></p>
<p><span class="math inline">\(\text{Abundance} = f(\text{Substrate}, \epsilon)\)</span>
]</p>
</div>
</div>
<p>Can we see a relationship between <em>Galumna</em> and any of the five environmental variables?</p>
<p>Let us attempt to be more specific and ask <strong>wether <em>Galumna</em>’s community values (abundance, occurrence and relative frequency) vary as a function of water content</strong>.</p>
<p>We can begin by representing all three response variables against the predictor:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="reviewing-linear-models.html#cb11-1"></a><span class="kw">plot</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont,</span>
<span id="cb11-2"><a href="reviewing-linear-models.html#cb11-2"></a>     <span class="dt">data =</span> mites,</span>
<span id="cb11-3"><a href="reviewing-linear-models.html#cb11-3"></a>     <span class="dt">xlab =</span> <span class="st">&#39;Water content&#39;</span>,</span>
<span id="cb11-4"><a href="reviewing-linear-models.html#cb11-4"></a>     <span class="dt">ylab =</span> <span class="st">&#39;Abundance&#39;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="reviewing-linear-models.html#cb12-1"></a><span class="kw">boxplot</span>(WatrCont <span class="op">~</span><span class="st"> </span>pa,</span>
<span id="cb12-2"><a href="reviewing-linear-models.html#cb12-2"></a>        <span class="dt">data =</span> mites,</span>
<span id="cb12-3"><a href="reviewing-linear-models.html#cb12-3"></a>        <span class="dt">xlab=</span><span class="st">&#39;Presence/Absence&#39;</span>,</span>
<span id="cb12-4"><a href="reviewing-linear-models.html#cb12-4"></a>        <span class="dt">ylab =</span> <span class="st">&#39;Water content&#39;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="reviewing-linear-models.html#cb13-1"></a><span class="kw">plot</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont,</span>
<span id="cb13-2"><a href="reviewing-linear-models.html#cb13-2"></a>     <span class="dt">data =</span> mites,</span>
<span id="cb13-3"><a href="reviewing-linear-models.html#cb13-3"></a>     <span class="dt">xlab =</span> <span class="st">&#39;Water content&#39;</span>,</span>
<span id="cb13-4"><a href="reviewing-linear-models.html#cb13-4"></a>     <span class="dt">ylab =</span> <span class="st">&#39;Proportion&#39;</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Indeed, <code>Galumna</code> seems to vary negatively as a function of <code>WatrCont</code>, <em>i</em>.<em>e</em>.
<em>Galumna</em> sp. seems to prefer dryer sites.</p>
<p>We can go step further and fit general linear models to test whether <code>Galumna</code>, <code>pa</code>, or <code>prop</code> vary as a function of <code>WatrCont</code></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="reviewing-linear-models.html#cb14-1"></a><span class="co"># Fit the models</span></span>
<span id="cb14-2"><a href="reviewing-linear-models.html#cb14-2"></a><span class="co">## </span></span>
<span id="cb14-3"><a href="reviewing-linear-models.html#cb14-3"></a><span class="co"># Abundance model</span></span>
<span id="cb14-4"><a href="reviewing-linear-models.html#cb14-4"></a>lm.abund &lt;-<span class="st"> </span><span class="kw">lm</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb14-5"><a href="reviewing-linear-models.html#cb14-5"></a><span class="co">## </span></span>
<span id="cb14-6"><a href="reviewing-linear-models.html#cb14-6"></a><span class="co"># Presence-absence model</span></span>
<span id="cb14-7"><a href="reviewing-linear-models.html#cb14-7"></a>lm.pa &lt;-<span class="st"> </span><span class="kw">lm</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb14-8"><a href="reviewing-linear-models.html#cb14-8"></a><span class="co">## </span></span>
<span id="cb14-9"><a href="reviewing-linear-models.html#cb14-9"></a><span class="co"># Proportion model</span></span>
<span id="cb14-10"><a href="reviewing-linear-models.html#cb14-10"></a>lm.prop &lt;-<span class="st"> </span><span class="kw">lm</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span></code></pre></div>
<p>Then, we can check the model output to verify whether these relationships are statistically significant:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="reviewing-linear-models.html#cb15-1"></a><span class="co"># Check the model output with the summary() function</span></span>
<span id="cb15-2"><a href="reviewing-linear-models.html#cb15-2"></a><span class="kw">summary</span>(lm.abund)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Galumna ~ WatrCont, data = mites)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.7210 -0.8236 -0.3270  0.3910  6.6772 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.439349   0.555825   6.188 3.98e-08 ***
## WatrCont    -0.006045   0.001280  -4.723 1.21e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.514 on 68 degrees of freedom
## Multiple R-squared:  0.247,  Adjusted R-squared:  0.2359 
## F-statistic: 22.31 on 1 and 68 DF,  p-value: 1.206e-05</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="reviewing-linear-models.html#cb17-1"></a><span class="kw">summary</span>(lm.pa)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = pa ~ WatrCont, data = mites)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.61320 -0.30889 -0.05498  0.30247  0.80073 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.1892142  0.1431306   8.309 6.03e-12 ***
## WatrCont    -0.0020263  0.0003296  -6.148 4.68e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3897 on 68 degrees of freedom
## Multiple R-squared:  0.3573, Adjusted R-squared:  0.3478 
## F-statistic:  37.8 on 1 and 68 DF,  p-value: 4.677e-08</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="reviewing-linear-models.html#cb19-1"></a><span class="kw">summary</span>(lm.prop)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = prop ~ WatrCont, data = mites)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.010208 -0.004927 -0.002056  0.003240  0.049252 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.020e-02  3.294e-03   6.133 4.98e-08 ***
## WatrCont    -3.516e-05  7.586e-06  -4.635 1.67e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.008971 on 68 degrees of freedom
## Multiple R-squared:  0.2401, Adjusted R-squared:  0.2289 
## F-statistic: 21.49 on 1 and 68 DF,  p-value: 1.665e-05</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="reviewing-linear-models.html#cb21-1"></a><span class="co"># Extracting the Pr(&gt;|t|)</span></span>
<span id="cb21-2"><a href="reviewing-linear-models.html#cb21-2"></a></span>
<span id="cb21-3"><a href="reviewing-linear-models.html#cb21-3"></a><span class="kw">summary</span>(lm.abund)<span class="op">$</span>coefficients[, <span class="dv">4</span>]</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
## 3.981563e-08 1.206117e-05</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="reviewing-linear-models.html#cb23-1"></a><span class="kw">summary</span>(lm.pa)<span class="op">$</span>coefficients[, <span class="dv">4</span>]</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
## 6.030252e-12 4.676755e-08</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="reviewing-linear-models.html#cb25-1"></a><span class="kw">summary</span>(lm.prop)<span class="op">$</span>coefficients[, <span class="dv">4</span>]</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
## 4.977432e-08 1.665437e-05</code></pre>
<p>Yes, there is a strong and significant relationship for all 3 response variables! <strong>Wait a minute…</strong> We are forgetting something important here! What about the assumptions of linear models?</p>
</div>
<div id="recalling-linear-models-assumptions" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.3</span> Recalling linear models: assumptions<a href="reviewing-linear-models.html#recalling-linear-models-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s validate these models to make sure that we
respect assumptions of linear models, starting with the abundance model.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="reviewing-linear-models.html#cb27-1"></a><span class="co"># Plot the abundance model</span></span>
<span id="cb27-2"><a href="reviewing-linear-models.html#cb27-2"></a><span class="kw">plot</span>(Galumna <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb27-3"><a href="reviewing-linear-models.html#cb27-3"></a><span class="kw">abline</span>(lm.abund)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The model does not fit well. It predicts negative abundance values when
<code>WatrCont</code> exceeds 600, which does not make any sense. Also, the model
does poorly at predicting high abundance values at low values of <code>WatrCont</code>.</p>
<p>We can also check the model diagnostic plots:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="reviewing-linear-models.html#cb28-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb28-2"><a href="reviewing-linear-models.html#cb28-2"></a><span class="kw">plot</span>(lm.abund)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-21-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-21-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-21-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-21-4.png" width="50%" height="50%" /></p>
<p>Diagnostic plots show that the data/model violate assumptions of
homogeneity of variance (the graph on the left shows that residuals are
larger at higher fitted values) and normality (the graph on the right
indicates that residuals are not distributed as expected from a normal
distribution, i.e. many points are far from predicted values given by
the dotted line). Therefore, we need to reject this model, and can’t
use it to conclude that Galumna abundance varies as a function of water
content.</p>
<p>Looking at diagnostic plots for the presence-absence model and
the proportion model also indicate that these models are also inappropriate:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="reviewing-linear-models.html#cb29-1"></a><span class="co"># Plot the proportion model</span></span>
<span id="cb29-2"><a href="reviewing-linear-models.html#cb29-2"></a><span class="kw">plot</span>(prop <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb29-3"><a href="reviewing-linear-models.html#cb29-3"></a><span class="kw">abline</span>(lm.prop)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="reviewing-linear-models.html#cb30-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb30-2"><a href="reviewing-linear-models.html#cb30-2"></a><span class="kw">plot</span>(lm.prop)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-23-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-23-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-23-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-23-4.png" width="50%" height="50%" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="reviewing-linear-models.html#cb31-1"></a><span class="co"># Plot the presence/absence model</span></span>
<span id="cb31-2"><a href="reviewing-linear-models.html#cb31-2"></a><span class="kw">plot</span>(pa <span class="op">~</span><span class="st"> </span>WatrCont, <span class="dt">data =</span> mites)</span>
<span id="cb31-3"><a href="reviewing-linear-models.html#cb31-3"></a><span class="kw">abline</span>(lm.pa)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="reviewing-linear-models.html#cb32-1"></a><span class="co"># Diagnostic plots</span></span>
<span id="cb32-2"><a href="reviewing-linear-models.html#cb32-2"></a><span class="kw">plot</span>(lm.pa)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-25-1.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-25-2.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-25-3.png" width="50%" height="50%" /><img src="book-en_files/figure-html/unnamed-chunk-25-4.png" width="50%" height="50%" /></p>
<p>Let’s take a step back here and review the assumptions of linear models, and where they come from. Remember our simple linear model?</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>The last entry <span class="math inline">\(\varepsilon_i\)</span> is important. This is where assumptions of
normality and homoscedasticity originate. In linear models, <strong>the residuals <span class="math inline">\(\varepsilon_i\)</span> (the distance between each observation and the regression line) can be predicted by drawing random values from a normal distribution.</strong></p>
<p>Recall that all normal distributions have two parameters, <span class="math inline">\(\mu\)</span> (the mean of the distribution) and <span class="math inline">\(\sigma^2\)</span> (the variance of the distribution). In a linear model, <span class="math inline">\(\mu\)</span> changes based on values of <span class="math inline">\(X\)</span> (the predictor
variable), but <span class="math inline">\(\sigma^2\)</span> has the same value for all values of <span class="math inline">\(Y\)</span>. Our simple linear can also be written as this:</p>
<p><span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span></p>
<p>with <span class="math inline">\(N(\cdot)\)</span> meaning that <span class="math inline">\(Y_i\)</span> is drawn from a <strong>normal distribution</strong> with parameters <span class="math inline">\(\mu\)</span> (mean; which depends on <span class="math inline">\(x_i\)</span>) and <span class="math inline">\(\sigma\)</span> (variance; which has the same value for all <span class="math inline">\(Y_i\)</span>s).</p>
<p>Let’s take a look at what happens to the distribution when we vary the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>.</p>
<p>Varying <span class="math inline">\(\mu\)</span> while <span class="math inline">\(\sigma = 5\)</span> shifts the mean of the distribution.</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-26-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we keep <span class="math inline">\(\mu = 25\)</span>, varying <span class="math inline">\(\sigma\)</span> changes the shape of the distribution, where smaller <span class="math inline">\(\sigma\)</span> (low variance) means there is higher probability around the mean, while larger <span class="math inline">\(\sigma\)</span> spreads out the probabilities across the full range of values.</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="model-prediction" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.1</span> Model prediction<a href="reviewing-linear-models.html#model-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When the assumptions of the linear model are not met, model prediction becomes problematic. Let’s work through an example to demonstrate some of the problems that arise from a poorly fitted model.</p>
<p>Remember that when we predict, we aim at estimating the <em>unknown coefficients</em> <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> so that a line effectively predicting every value of <span class="math inline">\(Y\)</span> as a function of <span class="math inline">\(X\)</span> can be drawn!</p>
<p><span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span></p>
<p>Let’s predict <em>Galumna</em> abundance at a water content = 300 using the linear model we fit above. <strong>What are the parameters of the normal distribution used to model <span class="math inline">\(Y\)</span> when water content is <span class="math inline">\(300\)</span>?</strong></p>
<p>Let’s begin by obtaining the parameters <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma^2\)</span> for a normal distribution corresponding to our equation. To obtain the coefficients from our models, we can use the function <code>coef()</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="reviewing-linear-models.html#cb33-1"></a><span class="co"># Extract model coefficients</span></span>
<span id="cb33-2"><a href="reviewing-linear-models.html#cb33-2"></a><span class="kw">coef</span>(lm.abund)</span></code></pre></div>
<pre><code>##  (Intercept)     WatrCont 
##  3.439348672 -0.006044788</code></pre>
<p>These coefficients would allow us to predict <em>Galumna</em> abundance if there was no error. However, we know that error is an <strong>irrevocable</strong> part of our model. To get our predicted values, we therefore also need to add . This is where we use the normal
distribution! For <span class="math inline">\(X\)</span> = 300, our model predicts that should follow a normal distribution with mean = 1.63. We can extract the variance (<span class="math inline">\(\sigma^2\)</span>) from our model summary:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="reviewing-linear-models.html#cb35-1"></a><span class="co"># Extract variance from the model summary</span></span>
<span id="cb35-2"><a href="reviewing-linear-models.html#cb35-2"></a><span class="kw">summary</span>(lm.abund)<span class="op">$</span>sigma</span></code></pre></div>
<pre><code>## [1] 1.513531</code></pre>
<p>We can plug these values into the equation we just discussed above:
<span class="math display">\[Y_i \sim N(\mu = \beta_0 + \beta_1 X_i +\varepsilon, \sigma^2)\]</span>
<span class="math inline">\(\mu = 3.44 + (-0.006 \times 300) = 1.63\)</span></p>
<p><span class="math inline">\(\sigma^2 = 1.51\)</span></p>
<p>This tells us that randomly drawn <span class="math inline">\(Y\)</span> values when water content is <span class="math inline">\(300\)</span> should be on average <span class="math inline">\(1.63\)</span> and have a variance of <span class="math inline">\(1.51\)</span>. In other words, at <span class="math inline">\(x = 300\)</span>, residuals should follow a normal distribution with <span class="math inline">\(\mu = 1.63\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>. At <span class="math inline">\(x = 400\)</span>, we get <span class="math inline">\(\mu = 1.02\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>, etc.</p>
<p>At a water content of 400, residuals should follow a normal
distribution with parameters <span class="math inline">\(\mu = 3.44 + (-0.006 x 400) = 1.02\)</span> and <span class="math inline">\(\sigma^2 = 1.51\)</span>, etc. Each <span class="math inline">\(Y\)</span> value is modeled using a normal distribution with a mean that depends on <span class="math inline">\(X_i\)</span>, but with a variance that is constant <span class="math inline">\(\sigma^2 = 1.51\)</span> across all <span class="math inline">\(X_i\)</span> values. Graphically, this looks like this:</p>
<p><img src="images/modelPredic.png" width="400" /></p>
<p>The four normal distributions on this graph represent the probability of
observing a given Galumna abundance for 4 different water content
values. The mean of the normal distribution varies as a function of
water content (hence <span class="math inline">\(\mu\)</span> decreases with water content), but <span class="math inline">\(\sigma^2\)</span> is always 1.51 (i.e. the variance is homogeneous across all values of <span class="math inline">\(X\)</span>).</p>
<p>This model is inappropriate for at least two reasons:</p>
<p><strong>1. Values are on average further from the regression line at low water content values.</strong> That is, there is more residual variance around the predicted values for low values of <span class="math inline">\(X\)</span>, such that <span class="math inline">\(\varepsilon\)</span> varies as a function of <span class="math inline">\(X\)</span>, thus violating the assumption of homoscedasticity. It makes no sense to use a constant value of <span class="math inline">\(\sigma^2\)</span>: the normal distributions used to predict <span class="math inline">\(Y\)</span> at low values of <span class="math inline">\(X\)</span> should ideally be wider (have a larger <span class="math inline">\(\sigma^2\)</span>) than normal distributions used to predict <span class="math inline">\(Y\)</span> at large <span class="math inline">\(X\)</span> values, but linear models do not permit this.</p>
<p><strong>2. The residuals do not follow a normal distribution with constant variance across all values of</strong> <span class="math inline">\(X\)</span>. The variance of the residuals’ distribution changes as a function of <span class="math inline">\(X\)</span> (see the spread of the data points around the trendline!).</p>
<p><strong>3. The predicted values do not make sense, given the observations.</strong> Our response variable is abundance, which can only take integer values. Yet, at water content = 300, the abundance value that our model predicts to be the most probable is 1.63! We know that the probability of observing 1.63 individuals at water content = 300 is actually zero, as is the probability of observing any fraction (non-integers). Our predicted values should be modeled using a distribution that only predicts integers, rather than a continuous distribution like the normal distribution. This is a very common problem, as biological data often follows one of the myriad other statistical distributions besides the normal distribution.</p>
</div>
<div id="so-what-do-we-do-now-transform-our-data" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.2</span> So, what do we do now? Transform our data?<a href="reviewing-linear-models.html#so-what-do-we-do-now-transform-our-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Very often, data will not “behave” and will violate the assumptions we have seen, showing evidence for <strong>non-normality</strong> and/or <strong>heteroskedasticity</strong>.</p>
<p>We have been told to <strong>transform</strong> our data using logarithmic, square-root, and cosine transformations to get around these problems. Unfortunately, transformations not always work and come with a few drawbacks:</p>
<p><strong>1.</strong> They change the response variable (!), making interpretation challenging;<br />
<strong>2.</strong> They may not simulateneously improve linearity and homogeneity of variance;<br />
<strong>3.</strong> The boundaries of the sample space change.<br />
</p>
<p>For instance, our simple linear model:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1X_i + \varepsilon\]</span></p>
<p>looks like this under a log-transform:</p>
<p><span class="math display">\[E(\log{Y_i}) = \beta_0 + \beta_1X_i \]</span></p>
<p>It is, of course, much less intuitive to interpret that for every <span class="math inline">\(300\)</span> units increase in water content, Galumna abundance takes the form of <span class="math inline">\(\log(1.63)\)</span>…</p>
<p>Thankfully, the <strong>normal distribution is not our only option!</strong></p>

</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="preparing-for-the-workshop.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-distributions-of-biological-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
